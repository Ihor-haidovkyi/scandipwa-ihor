{"ast":null,"code":"import _objectWithoutProperties from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _get from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";import _getPrototypeOf from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import validationConfig from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/Form/Form.config\";import Field from\"./Field.component\";import{CHECKBOX_TYPE,ENTER_KEY_CODE,FILE_TYPE,NUMBER_TYPE,PASSWORD_TYPE,RADIO_TYPE,SELECT_TYPE,TEXT_TYPE,TEXTAREA_TYPE}from\"./Field.config\";/** @namespace Component/Field/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _FieldContainer=/*#__PURE__*/function(_Extensible){_inherits(_FieldContainer,_Extensible);var _super=_createSuper(_FieldContainer);function _FieldContainer(){var _this;_classCallCheck(this,_FieldContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.containerFunctions={onChange:_this.onChange.bind(_assertThisInitialized(_this)),handleChange:_this.handleChange.bind(_assertThisInitialized(_this)),onChangeCheckbox:_this.onChangeCheckbox.bind(_assertThisInitialized(_this)),onFocus:_this.onFocus.bind(_assertThisInitialized(_this)),onKeyPress:_this.onKeyPress.bind(_assertThisInitialized(_this)),onKeyEnterDown:_this.onKeyEnterDown.bind(_assertThisInitialized(_this)),onClick:_this.onClick.bind(_assertThisInitialized(_this))};_this.containerProps=function(){var _this$props=_this.props,propsChecked=_this$props.checked,customValidationStatus=_this$props.customValidationStatus;var _this$state=_this.state,type=_this$state.type,checked=_this$state.checked,value=_this$state.value,validationStatus=_this$state.validationStatus,validationMessage=_this$state.validationMessage,filename=_this$state.filename;return{checked:type===CHECKBOX_TYPE?propsChecked:checked,value:value,validationStatus:customValidationStatus!==null&&customValidationStatus!==void 0?customValidationStatus:validationStatus,message:validationMessage,filename:filename};};return _this;}_createClass(_FieldContainer,[{key:\"__construct\",value:function __construct(props){_get(_getPrototypeOf(_FieldContainer.prototype),\"__construct\",this).call(this,props);var checked=props.checked;var value=this.getInitialPropsValue();this.state={value:value,checked:checked,validationMessage:'',validationStatus:null,eventId:''};}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var prevValue=prevProps.value,prevChecked=prevProps.checked,prevSubmitted=prevProps.isSubmitted;var _this$props2=this.props,currentValue=_this$props2.value,currChecked=_this$props2.checked,type=_this$props2.type,id=_this$props2.id,validateSeparately=_this$props2.validateSeparately,isSubmitted=_this$props2.isSubmitted;var eventId=this.state.eventId;if(prevValue!==currentValue){// eslint-disable-next-line react/no-did-update-set-state\nthis.setState({value:currentValue});}if(type===CHECKBOX_TYPE&&currChecked!==prevChecked){// eslint-disable-next-line react/no-did-update-set-state\nthis.setState({checked:currChecked});}// prevents validating all fields when entering data in only one of them\nif(eventId===id||prevSubmitted!==isSubmitted||!validateSeparately){this.updateValidationStatus();this.setValidationMessage(prevProps);}}},{key:\"setValidationMessage\",value:function setValidationMessage(prevProps){var _prevProps$message=prevProps.message,prevMessage=_prevProps$message===void 0?{}:_prevProps$message;var _this$props$message=this.props.message,message=_this$props$message===void 0?{}:_this$props$message;var _this$state$validatio=this.state.validationMessage,validationMessage=_this$state$validatio===void 0?{}:_this$state$validatio;if(message!==validationMessage&&!prevMessage&&message){this.setState({validationMessage:message});}}},{key:\"getInitialPropsValue\",value:function getInitialPropsValue(){var _this$props3=this.props,type=_this$props3.type,value=_this$props3.value;if(value){return value;}switch(type){case NUMBER_TYPE:return 0;case CHECKBOX_TYPE:return false;default:return'';}}},{key:\"validateField\",value:function validateField(){var _this$props4=this.props,validation=_this$props4.validation,id=_this$props4.id,refMap=_this$props4.formRef,formRefMap=_this$props4.formRefMap;if(!validation||!id||!refMap||!refMap.current){return{};}var _ref=refMap||{},inputNode=_ref.current;if(!inputNode){return{};}// we are looking for validation and executing it\nvar rule=validation.find(function(rule){if(!validationConfig[rule]){return false;}var validationRules=validationConfig[rule];var isValid=validationRules.validate(inputNode,formRefMap);return!isValid;});return validationConfig[rule]||{};}},{key:\"updateValidationStatus\",value:function updateValidationStatus(){var validationRule=this.validateField();this.setState({validationStatus:!validationRule.validate,validationMessage:validationRule.message});}},{key:\"onChange\",value:function onChange(event){var _event$target;var type=this.props.type;this.setState({eventId:event===null||event===void 0?void 0:(_event$target=event.target)===null||_event$target===void 0?void 0:_event$target.name});if(typeof event==='string'||typeof event==='number'){return this.handleChange(event);}if(event.currentTarget.value.length<=0){this.setState({validationStatus:null});}this.updateValidationStatus();if(type===FILE_TYPE){return this.handleChange(event.target.value,false,event.target.files[0]);}return this.handleChange(event.target.value);}},{key:\"onChangeCheckbox\",value:function onChangeCheckbox(event){var onChange=this.props.onChange;var _event$target2=event.target,checked=_event$target2.checked,value=_event$target2.value;if(onChange){onChange(value,checked);}this.setState({checked:checked});}},{key:\"onFocus\",value:function onFocus(event){var onFocus=this.props.onFocus;if(onFocus){onFocus(event);}}},{key:\"onBlur\",value:function onBlur(event){var onBlur=this.props.onBlur;if(onBlur){onBlur(event);}}},{key:\"onKeyPress\",value:function onKeyPress(event){var onKeyPress=this.props.onKeyPress;if(onKeyPress){onKeyPress(event);}}},{key:\"onKeyEnterDown\",value:function onKeyEnterDown(event){if(event.keyCode===ENTER_KEY_CODE){var value=event.target.value||1;this.handleChange(value);}}},{key:\"onClick\",value:function onClick(event){var selectValue=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var onClick=this.props.onClick;if(selectValue){event.target.select();}if(onClick){onClick(event);}}},{key:\"handleChange\",value:function handleChange(value){var shouldUpdate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var fileValue=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var _this$props5=this.props,isControlled=_this$props5.isControlled,onChange=_this$props5.onChange,type=_this$props5.type,min=_this$props5.min,max=_this$props5.max;switch(type){case NUMBER_TYPE:var isValueNaN=Number.isNaN(parseInt(value,10));if(min>value||value>max||isValueNaN){break;}if(onChange&&shouldUpdate){onChange(value);}if(!isControlled){this.setState({value:value});}break;case FILE_TYPE:if(value){var result=onChange&&onChange(fileValue);this.setState({value:result?value:'',filename:result?value.substr(value.lastIndexOf('\\\\')+1):''});}break;default:if(onChange){onChange(value);}if(!isControlled){this.setState({value:value});}}}},{key:\"render\",value:function render(){var _this$props6=this.props,customValidationStatus=_this$props6.customValidationStatus,otherProps=_objectWithoutProperties(_this$props6,[\"customValidationStatus\"]);return/*#__PURE__*/_checkBEM(React,Field,Object.assign({},otherProps,this.containerProps(),this.containerFunctions));}}]);return _FieldContainer;}(Extensible(PureComponent));_FieldContainer.defaultProps={min:1,max:99,checked:false,value:null,onChange:function onChange(){},onFocus:function onFocus(){},onBlur:function onBlur(){},onClick:function onClick(){},onKeyPress:function onKeyPress(){},formRef:function formRef(){},isControlled:false,validation:[],message:'',customValidationStatus:null,id:'',formRefMap:{},validateSeparately:false,isSubmitted:false};Object.defineProperty(_FieldContainer,'name',{value:'FieldContainer'});export var FieldContainer=middleware(_FieldContainer,\"Component/Field/Container\");export default FieldContainer;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/Field/Field.container.js"],"names":["PureComponent","validationConfig","Field","CHECKBOX_TYPE","ENTER_KEY_CODE","FILE_TYPE","NUMBER_TYPE","PASSWORD_TYPE","RADIO_TYPE","SELECT_TYPE","TEXT_TYPE","TEXTAREA_TYPE","FieldContainer","containerFunctions","onChange","bind","handleChange","onChangeCheckbox","onFocus","onKeyPress","onKeyEnterDown","onClick","containerProps","props","propsChecked","checked","customValidationStatus","state","type","value","validationStatus","validationMessage","filename","message","getInitialPropsValue","eventId","prevProps","prevValue","prevChecked","prevSubmitted","isSubmitted","currentValue","currChecked","id","validateSeparately","setState","updateValidationStatus","setValidationMessage","prevMessage","validation","refMap","formRef","formRefMap","current","inputNode","rule","find","validationRules","isValid","validate","validationRule","validateField","event","target","name","currentTarget","length","files","onBlur","keyCode","selectValue","select","shouldUpdate","fileValue","isControlled","min","max","isValueNaN","Number","isNaN","parseInt","result","substr","lastIndexOf","otherProps","defaultProps","Object","defineProperty","_FieldContainer"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport validationConfig from 'Component/Form/Form.config';\n\nimport Field from './Field.component';\nimport {\n    CHECKBOX_TYPE,\n    ENTER_KEY_CODE,\n    FILE_TYPE,\n    NUMBER_TYPE,\n    PASSWORD_TYPE,\n    RADIO_TYPE,\n    SELECT_TYPE,\n    TEXT_TYPE,\n    TEXTAREA_TYPE\n} from './Field.config';\n\n/** @namespace Component/Field/Container */\nexport class FieldContainer extends PureComponent {\n    static propTypes = {\n        isControlled: PropTypes.bool,\n        checked: PropTypes.oneOfType([\n            PropTypes.bool,\n            PropTypes.string\n        ]),\n        value: PropTypes.oneOfType([\n            PropTypes.string,\n            PropTypes.number,\n            PropTypes.bool\n        ]),\n        type: PropTypes.oneOf([\n            TEXT_TYPE,\n            NUMBER_TYPE,\n            TEXTAREA_TYPE,\n            PASSWORD_TYPE,\n            RADIO_TYPE,\n            CHECKBOX_TYPE,\n            SELECT_TYPE,\n            FILE_TYPE\n        ]).isRequired,\n        onChange: PropTypes.func,\n        onFocus: PropTypes.func,\n        onBlur: PropTypes.func,\n        onClick: PropTypes.func,\n        onKeyPress: PropTypes.func,\n        min: PropTypes.number,\n        max: PropTypes.number,\n        validation: PropTypes.arrayOf(PropTypes.string),\n        message: PropTypes.string,\n        customValidationStatus: PropTypes.bool,\n        id: PropTypes.string,\n        formRef: PropTypes.oneOfType([\n            PropTypes.func,\n            PropTypes.shape({ current: PropTypes.instanceOf(Element) })\n        ]),\n        formRefMap: PropTypes.object,\n        validateSeparately: PropTypes.bool,\n        isSubmitted: PropTypes.bool\n    };\n\n    static defaultProps = {\n        min: 1,\n        max: 99,\n        checked: false,\n        value: null,\n        onChange: () => {},\n        onFocus: () => {},\n        onBlur: () => {},\n        onClick: () => {},\n        onKeyPress: () => {},\n        formRef: () => {},\n        isControlled: false,\n        validation: [],\n        message: '',\n        customValidationStatus: null,\n        id: '',\n        formRefMap: {},\n        validateSeparately: false,\n        isSubmitted: false\n    };\n\n    containerFunctions = {\n        onChange: this.onChange.bind(this),\n        handleChange: this.handleChange.bind(this),\n        onChangeCheckbox: this.onChangeCheckbox.bind(this),\n        onFocus: this.onFocus.bind(this),\n        onKeyPress: this.onKeyPress.bind(this),\n        onKeyEnterDown: this.onKeyEnterDown.bind(this),\n        onClick: this.onClick.bind(this)\n    };\n\n    __construct(props) {\n        super.__construct(props);\n\n        const { checked } = props;\n        const value = this.getInitialPropsValue();\n\n        this.state = {\n            value,\n            checked,\n            validationMessage: '',\n            validationStatus: null,\n            eventId: ''\n        };\n    }\n\n    componentDidUpdate(prevProps) {\n        const { value: prevValue, checked: prevChecked, isSubmitted: prevSubmitted } = prevProps;\n        const {\n            value: currentValue,\n            checked: currChecked,\n            type,\n            id,\n            validateSeparately,\n            isSubmitted\n        } = this.props;\n        const { eventId } = this.state;\n\n        if (prevValue !== currentValue) {\n            // eslint-disable-next-line react/no-did-update-set-state\n            this.setState({ value: currentValue });\n        }\n        if (type === CHECKBOX_TYPE && currChecked !== prevChecked) {\n            // eslint-disable-next-line react/no-did-update-set-state\n            this.setState({ checked: currChecked });\n        }\n\n        // prevents validating all fields when entering data in only one of them\n        if (eventId === id || prevSubmitted !== isSubmitted || !validateSeparately) {\n            this.updateValidationStatus();\n            this.setValidationMessage(prevProps);\n        }\n    }\n\n    setValidationMessage(prevProps) {\n        const { message: prevMessage = {} } = prevProps;\n        const { message = {} } = this.props;\n        const { validationMessage = {} } = this.state;\n\n        if (message !== validationMessage && !prevMessage && message) {\n            this.setState({ validationMessage: message });\n        }\n    }\n\n    getInitialPropsValue() {\n        const { type, value } = this.props;\n\n        if (value) {\n            return value;\n        }\n\n        switch (type) {\n        case NUMBER_TYPE:\n            return 0;\n        case CHECKBOX_TYPE:\n            return false;\n        default:\n            return '';\n        }\n    }\n\n    containerProps = () => {\n        const {\n            checked: propsChecked,\n            customValidationStatus\n        } = this.props;\n\n        const {\n            type,\n            checked,\n            value,\n            validationStatus,\n            validationMessage,\n            filename\n        } = this.state;\n\n        return {\n            checked: type === CHECKBOX_TYPE ? propsChecked : checked,\n            value,\n            validationStatus: customValidationStatus ?? validationStatus,\n            message: validationMessage,\n            filename\n        };\n    };\n\n    validateField() {\n        const {\n            validation,\n            id,\n            formRef: refMap,\n            formRefMap\n        } = this.props;\n\n        if (!validation || !id || !refMap || !refMap.current) {\n            return {};\n        }\n\n        const { current: inputNode } = refMap || {};\n\n        if (!inputNode) {\n            return {};\n        }\n\n        // we are looking for validation and executing it\n        const rule = validation.find((rule) => {\n            if (!validationConfig[rule]) {\n                return false;\n            }\n\n            const validationRules = validationConfig[rule];\n            const isValid = validationRules.validate(inputNode, formRefMap);\n            return !isValid;\n        });\n\n        return validationConfig[rule] || {};\n    }\n\n    updateValidationStatus() {\n        const validationRule = this.validateField();\n\n        this.setState({\n            validationStatus: !validationRule.validate,\n            validationMessage: validationRule.message\n        });\n    }\n\n    onChange(event) {\n        const { type } = this.props;\n        this.setState({ eventId: event?.target?.name });\n\n        if (typeof event === 'string' || typeof event === 'number') {\n            return this.handleChange(event);\n        }\n\n        if (event.currentTarget.value.length <= 0) {\n            this.setState({\n                validationStatus: null\n            });\n        }\n\n        this.updateValidationStatus();\n\n        if (type === FILE_TYPE) {\n            return this.handleChange(event.target.value, false, event.target.files[0]);\n        }\n\n        return this.handleChange(event.target.value);\n    }\n\n    onChangeCheckbox(event) {\n        const { onChange } = this.props;\n        const { target: { checked, value } } = event;\n\n        if (onChange) {\n            onChange(value, checked);\n        }\n\n        this.setState({ checked });\n    }\n\n    onFocus(event) {\n        const { onFocus } = this.props;\n\n        if (onFocus) {\n            onFocus(event);\n        }\n    }\n\n    onBlur(event) {\n        const { onBlur } = this.props;\n\n        if (onBlur) {\n            onBlur(event);\n        }\n    }\n\n    onKeyPress(event) {\n        const { onKeyPress } = this.props;\n\n        if (onKeyPress) {\n            onKeyPress(event);\n        }\n    }\n\n    onKeyEnterDown(event) {\n        if (event.keyCode === ENTER_KEY_CODE) {\n            const value = event.target.value || 1;\n            this.handleChange(value);\n        }\n    }\n\n    onClick(event, selectValue = false) {\n        const { onClick } = this.props;\n\n        if (selectValue) {\n            event.target.select();\n        }\n        if (onClick) {\n            onClick(event);\n        }\n    }\n\n    handleChange(value, shouldUpdate = true, fileValue = false) {\n        const {\n            isControlled,\n            onChange,\n            type,\n            min,\n            max\n        } = this.props;\n\n        switch (type) {\n        case NUMBER_TYPE:\n            const isValueNaN = Number.isNaN(parseInt(value, 10));\n            if (min > value || value > max || isValueNaN) {\n                break;\n            }\n            if (onChange && shouldUpdate) {\n                onChange(value);\n            }\n            if (!isControlled) {\n                this.setState({ value });\n            }\n            break;\n        case FILE_TYPE:\n            if (value) {\n                const result = onChange && onChange(fileValue);\n\n                this.setState({\n                    value: result ? value : '',\n                    filename: result ? value.substr(value.lastIndexOf('\\\\') + 1) : ''\n                });\n            }\n\n            break;\n        default:\n            if (onChange) {\n                onChange(value);\n            }\n            if (!isControlled) {\n                this.setState({ value });\n            }\n        }\n    }\n\n    render() {\n        const { customValidationStatus, ...otherProps } = this.props;\n\n        return (\n            <Field\n              { ...otherProps }\n              { ...this.containerProps() }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\nexport default FieldContainer;\n"]},"metadata":{},"sourceType":"module"}