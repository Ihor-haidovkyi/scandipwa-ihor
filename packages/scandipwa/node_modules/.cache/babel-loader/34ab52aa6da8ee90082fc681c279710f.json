{"ast":null,"code":"var _jsxFileName = \"/home/marketihor/scandipwa/packages/scandipwa/src/component/NewVersionPopup/NewVersionPopup.container.js\";\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { goToPreviousNavigationState } from \"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.action\";\nimport { TOP_NAVIGATION_TYPE } from \"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.reducer\";\nimport { hideActiveOverlay } from \"/home/marketihor/scandipwa/packages/scandipwa/src/store/Overlay/Overlay.action\";\nimport { showPopup } from \"/home/marketihor/scandipwa/packages/scandipwa/src/store/Popup/Popup.action\";\nimport { DeviceType } from \"/home/marketihor/scandipwa/packages/scandipwa/src/type/Device\";\nimport NewVersionPopup from \"./NewVersionPopup.component\";\nimport { NEW_VERSION_POPUP_ID } from \"./NewVersionPopup.config\";\n/** @namespace Component/NewVersionPopup/Container/mapStateToProps */\n\nexport const mapStateToProps = middleware(function (state) {\n  return {\n    device: state.ConfigReducer.device\n  };\n}, \"Component/NewVersionPopup/Container/mapStateToProps\");\n/** @namespace Component/NewVersionPopup/Container/mapDispatchToProps */\n\nexport const mapDispatchToProps = middleware(function (dispatch) {\n  return {\n    showPopup: function (payload) {\n      return dispatch(showPopup(NEW_VERSION_POPUP_ID, payload));\n    },\n    goToPreviousHeaderState: function () {\n      return dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE));\n    },\n    hideActiveOverlay: function () {\n      return dispatch(hideActiveOverlay());\n    }\n  };\n}, \"Component/NewVersionPopup/Container/mapDispatchToProps\");\n/** @namespace Component/NewVersionPopup/Container */\n\nvar _checkBEM = require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;\n\nexport class _NewVersionPopupContainer extends Extensible(PureComponent) {\n  constructor(...args) {\n    super(...args);\n    this.containerFunctions = {\n      toggleNewVersion: this.toggleNewVersion.bind(this),\n      handleDismiss: this.handleDismiss.bind(this)\n    };\n  }\n\n  componentDidMount() {\n    const {\n      showPopup,\n      goToPreviousHeaderState,\n      device\n    } = this.props;\n\n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker.addEventListener('controllerchange', function () {\n        showPopup({\n          title: __('New version available!')\n        });\n\n        if (device.isMobile) {\n          goToPreviousHeaderState();\n        }\n      });\n    }\n  }\n\n  toggleNewVersion() {\n    window.location.reload();\n  }\n\n  handleDismiss() {\n    const {\n      hideActiveOverlay\n    } = this.props;\n    hideActiveOverlay();\n  }\n\n  render() {\n    return /*#__PURE__*/_checkBEM(React, NewVersionPopup, Object.assign({}, this.props, this.containerFunctions, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 13\n      }\n    }));\n  }\n\n}\n_NewVersionPopupContainer.propTypes = {\n  showPopup: PropTypes.func.isRequired,\n  goToPreviousHeaderState: PropTypes.func.isRequired,\n  device: DeviceType.isRequired,\n  hideActiveOverlay: PropTypes.func.isRequired\n};\nObject.defineProperty(_NewVersionPopupContainer, 'name', {\n  value: 'NewVersionPopupContainer'\n});\n\nexport const NewVersionPopupContainer = middleware(_NewVersionPopupContainer, \"Component/NewVersionPopup/Container\");\nexport default connect(mapStateToProps, mapDispatchToProps)(NewVersionPopupContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/NewVersionPopup/NewVersionPopup.container.js"],"names":["PropTypes","PureComponent","connect","goToPreviousNavigationState","TOP_NAVIGATION_TYPE","hideActiveOverlay","showPopup","DeviceType","NewVersionPopup","NEW_VERSION_POPUP_ID","mapStateToProps","state","device","ConfigReducer","mapDispatchToProps","dispatch","payload","goToPreviousHeaderState","NewVersionPopupContainer","containerFunctions","toggleNewVersion","bind","handleDismiss","componentDidMount","props","navigator","serviceWorker","addEventListener","title","__","isMobile","window","location","reload","render","propTypes","func","isRequired","Object","defineProperty","_NewVersionPopupContainer","value"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,OAAOA,SAAP,MAAsB,YAAtB;AACA,SAASC,aAAT,QAA8B,OAA9B;AACA,SAASC,OAAT,QAAwB,aAAxB;AAEA,SAASC,2BAAT;AACA,SAASC,mBAAT;AACA,SAASC,iBAAT;AACA,SAASC,SAAT;AACA,SAASC,UAAT;AAEA,OAAOC,eAAP;AACA,SAASC,oBAAT;AAEA;;AACA,OAAO,MAAMC,eAAe,cAAG,UAACC,KAAD;AAAA,SAAY;AACvCC,IAAAA,MAAM,EAAED,KAAK,CAACE,aAAN,CAAoBD;AADW,GAAZ;AAAA,CAAH,wDAArB;AAIP;;AACA,OAAO,MAAME,kBAAkB,cAAG,UAACC,QAAD;AAAA,SAAe;AAC7CT,IAAAA,SAAS,EAAE,UAACU,OAAD;AAAA,aAAaD,QAAQ,CAACT,SAAS,CAACG,oBAAD,EAAuBO,OAAvB,CAAV,CAArB;AAAA,KADkC;AAE7CC,IAAAA,uBAAuB,EAAE;AAAA,aAAMF,QAAQ,CAACZ,2BAA2B,CAACC,mBAAD,CAA5B,CAAd;AAAA,KAFoB;AAG7CC,IAAAA,iBAAiB,EAAE;AAAA,aAAMU,QAAQ,CAACV,iBAAiB,EAAlB,CAAd;AAAA;AAH0B,GAAf;AAAA,CAAH,2DAAxB;AAMP;;;;AACA,OAAO,MAAMa,yBAAN,mCAAqD;AAAA;AAAA;AAAA,SAQxDC,kBARwD,GAQnC;AACjBC,MAAAA,gBAAgB,EAAE,KAAKA,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CADD;AAEjBC,MAAAA,aAAa,EAAE,KAAKA,aAAL,CAAmBD,IAAnB,CAAwB,IAAxB;AAFE,KARmC;AAAA;;AAaxDE,EAAAA,iBAAiB,GAAG;AAChB,UAAM;AAAEjB,MAAAA,SAAF;AAAaW,MAAAA,uBAAb;AAAsCL,MAAAA;AAAtC,QAAiD,KAAKY,KAA5D;;AAEA,QAAI,mBAAmBC,SAAvB,EAAkC;AAC9BA,MAAAA,SAAS,CAACC,aAAV,CAAwBC,gBAAxB,CAAyC,kBAAzC,EAA6D,YAAM;AAC/DrB,QAAAA,SAAS,CAAC;AACNsB,UAAAA,KAAK,EAAEC,EAAE,CAAC,wBAAD;AADH,SAAD,CAAT;;AAIA,YAAIjB,MAAM,CAACkB,QAAX,EAAqB;AACjBb,UAAAA,uBAAuB;AAC1B;AACJ,OARD;AASH;AACJ;;AAEDG,EAAAA,gBAAgB,GAAG;AACfW,IAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACH;;AAEDX,EAAAA,aAAa,GAAG;AACZ,UAAM;AAAEjB,MAAAA;AAAF,QAAwB,KAAKmB,KAAnC;AAEAnB,IAAAA,iBAAiB;AACpB;;AAED6B,EAAAA,MAAM,GAAG;AACL,yCACK,eADL,oBAEW,KAAKV,KAFhB,EAGW,KAAKL,kBAHhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMH;;AA9CuD;AAA/CD,yB,CACFiB,S,GAAY;AACf7B,EAAAA,SAAS,EAAEN,SAAS,CAACoC,IAAV,CAAeC,UADX;AAEfpB,EAAAA,uBAAuB,EAAEjB,SAAS,CAACoC,IAAV,CAAeC,UAFzB;AAGfzB,EAAAA,MAAM,EAAEL,UAAU,CAAC8B,UAHJ;AAIfhC,EAAAA,iBAAiB,EAAEL,SAAS,CAACoC,IAAV,CAAeC;AAJnB,C;AAtCvBC,MAAM,CAACC,cAAP,CAAsBC,yBAAtB,EAAiD,MAAjD,EAAyD;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAAzD;;;AAsFA,eAAevC,OAAO,CAACQ,eAAD,EAAkBI,kBAAlB,CAAP,CAA6CI,wBAA7C,CAAf","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { goToPreviousNavigationState } from 'Store/Navigation/Navigation.action';\nimport { TOP_NAVIGATION_TYPE } from 'Store/Navigation/Navigation.reducer';\nimport { hideActiveOverlay } from 'Store/Overlay/Overlay.action';\nimport { showPopup } from 'Store/Popup/Popup.action';\nimport { DeviceType } from 'Type/Device';\n\nimport NewVersionPopup from './NewVersionPopup.component';\nimport { NEW_VERSION_POPUP_ID } from './NewVersionPopup.config';\n\n/** @namespace Component/NewVersionPopup/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    device: state.ConfigReducer.device\n});\n\n/** @namespace Component/NewVersionPopup/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    showPopup: (payload) => dispatch(showPopup(NEW_VERSION_POPUP_ID, payload)),\n    goToPreviousHeaderState: () => dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE)),\n    hideActiveOverlay: () => dispatch(hideActiveOverlay())\n});\n\n/** @namespace Component/NewVersionPopup/Container */\nexport class NewVersionPopupContainer extends PureComponent {\n    static propTypes = {\n        showPopup: PropTypes.func.isRequired,\n        goToPreviousHeaderState: PropTypes.func.isRequired,\n        device: DeviceType.isRequired,\n        hideActiveOverlay: PropTypes.func.isRequired\n    };\n\n    containerFunctions = {\n        toggleNewVersion: this.toggleNewVersion.bind(this),\n        handleDismiss: this.handleDismiss.bind(this)\n    };\n\n    componentDidMount() {\n        const { showPopup, goToPreviousHeaderState, device } = this.props;\n\n        if ('serviceWorker' in navigator) {\n            navigator.serviceWorker.addEventListener('controllerchange', () => {\n                showPopup({\n                    title: __('New version available!')\n                });\n\n                if (device.isMobile) {\n                    goToPreviousHeaderState();\n                }\n            });\n        }\n    }\n\n    toggleNewVersion() {\n        window.location.reload();\n    }\n\n    handleDismiss() {\n        const { hideActiveOverlay } = this.props;\n\n        hideActiveOverlay();\n    }\n\n    render() {\n        return (\n            <NewVersionPopup\n              { ...this.props }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NewVersionPopupContainer);\n"]},"metadata":{},"sourceType":"module"}