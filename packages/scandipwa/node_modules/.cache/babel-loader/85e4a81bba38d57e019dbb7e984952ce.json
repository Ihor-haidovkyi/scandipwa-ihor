{"ast":null,"code":"var _jsxFileName = \"/home/marketihor/scandipwa/packages/scandipwa/src/route/ConfirmAccountPage/ConfirmAccountPage.container.js\";\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { ERROR_TYPE } from \"/home/marketihor/scandipwa/packages/scandipwa/src/component/Notification/Notification.config\";\nimport { updateMeta } from \"/home/marketihor/scandipwa/packages/scandipwa/src/store/Meta/Meta.action\";\nimport { showNotification } from \"/home/marketihor/scandipwa/packages/scandipwa/src/store/Notification/Notification.action\";\nimport { LocationType } from \"/home/marketihor/scandipwa/packages/scandipwa/src/type/Router\";\nimport { convertQueryStringToKeyValuePairs } from \"/home/marketihor/scandipwa/packages/scandipwa/src/util/Url\";\nimport ConfirmAccountPage from \"./ConfirmAccountPage.component\";\nexport const BreadcrumbsDispatcher = import(\n/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Breadcrumbs/Breadcrumbs.dispatcher\");\nexport const MyAccountDispatcher = import(\n/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n\"/home/marketihor/scandipwa/packages/scandipwa/src/store/MyAccount/MyAccount.dispatcher\");\n/** @namespace Route/ConfirmAccountPage/Container/mapStateToProps */\n\nexport const mapStateToProps = middleware(function () {\n  return {};\n}, \"Route/ConfirmAccountPage/Container/mapStateToProps\");\n/** @namespace Route/ConfirmAccountPage/Container/mapDispatchToProps */\n\nexport const mapDispatchToProps = middleware(function (dispatch) {\n  return {\n    updateBreadcrumbs: function (breadcrumbs) {\n      BreadcrumbsDispatcher.then(function ({\n        default: dispatcher\n      }) {\n        return dispatcher.update(breadcrumbs, dispatch);\n      });\n    },\n    updateMeta: function (meta) {\n      return dispatch(updateMeta(meta));\n    },\n    confirmAccount: function (options) {\n      return MyAccountDispatcher.then(function ({\n        default: dispatcher\n      }) {\n        return dispatcher.confirmAccount(options, dispatch);\n      });\n    },\n    showNotification: function (type, message) {\n      return dispatch(showNotification(type, message));\n    },\n    signIn: function (options) {\n      return MyAccountDispatcher.then(function ({\n        default: dispatcher\n      }) {\n        return dispatcher.signIn(options, dispatch);\n      });\n    }\n  };\n}, \"Route/ConfirmAccountPage/Container/mapDispatchToProps\");\n/** @namespace Route/ConfirmAccountPage/Container */\n\nvar _checkBEM = require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;\n\nexport class _ConfirmAccountPageContainer extends Extensible(PureComponent) {\n  constructor(...args) {\n    super(...args);\n    this.containerFunctions = {\n      onConfirmAttempt: this.onConfirmAttempt.bind(this),\n      onConfirmSuccess: this.onConfirmSuccess.bind(this),\n      onFormError: this.onFormError.bind(this)\n    };\n  }\n\n  __construct(props) {\n    super.__construct(props);\n\n    this.state = {\n      redirect: false,\n      isLoading: false\n    };\n  }\n\n  componentDidMount() {\n    const {\n      updateMeta\n    } = this.props;\n    updateMeta({\n      title: __('Confirm account')\n    });\n\n    this._updateBreadcrumbs();\n  }\n\n  onConfirmAttempt() {\n    this.setState({\n      isLoading: true\n    });\n  }\n\n  onConfirmSuccess(fields) {\n    var _this = this;\n\n    const {\n      location: {\n        search\n      },\n      confirmAccount,\n      signIn\n    } = this.props;\n    const {\n      password\n    } = fields;\n    const options = convertQueryStringToKeyValuePairs(search);\n    const {\n      email\n    } = options;\n    confirmAccount({ ...options,\n      password\n    }).then(\n    /** @namespace Route/ConfirmAccountPage/Container/confirmAccountThen */\n    middleware(function (data) {\n      const {\n        msgType\n      } = data || {};\n\n      if (msgType === ERROR_TYPE) {\n        // error message is handled in the dispatcher\n        // just abort the chain\n        return Promise.reject();\n      }\n\n      return signIn({\n        email,\n        password\n      });\n    }, \"Route/ConfirmAccountPage/Container/confirmAccountThen\")).then(\n    /** @namespace Route/ConfirmAccountPage/Container/confirmAccountThenThen */\n    middleware(function () {\n      return _this.setState({\n        redirect: true\n      });\n    }, \"Route/ConfirmAccountPage/Container/confirmAccountThenThen\")).catch(\n    /** @namespace Route/ConfirmAccountPage/Container/confirmAccountThenThenCatch */\n    middleware(function () {\n      return _this.setState({\n        isLoading: false\n      });\n    }, \"Route/ConfirmAccountPage/Container/confirmAccountThenThenCatch\"));\n  }\n\n  onFormError() {\n    this.setState({\n      isLoading: false\n    });\n  }\n\n  _updateBreadcrumbs() {\n    const {\n      updateBreadcrumbs\n    } = this.props;\n    const breadcrumbs = [{\n      url: '/account/confirmAccount',\n      name: __('Confirm Account')\n    }];\n    updateBreadcrumbs(breadcrumbs);\n  }\n\n  render() {\n    return /*#__PURE__*/_checkBEM(React, ConfirmAccountPage, Object.assign({}, this.props, this.containerFunctions, this.state, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 13\n      }\n    }));\n  }\n\n}\n_ConfirmAccountPageContainer.propTypes = {\n  location: LocationType.isRequired,\n  signIn: PropTypes.func.isRequired,\n  updateMeta: PropTypes.func.isRequired,\n  confirmAccount: PropTypes.func.isRequired,\n  showNotification: PropTypes.func.isRequired,\n  updateBreadcrumbs: PropTypes.func.isRequired\n};\nObject.defineProperty(_ConfirmAccountPageContainer, 'name', {\n  value: 'ConfirmAccountPageContainer'\n});\n\nexport const ConfirmAccountPageContainer = middleware(_ConfirmAccountPageContainer, \"Route/ConfirmAccountPage/Container\");\nexport default connect(mapStateToProps, mapDispatchToProps)(ConfirmAccountPageContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/route/ConfirmAccountPage/ConfirmAccountPage.container.js"],"names":["PropTypes","PureComponent","connect","ERROR_TYPE","updateMeta","showNotification","LocationType","convertQueryStringToKeyValuePairs","ConfirmAccountPage","BreadcrumbsDispatcher","MyAccountDispatcher","mapStateToProps","mapDispatchToProps","dispatch","updateBreadcrumbs","breadcrumbs","then","default","dispatcher","update","meta","confirmAccount","options","type","message","signIn","ConfirmAccountPageContainer","containerFunctions","onConfirmAttempt","bind","onConfirmSuccess","onFormError","__construct","props","state","redirect","isLoading","componentDidMount","title","__","_updateBreadcrumbs","setState","fields","location","search","password","email","data","msgType","Promise","reject","catch","url","name","render","propTypes","isRequired","func","Object","defineProperty","_ConfirmAccountPageContainer","value"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,OAAOA,SAAP,MAAsB,YAAtB;AACA,SAASC,aAAT,QAA8B,OAA9B;AACA,SAASC,OAAT,QAAwB,aAAxB;AAEA,SAASC,UAAT;AACA,SAASC,UAAT;AACA,SAASC,gBAAT;AACA,SAASC,YAAT;AACA,SAASC,iCAAT;AAEA,OAAOC,kBAAP;AAEA,OAAO,MAAMC,qBAAqB,GAAG;AACjC;AADiC,6FAA9B;AAIP,OAAO,MAAMC,mBAAmB,GAAG;AAC/B;AAD+B,yFAA5B;AAKP;;AACA,OAAO,MAAMC,eAAe,cAAG;AAAA,SAAO,EAAP;AAAA,CAAH,uDAArB;AAEP;;AACA,OAAO,MAAMC,kBAAkB,cAAG,UAACC,QAAD;AAAA,SAAe;AAC7CC,IAAAA,iBAAiB,EAAE,UAACC,WAAD,EAAiB;AAChCN,MAAAA,qBAAqB,CAACO,IAAtB,CACI,UAAC;AAAEC,QAAAA,OAAO,EAAEC;AAAX,OAAD;AAAA,eAA6BA,UAAU,CAACC,MAAX,CAAkBJ,WAAlB,EAA+BF,QAA/B,CAA7B;AAAA,OADJ;AAGH,KAL4C;AAM7CT,IAAAA,UAAU,EAAE,UAACgB,IAAD;AAAA,aAAUP,QAAQ,CAACT,UAAU,CAACgB,IAAD,CAAX,CAAlB;AAAA,KANiC;AAO7CC,IAAAA,cAAc,EAAE,UAACC,OAAD;AAAA,aAAaZ,mBAAmB,CAACM,IAApB,CACzB,UAAC;AAAEC,QAAAA,OAAO,EAAEC;AAAX,OAAD;AAAA,eAA6BA,UAAU,CAACG,cAAX,CAA0BC,OAA1B,EAAmCT,QAAnC,CAA7B;AAAA,OADyB,CAAb;AAAA,KAP6B;AAU7CR,IAAAA,gBAAgB,EAAE,UAACkB,IAAD,EAAOC,OAAP;AAAA,aAAmBX,QAAQ,CAACR,gBAAgB,CAACkB,IAAD,EAAOC,OAAP,CAAjB,CAA3B;AAAA,KAV2B;AAW7CC,IAAAA,MAAM,EAAE,UAACH,OAAD;AAAA,aAAaZ,mBAAmB,CAACM,IAApB,CACjB,UAAC;AAAEC,QAAAA,OAAO,EAAEC;AAAX,OAAD;AAAA,eAA6BA,UAAU,CAACO,MAAX,CAAkBH,OAAlB,EAA2BT,QAA3B,CAA7B;AAAA,OADiB,CAAb;AAAA;AAXqC,GAAf;AAAA,CAAH,0DAAxB;AAgBP;;;;AACA,OAAO,MAAMa,4BAAN,mCAAwD;AAAA;AAAA;AAAA,SAU3DC,kBAV2D,GAUtC;AACjBC,MAAAA,gBAAgB,EAAE,KAAKA,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CADD;AAEjBC,MAAAA,gBAAgB,EAAE,KAAKA,gBAAL,CAAsBD,IAAtB,CAA2B,IAA3B,CAFD;AAGjBE,MAAAA,WAAW,EAAE,KAAKA,WAAL,CAAiBF,IAAjB,CAAsB,IAAtB;AAHI,KAVsC;AAAA;;AAgB3DG,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMD,WAAN,CAAkBC,KAAlB;;AAEA,SAAKC,KAAL,GAAa;AACTC,MAAAA,QAAQ,EAAE,KADD;AAETC,MAAAA,SAAS,EAAE;AAFF,KAAb;AAIH;;AAEDC,EAAAA,iBAAiB,GAAG;AAChB,UAAM;AAAEjC,MAAAA;AAAF,QAAiB,KAAK6B,KAA5B;AACA7B,IAAAA,UAAU,CAAC;AAAEkC,MAAAA,KAAK,EAAEC,EAAE,CAAC,iBAAD;AAAX,KAAD,CAAV;;AAEA,SAAKC,kBAAL;AACH;;AAEDZ,EAAAA,gBAAgB,GAAG;AACf,SAAKa,QAAL,CAAc;AAAEL,MAAAA,SAAS,EAAE;AAAb,KAAd;AACH;;AAEDN,EAAAA,gBAAgB,CAACY,MAAD,EAAS;AAAA;;AACrB,UAAM;AACFC,MAAAA,QAAQ,EAAE;AAAEC,QAAAA;AAAF,OADR;AAEFvB,MAAAA,cAFE;AAGFI,MAAAA;AAHE,QAIF,KAAKQ,KAJT;AAMA,UAAM;AAAEY,MAAAA;AAAF,QAAeH,MAArB;AAEA,UAAMpB,OAAO,GAAGf,iCAAiC,CAACqC,MAAD,CAAjD;AACA,UAAM;AAAEE,MAAAA;AAAF,QAAYxB,OAAlB;AAEAD,IAAAA,cAAc,CAAC,EAAE,GAAGC,OAAL;AAAcuB,MAAAA;AAAd,KAAD,CAAd,CACK7B,IADL;AAEQ;AAFR,eAGQ,UAAC+B,IAAD,EAAU;AACN,YAAM;AAAEC,QAAAA;AAAF,UAAcD,IAAI,IAAI,EAA5B;;AAEA,UAAIC,OAAO,KAAK7C,UAAhB,EAA4B;AACxB;AACA;AACA,eAAO8C,OAAO,CAACC,MAAR,EAAP;AACH;;AAED,aAAOzB,MAAM,CAAC;AAAEqB,QAAAA,KAAF;AAASD,QAAAA;AAAT,OAAD,CAAb;AACH,KAbT,4DAeK7B,IAfL;AAgBQ;AAhBR,eAiBQ;AAAA,aAAM,KAAI,CAACyB,QAAL,CAAc;AAAEN,QAAAA,QAAQ,EAAE;AAAZ,OAAd,CAAN;AAAA,KAjBR,gEAmBKgB,KAnBL;AAoBQ;AApBR,eAqBQ;AAAA,aAAM,KAAI,CAACV,QAAL,CAAc;AAAEL,QAAAA,SAAS,EAAE;AAAb,OAAd,CAAN;AAAA,KArBR;AAuBH;;AAEDL,EAAAA,WAAW,GAAG;AACV,SAAKU,QAAL,CAAc;AAAEL,MAAAA,SAAS,EAAE;AAAb,KAAd;AACH;;AAEDI,EAAAA,kBAAkB,GAAG;AACjB,UAAM;AAAE1B,MAAAA;AAAF,QAAwB,KAAKmB,KAAnC;AACA,UAAMlB,WAAW,GAAG,CAChB;AACIqC,MAAAA,GAAG,EAAE,yBADT;AAEIC,MAAAA,IAAI,EAAEd,EAAE,CAAC,iBAAD;AAFZ,KADgB,CAApB;AAOAzB,IAAAA,iBAAiB,CAACC,WAAD,CAAjB;AACH;;AAEDuC,EAAAA,MAAM,GAAG;AACL,yCACK,kBADL,oBAEW,KAAKrB,KAFhB,EAGW,KAAKN,kBAHhB,EAIW,KAAKO,KAJhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOH;;AAjG0D;AAAlDR,4B,CACF6B,S,GAAY;AACfZ,EAAAA,QAAQ,EAAErC,YAAY,CAACkD,UADR;AAEf/B,EAAAA,MAAM,EAAEzB,SAAS,CAACyD,IAAV,CAAeD,UAFR;AAGfpD,EAAAA,UAAU,EAAEJ,SAAS,CAACyD,IAAV,CAAeD,UAHZ;AAIfnC,EAAAA,cAAc,EAAErB,SAAS,CAACyD,IAAV,CAAeD,UAJhB;AAKfnD,EAAAA,gBAAgB,EAAEL,SAAS,CAACyD,IAAV,CAAeD,UALlB;AAMf1C,EAAAA,iBAAiB,EAAEd,SAAS,CAACyD,IAAV,CAAeD;AANnB,C;AAtDvBE,MAAM,CAACC,cAAP,CAAsBC,4BAAtB,EAAoD,MAApD,EAA4D;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA5D;;;AAyJA,eAAe3D,OAAO,CAACS,eAAD,EAAkBC,kBAAlB,CAAP,CAA6Cc,2BAA7C,CAAf","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { ERROR_TYPE } from 'Component/Notification/Notification.config';\nimport { updateMeta } from 'Store/Meta/Meta.action';\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport { LocationType } from 'Type/Router';\nimport { convertQueryStringToKeyValuePairs } from 'Util/Url';\n\nimport ConfirmAccountPage from './ConfirmAccountPage.component';\n\nexport const BreadcrumbsDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/Breadcrumbs/Breadcrumbs.dispatcher'\n);\nexport const MyAccountDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/MyAccount/MyAccount.dispatcher'\n);\n\n/** @namespace Route/ConfirmAccountPage/Container/mapStateToProps */\nexport const mapStateToProps = () => ({});\n\n/** @namespace Route/ConfirmAccountPage/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    updateBreadcrumbs: (breadcrumbs) => {\n        BreadcrumbsDispatcher.then(\n            ({ default: dispatcher }) => dispatcher.update(breadcrumbs, dispatch)\n        );\n    },\n    updateMeta: (meta) => dispatch(updateMeta(meta)),\n    confirmAccount: (options) => MyAccountDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.confirmAccount(options, dispatch)\n    ),\n    showNotification: (type, message) => dispatch(showNotification(type, message)),\n    signIn: (options) => MyAccountDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.signIn(options, dispatch)\n    )\n});\n\n/** @namespace Route/ConfirmAccountPage/Container */\nexport class ConfirmAccountPageContainer extends PureComponent {\n    static propTypes = {\n        location: LocationType.isRequired,\n        signIn: PropTypes.func.isRequired,\n        updateMeta: PropTypes.func.isRequired,\n        confirmAccount: PropTypes.func.isRequired,\n        showNotification: PropTypes.func.isRequired,\n        updateBreadcrumbs: PropTypes.func.isRequired\n    };\n\n    containerFunctions = {\n        onConfirmAttempt: this.onConfirmAttempt.bind(this),\n        onConfirmSuccess: this.onConfirmSuccess.bind(this),\n        onFormError: this.onFormError.bind(this)\n    };\n\n    __construct(props) {\n        super.__construct(props);\n\n        this.state = {\n            redirect: false,\n            isLoading: false\n        };\n    }\n\n    componentDidMount() {\n        const { updateMeta } = this.props;\n        updateMeta({ title: __('Confirm account') });\n\n        this._updateBreadcrumbs();\n    }\n\n    onConfirmAttempt() {\n        this.setState({ isLoading: true });\n    }\n\n    onConfirmSuccess(fields) {\n        const {\n            location: { search },\n            confirmAccount,\n            signIn\n        } = this.props;\n\n        const { password } = fields;\n\n        const options = convertQueryStringToKeyValuePairs(search);\n        const { email } = options;\n\n        confirmAccount({ ...options, password })\n            .then(\n                /** @namespace Route/ConfirmAccountPage/Container/confirmAccountThen */\n                (data) => {\n                    const { msgType } = data || {};\n\n                    if (msgType === ERROR_TYPE) {\n                        // error message is handled in the dispatcher\n                        // just abort the chain\n                        return Promise.reject();\n                    }\n\n                    return signIn({ email, password });\n                }\n            )\n            .then(\n                /** @namespace Route/ConfirmAccountPage/Container/confirmAccountThenThen */\n                () => this.setState({ redirect: true })\n            )\n            .catch(\n                /** @namespace Route/ConfirmAccountPage/Container/confirmAccountThenThenCatch */\n                () => this.setState({ isLoading: false })\n            );\n    }\n\n    onFormError() {\n        this.setState({ isLoading: false });\n    }\n\n    _updateBreadcrumbs() {\n        const { updateBreadcrumbs } = this.props;\n        const breadcrumbs = [\n            {\n                url: '/account/confirmAccount',\n                name: __('Confirm Account')\n            }\n        ];\n\n        updateBreadcrumbs(breadcrumbs);\n    }\n\n    render() {\n        return (\n            <ConfirmAccountPage\n              { ...this.props }\n              { ...this.containerFunctions }\n              { ...this.state }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ConfirmAccountPageContainer);\n"]},"metadata":{},"sourceType":"module"}