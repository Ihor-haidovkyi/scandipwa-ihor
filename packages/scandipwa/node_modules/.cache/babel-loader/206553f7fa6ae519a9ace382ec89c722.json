{"ast":null,"code":"var _jsxFileName = \"D:\\\\task\\\\magento2\\\\ScandiPWA\\\\packages\\\\scandipwa\\\\src\\\\component\\\\MyAccountCustomerPopup\\\\MyAccountCustomerPopup.container.js\";\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport MyAccountQuery from \"D:\\\\task\\\\magento2\\\\ScandiPWA\\\\packages\\\\scandipwa\\\\src\\\\query/MyAccount.query\";\nimport { updateCustomerDetails } from \"D:\\\\task\\\\magento2\\\\ScandiPWA\\\\packages\\\\scandipwa\\\\src\\\\store/MyAccount/MyAccount.action\";\nimport { CUSTOMER } from \"D:\\\\task\\\\magento2\\\\ScandiPWA\\\\packages\\\\scandipwa\\\\src\\\\store/MyAccount/MyAccount.dispatcher\";\nimport { goToPreviousNavigationState } from \"D:\\\\task\\\\magento2\\\\ScandiPWA\\\\packages\\\\scandipwa\\\\src\\\\store/Navigation/Navigation.action\";\nimport { TOP_NAVIGATION_TYPE } from \"D:\\\\task\\\\magento2\\\\ScandiPWA\\\\packages\\\\scandipwa\\\\src\\\\store/Navigation/Navigation.reducer\";\nimport { showNotification } from \"D:\\\\task\\\\magento2\\\\ScandiPWA\\\\packages\\\\scandipwa\\\\src\\\\store/Notification/Notification.action\";\nimport { hideActiveOverlay } from \"D:\\\\task\\\\magento2\\\\ScandiPWA\\\\packages\\\\scandipwa\\\\src\\\\store/Overlay/Overlay.action\";\nimport { isSignedIn } from \"D:\\\\task\\\\magento2\\\\ScandiPWA\\\\packages\\\\scandipwa\\\\src\\\\util/Auth\";\nimport BrowserDatabase from \"D:\\\\task\\\\magento2\\\\ScandiPWA\\\\packages\\\\scandipwa\\\\src\\\\util/BrowserDatabase\";\nimport { fetchMutation, getErrorMessage } from \"D:\\\\task\\\\magento2\\\\ScandiPWA\\\\packages\\\\scandipwa\\\\src\\\\util/Request\";\nimport { ONE_MONTH_IN_SECONDS } from \"D:\\\\task\\\\magento2\\\\ScandiPWA\\\\packages\\\\scandipwa\\\\src\\\\util/Request/QueryDispatcher\";\nimport MyAccountCustomerPopup from \"./MyAccountCustomerPopup.component\";\nimport { CUSTOMER_POPUP_ID } from \"./MyAccountCustomerPopup.config\";\n/** @namespace Component/MyAccountCustomerPopup/Container/mapStateToProps */\n\nexport const mapStateToProps = middleware(function (state) {\n  return {\n    payload: state.PopupReducer.popupPayload[CUSTOMER_POPUP_ID] || {}\n  };\n}, \"Component/MyAccountCustomerPopup/Container/mapStateToProps\");\n/** @namespace Component/MyAccountCustomerPopup/Container/mapDispatchToProps */\n\nexport const mapDispatchToProps = middleware(function (dispatch) {\n  return {\n    updateCustomer: function (customer) {\n      return dispatch(updateCustomerDetails(customer));\n    },\n    goToPreviousHeaderState: function () {\n      return dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE));\n    },\n    showErrorNotification: function (error) {\n      return dispatch(showNotification('error', getErrorMessage(error)));\n    },\n    showSuccessNotification: function (message) {\n      return dispatch(showNotification('success', message));\n    },\n    hideActiveOverlay: function () {\n      return dispatch(hideActiveOverlay());\n    }\n  };\n}, \"Component/MyAccountCustomerPopup/Container/mapDispatchToProps\");\n/** @namespace Component/MyAccountCustomerPopup/Container */\n\nvar _checkBEM = require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;\n\nexport class _MyAccountCustomerPopupContainer extends Extensible(PureComponent) {\n  constructor(...args) {\n    var _this;\n\n    super(...args);\n    _this = this;\n    this.state = {\n      isLoading: false\n    };\n    this.containerFunctions = {\n      onCustomerSave: this.onCustomerSave.bind(this),\n      onPasswordChange: this.onPasswordChange.bind(this)\n    };\n\n    this.onError = function (error) {\n      const {\n        showErrorNotification\n      } = _this.props;\n\n      _this.setState({\n        isLoading: false\n      });\n\n      showErrorNotification(error);\n    };\n  }\n\n  onCustomerSave(customer) {\n    var _this2 = this;\n\n    const {\n      updateCustomer,\n      hideActiveOverlay,\n      goToPreviousHeaderState\n    } = this.props;\n\n    if (!isSignedIn()) {\n      return null;\n    }\n\n    const mutation = MyAccountQuery.getUpdateInformationMutation(customer);\n    this.setState({\n      isLoading: true\n    });\n    return fetchMutation(mutation).then(\n    /** @namespace Component/MyAccountCustomerPopup/Container/onCustomerSaveFetchMutationThen */\n    middleware(function ({\n      updateCustomer: {\n        customer\n      }\n    }) {\n      BrowserDatabase.setItem(customer, CUSTOMER, ONE_MONTH_IN_SECONDS);\n      updateCustomer(customer);\n\n      _this2.setState({\n        isLoading: false\n      }, function () {\n        hideActiveOverlay();\n        goToPreviousHeaderState();\n      });\n    }, \"Component/MyAccountCustomerPopup/Container/onCustomerSaveFetchMutationThen\"), this.onError);\n  }\n\n  onPasswordChange(passwords) {\n    var _this3 = this;\n\n    const {\n      showSuccessNotification,\n      hideActiveOverlay,\n      goToPreviousHeaderState\n    } = this.props;\n\n    if (!isSignedIn()) {\n      return null;\n    }\n\n    const mutation = MyAccountQuery.getChangeCustomerPasswordMutation(passwords);\n    this.setState({\n      isLoading: true\n    });\n    return fetchMutation(mutation).then(\n    /** @namespace Component/MyAccountCustomerPopup/Container/onPasswordChangeFetchMutationThen */\n    middleware(function () {\n      showSuccessNotification(__('Your password was successfully updated!'));\n\n      _this3.setState({\n        isLoading: false\n      }, function () {\n        hideActiveOverlay();\n        goToPreviousHeaderState();\n      });\n    }, \"Component/MyAccountCustomerPopup/Container/onPasswordChangeFetchMutationThen\"), this.onError);\n  }\n\n  render() {\n    return /*#__PURE__*/_checkBEM(React, MyAccountCustomerPopup, Object.assign({}, this.props, this.state, this.containerFunctions, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 13\n      }\n    }));\n  }\n\n}\n_MyAccountCustomerPopupContainer.propTypes = {\n  updateCustomer: PropTypes.func.isRequired,\n  showErrorNotification: PropTypes.func.isRequired,\n  goToPreviousHeaderState: PropTypes.func.isRequired,\n  hideActiveOverlay: PropTypes.func.isRequired,\n  showSuccessNotification: PropTypes.func.isRequired\n};\nObject.defineProperty(_MyAccountCustomerPopupContainer, 'name', {\n  value: 'MyAccountCustomerPopupContainer'\n});\n\nexport const MyAccountCustomerPopupContainer = middleware(_MyAccountCustomerPopupContainer, \"Component/MyAccountCustomerPopup/Container\");\nexport default connect(mapStateToProps, mapDispatchToProps)(MyAccountCustomerPopupContainer);","map":{"version":3,"sources":["D:/task/magento2/ScandiPWA/packages/scandipwa/src/component/MyAccountCustomerPopup/MyAccountCustomerPopup.container.js"],"names":["PropTypes","PureComponent","connect","MyAccountQuery","updateCustomerDetails","CUSTOMER","goToPreviousNavigationState","TOP_NAVIGATION_TYPE","showNotification","hideActiveOverlay","isSignedIn","BrowserDatabase","fetchMutation","getErrorMessage","ONE_MONTH_IN_SECONDS","MyAccountCustomerPopup","CUSTOMER_POPUP_ID","mapStateToProps","state","payload","PopupReducer","popupPayload","mapDispatchToProps","dispatch","updateCustomer","customer","goToPreviousHeaderState","showErrorNotification","error","showSuccessNotification","message","MyAccountCustomerPopupContainer","isLoading","containerFunctions","onCustomerSave","bind","onPasswordChange","onError","props","setState","mutation","getUpdateInformationMutation","then","setItem","passwords","getChangeCustomerPasswordMutation","__","render","propTypes","func","isRequired","Object","defineProperty","_MyAccountCustomerPopupContainer","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport MyAccountQuery from 'Query/MyAccount.query';\nimport { updateCustomerDetails } from 'Store/MyAccount/MyAccount.action';\nimport { CUSTOMER } from 'Store/MyAccount/MyAccount.dispatcher';\nimport { goToPreviousNavigationState } from 'Store/Navigation/Navigation.action';\nimport { TOP_NAVIGATION_TYPE } from 'Store/Navigation/Navigation.reducer';\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport { hideActiveOverlay } from 'Store/Overlay/Overlay.action';\nimport { isSignedIn } from 'Util/Auth';\nimport BrowserDatabase from 'Util/BrowserDatabase';\nimport { fetchMutation, getErrorMessage } from 'Util/Request';\nimport { ONE_MONTH_IN_SECONDS } from 'Util/Request/QueryDispatcher';\n\nimport MyAccountCustomerPopup from './MyAccountCustomerPopup.component';\nimport { CUSTOMER_POPUP_ID } from './MyAccountCustomerPopup.config';\n\n/** @namespace Component/MyAccountCustomerPopup/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    payload: state.PopupReducer.popupPayload[CUSTOMER_POPUP_ID] || {}\n});\n\n/** @namespace Component/MyAccountCustomerPopup/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    updateCustomer: (customer) => dispatch(updateCustomerDetails(customer)),\n    goToPreviousHeaderState: () => dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE)),\n    showErrorNotification: (error) => dispatch(showNotification('error', getErrorMessage(error))),\n    showSuccessNotification: (message) => dispatch(showNotification('success', message)),\n    hideActiveOverlay: () => dispatch(hideActiveOverlay())\n});\n\n/** @namespace Component/MyAccountCustomerPopup/Container */\nexport class MyAccountCustomerPopupContainer extends PureComponent {\n    static propTypes = {\n        updateCustomer: PropTypes.func.isRequired,\n        showErrorNotification: PropTypes.func.isRequired,\n        goToPreviousHeaderState: PropTypes.func.isRequired,\n        hideActiveOverlay: PropTypes.func.isRequired,\n        showSuccessNotification: PropTypes.func.isRequired\n    };\n\n    state = {\n        isLoading: false\n    };\n\n    containerFunctions = {\n        onCustomerSave: this.onCustomerSave.bind(this),\n        onPasswordChange: this.onPasswordChange.bind(this)\n    };\n\n    onError = (error) => {\n        const { showErrorNotification } = this.props;\n        this.setState({ isLoading: false });\n        showErrorNotification(error);\n    };\n\n    onCustomerSave(customer) {\n        const {\n            updateCustomer,\n            hideActiveOverlay,\n            goToPreviousHeaderState\n        } = this.props;\n\n        if (!isSignedIn()) {\n            return null;\n        }\n\n        const mutation = MyAccountQuery.getUpdateInformationMutation(customer);\n        this.setState({ isLoading: true });\n\n        return fetchMutation(mutation).then(\n            /** @namespace Component/MyAccountCustomerPopup/Container/onCustomerSaveFetchMutationThen */\n            ({ updateCustomer: { customer } }) => {\n                BrowserDatabase.setItem(customer, CUSTOMER, ONE_MONTH_IN_SECONDS);\n                updateCustomer(customer);\n                this.setState({ isLoading: false }, () => {\n                    hideActiveOverlay();\n                    goToPreviousHeaderState();\n                });\n            },\n            this.onError\n        );\n    }\n\n    onPasswordChange(passwords) {\n        const {\n            showSuccessNotification,\n            hideActiveOverlay,\n            goToPreviousHeaderState\n        } = this.props;\n\n        if (!isSignedIn()) {\n            return null;\n        }\n\n        const mutation = MyAccountQuery.getChangeCustomerPasswordMutation(passwords);\n        this.setState({ isLoading: true });\n\n        return fetchMutation(mutation).then(\n            /** @namespace Component/MyAccountCustomerPopup/Container/onPasswordChangeFetchMutationThen */\n            () => {\n                showSuccessNotification(__('Your password was successfully updated!'));\n                this.setState({ isLoading: false }, () => {\n                    hideActiveOverlay();\n                    goToPreviousHeaderState();\n                });\n            },\n            this.onError\n        );\n    }\n\n    render() {\n        return (\n            <MyAccountCustomerPopup\n              { ...this.props }\n              { ...this.state }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MyAccountCustomerPopupContainer);\n"]},"metadata":{},"sourceType":"module"}