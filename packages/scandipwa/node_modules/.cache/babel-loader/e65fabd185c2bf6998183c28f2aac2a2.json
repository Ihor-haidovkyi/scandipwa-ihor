{"ast":null,"code":"import _defineProperty from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import PropTypes from'prop-types';import{connect}from'react-redux';import ProductList from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ProductList\";import ProductListQuery from\"/home/marketihor/scandipwa/packages/scandipwa/src/query/ProductList.query\";import{updateNoMatch}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/NoMatch/NoMatch.action\";import{showNotification}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Notification/Notification.action\";import{getIndexedProducts}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Product\";import DataContainer from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Request/DataContainer\";import\"./ProductListWidget.style\";/** @namespace Component/ProductListWidget/Container/mapDispatchToProps */ // eslint-disable-next-line no-unused-vars\nexport var mapDispatchToProps=middleware(function(dispatch){return{updateNoMatch:updateNoMatch,showNotification:showNotification};},\"Component/ProductListWidget/Container/mapDispatchToProps\");/** @namespace Component/ProductListWidget/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _ProductListWidgetContainer=/*#__PURE__*/function(_Extensible){_inherits(_ProductListWidgetContainer,_Extensible);var _super=_createSuper(_ProductListWidgetContainer);function _ProductListWidgetContainer(){var _this;_classCallCheck(this,_ProductListWidgetContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={pages:{},totalItems:0,totalPages:0,isLoading:true};_this.containerFunctions={requestProductList:_this.requestProductList.bind(_assertThisInitialized(_this)),updateLoadStatus:_this.updateLoadStatus.bind(_assertThisInitialized(_this)),getIsNewCategory:_this.getIsNewCategory.bind(_assertThisInitialized(_this))};_this.onError=_this.onError.bind(_assertThisInitialized(_this));_this.appendPage=_this.appendPage.bind(_assertThisInitialized(_this));_this.updateProductListItems=_this.updateProductListItems.bind(_assertThisInitialized(_this));_this.dataModelName='ProductListWidget';return _this;}_createClass(_ProductListWidgetContainer,[{key:\"onError\",value:function onError(error){var _this$props=this.props,showNotification=_this$props.showNotification,updateNoMatch=_this$props.updateNoMatch;showNotification('error',__('Error fetching Product List!'),error);updateNoMatch(true);}},{key:\"getIsNewCategory\",value:function getIsNewCategory(){return true;}},{key:\"appendPage\",value:function appendPage(data){var showPager=this.props.showPager;var pages=this.state.pages;var _data$products=data.products;_data$products=_data$products===void 0?{}:_data$products;var items=_data$products.items,_data$products$page_i=_data$products.page_info;_data$products$page_i=_data$products$page_i===void 0?{}:_data$products$page_i;var current_page=_data$products$page_i.current_page;if(showPager===0){return;}this.setState({pages:_objectSpread(_objectSpread({},pages),{},_defineProperty({},current_page,getIndexedProducts(items)))});}},{key:\"updateProductListItems\",value:function updateProductListItems(data){var _this$props2=this.props,productsCount=_this$props2.productsCount,productsPerPage=_this$props2.productsPerPage;var _data$products2=data.products;_data$products2=_data$products2===void 0?{}:_data$products2;var items=_data$products2.items,totalItems=_data$products2.total_count,_data$products2$page_=_data$products2.page_info;_data$products2$page_=_data$products2$page_===void 0?{}:_data$products2$page_;var current_page=_data$products2$page_.current_page;var totalPages=Math.ceil(productsCount/productsPerPage);this.setState({isLoading:false,totalItems:totalItems,totalPages:totalPages,pages:_defineProperty({},current_page,getIndexedProducts(items))});}},{key:\"updateLoadStatus\",value:function updateLoadStatus(isLoading){this.setState({isLoading:isLoading});}},{key:\"requestProductList\",value:function requestProductList(options){var isNext=options.isNext;if(!isNext){this.updateLoadStatus(true);}this.fetchData([ProductListQuery.getQuery(options)],isNext?this.appendPage:this.updateProductListItems,this.onError);}},{key:\"adaptProps\",value:function adaptProps(){var _this$props3=this.props,showPager=_this$props3.showPager,productsCount=_this$props3.productsCount,productsPerPage=_this$props3.productsPerPage,conditions=_this$props3.conditionsEncoded;return{filter:{conditions:conditions},pageSize:showPager?productsPerPage:productsCount,isPaginationEnabled:!!showPager};}},{key:\"render\",value:function render(){var adaptedProps=this.adaptProps();return/*#__PURE__*/_checkBEM(React,ProductList,Object.assign({},this.props,this.state,adaptedProps,this.containerFunctions,{isInfiniteLoaderEnabled:false,numberOfPlaceholders:6,mix:{block:'ProductListWidget'},isWidget:true}));}}]);return _ProductListWidgetContainer;}(Extensible(DataContainer));/** @namespace Component/ProductListWidget/Container/mapStateToProps */ // eslint-disable-next-line no-unused-vars\n_ProductListWidgetContainer.propTypes={showPager:PropTypes.number,productsCount:PropTypes.number,productsPerPage:PropTypes.number,conditionsEncoded:PropTypes.string,updateNoMatch:PropTypes.func.isRequired,showNotification:PropTypes.func.isRequired};_ProductListWidgetContainer.defaultProps={showPager:0,productsCount:10,productsPerPage:5,conditionsEncoded:null};Object.defineProperty(_ProductListWidgetContainer,'name',{value:'ProductListWidgetContainer'});export var ProductListWidgetContainer=middleware(_ProductListWidgetContainer,\"Component/ProductListWidget/Container\");export var mapStateToProps=middleware(function(state){return{};},\"Component/ProductListWidget/Container/mapStateToProps\");export default connect(mapStateToProps,mapDispatchToProps)(ProductListWidgetContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/ProductListWidget/ProductListWidget.container.js"],"names":["PropTypes","connect","ProductList","ProductListQuery","updateNoMatch","showNotification","getIndexedProducts","DataContainer","mapDispatchToProps","dispatch","ProductListWidgetContainer","state","pages","totalItems","totalPages","isLoading","containerFunctions","requestProductList","bind","updateLoadStatus","getIsNewCategory","onError","appendPage","updateProductListItems","dataModelName","error","props","__","data","showPager","products","items","page_info","current_page","setState","productsCount","productsPerPage","total_count","Math","ceil","options","isNext","fetchData","getQuery","conditions","conditionsEncoded","filter","pageSize","isPaginationEnabled","adaptedProps","adaptProps","block","propTypes","number","string","func","isRequired","defaultProps","Object","defineProperty","_ProductListWidgetContainer","value","mapStateToProps"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\n\nimport ProductList from 'Component/ProductList';\nimport ProductListQuery from 'Query/ProductList.query';\nimport { updateNoMatch } from 'Store/NoMatch/NoMatch.action';\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport { getIndexedProducts } from 'Util/Product';\nimport DataContainer from 'Util/Request/DataContainer';\n\nimport './ProductListWidget.style';\n\n/** @namespace Component/ProductListWidget/Container/mapDispatchToProps */\n// eslint-disable-next-line no-unused-vars\nexport const mapDispatchToProps = (dispatch) => ({\n    updateNoMatch,\n    showNotification\n});\n\n/** @namespace Component/ProductListWidget/Container */\nexport class ProductListWidgetContainer extends DataContainer {\n    static propTypes = {\n        showPager: PropTypes.number,\n        productsCount: PropTypes.number,\n        productsPerPage: PropTypes.number,\n        conditionsEncoded: PropTypes.string,\n        updateNoMatch: PropTypes.func.isRequired,\n        showNotification: PropTypes.func.isRequired\n    };\n\n    static defaultProps = {\n        showPager: 0,\n        productsCount: 10,\n        productsPerPage: 5,\n        conditionsEncoded: null\n    };\n\n    state = {\n        pages: {},\n        totalItems: 0,\n        totalPages: 0,\n        isLoading: true\n    };\n\n    containerFunctions = {\n        requestProductList: this.requestProductList.bind(this),\n        updateLoadStatus: this.updateLoadStatus.bind(this),\n        getIsNewCategory: this.getIsNewCategory.bind(this)\n    };\n\n    onError = this.onError.bind(this);\n\n    appendPage = this.appendPage.bind(this);\n\n    updateProductListItems = this.updateProductListItems.bind(this);\n\n    dataModelName = 'ProductListWidget';\n\n    onError(error) {\n        const { showNotification, updateNoMatch } = this.props;\n        showNotification('error', __('Error fetching Product List!'), error);\n        updateNoMatch(true);\n    }\n\n    getIsNewCategory() {\n        return true;\n    }\n\n    appendPage(data) {\n        const { showPager } = this.props;\n        const { pages } = this.state;\n        const {\n            products: {\n                items,\n                page_info: { current_page } = {}\n            } = {}\n        } = data;\n\n        if (showPager === 0) {\n            return;\n        }\n\n        this.setState({\n            pages: {\n                ...pages,\n                [current_page]: getIndexedProducts(items)\n            }\n        });\n    }\n\n    updateProductListItems(data) {\n        const { productsCount, productsPerPage } = this.props;\n        const {\n            products: {\n                items,\n                total_count: totalItems,\n                page_info: { current_page } = {}\n            } = {}\n        } = data;\n\n        const totalPages = Math.ceil(productsCount / productsPerPage);\n\n        this.setState({\n            isLoading: false,\n            totalItems,\n            totalPages,\n            pages: { [current_page]: getIndexedProducts(items) }\n        });\n    }\n\n    updateLoadStatus(isLoading) {\n        this.setState({ isLoading });\n    }\n\n    requestProductList(options) {\n        const { isNext } = options;\n\n        if (!isNext) {\n            this.updateLoadStatus(true);\n        }\n\n        this.fetchData(\n            [ProductListQuery.getQuery(options)],\n            isNext ? this.appendPage : this.updateProductListItems,\n            this.onError\n        );\n    }\n\n    adaptProps() {\n        const {\n            showPager,\n            productsCount,\n            productsPerPage,\n            conditionsEncoded: conditions\n        } = this.props;\n\n        return {\n            filter: { conditions },\n            pageSize: showPager ? productsPerPage : productsCount,\n            isPaginationEnabled: !!showPager\n        };\n    }\n\n    render() {\n        const adaptedProps = this.adaptProps();\n\n        return (\n            <ProductList\n              { ...this.props }\n              { ...this.state }\n              { ...adaptedProps }\n              { ...this.containerFunctions }\n              isInfiniteLoaderEnabled={ false }\n              numberOfPlaceholders={ 6 }\n              mix={ { block: 'ProductListWidget' } }\n              isWidget\n            />\n        );\n    }\n}\n\n/** @namespace Component/ProductListWidget/Container/mapStateToProps */\n// eslint-disable-next-line no-unused-vars\nexport const mapStateToProps = (state) => ({});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProductListWidgetContainer);\n"]},"metadata":{},"sourceType":"module"}