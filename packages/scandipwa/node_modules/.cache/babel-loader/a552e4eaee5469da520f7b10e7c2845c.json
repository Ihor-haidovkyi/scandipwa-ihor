{"ast":null,"code":"import _toConsumableArray from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _get from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";import _getPrototypeOf from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import ProductListQuery from\"/home/marketihor/scandipwa/packages/scandipwa/src/query/ProductList.query\";import{showNotification}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Notification/Notification.action\";import{updateRecentlyViewedProducts}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/RecentlyViewedProducts/RecentlyViewedProducts.action\";import{QueryDispatcher}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Request\";import getStore from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Store\";/**\n * RecentlyViewedProducts Dispatcher\n * @class RecentlyViewedProductsDispatcher\n * @extends QueryDispatcher\n * @namespace Store/RecentlyViewedProducts/Dispatcher\n */export var _RecentlyViewedProductsDispatcher=/*#__PURE__*/function(_Extensible){_inherits(_RecentlyViewedProductsDispatcher,_Extensible);var _super=_createSuper(_RecentlyViewedProductsDispatcher);function _RecentlyViewedProductsDispatcher(){_classCallCheck(this,_RecentlyViewedProductsDispatcher);return _super.apply(this,arguments);}_createClass(_RecentlyViewedProductsDispatcher,[{key:\"__construct\",value:function __construct(){_get(_getPrototypeOf(_RecentlyViewedProductsDispatcher.prototype),\"__construct\",this).call(this,'recentlyViewedProducts');}},{key:\"onSuccess\",value:function onSuccess(_ref,dispatch){var items=_ref.products.items;var state=getStore().getState();var storeCode=state.ConfigReducer.code;dispatch(updateRecentlyViewedProducts(items,storeCode));}},{key:\"onError\",value:function onError(error,dispatch){dispatch(showNotification('error',__('Error fetching Recently Viewed Products Information!'),error));}/**\n     * Prepare recentlyViewedProducts query\n     * @return {Query} RecentlyViewedProducts query\n     * @memberof recentlyViewedProductsDispatcher\n     * @param recentlyViewedProducts\n     */},{key:\"prepareRequest\",value:function prepareRequest(options){var recentProducts=options.recentProducts,store=options.store;var recentlyViewedProductsSKUs=recentProducts[store].reduce(function(productSKUs,item){var sku=item.sku;return[].concat(_toConsumableArray(productSKUs),[\"\".concat(sku.replace(/ /g,'%20'))]);},[]);return[ProductListQuery.getQuery({args:{filter:{productsSkuArray:recentlyViewedProductsSKUs}},notRequireInfo:true})];}}]);return _RecentlyViewedProductsDispatcher;}(Extensible(QueryDispatcher));Object.defineProperty(_RecentlyViewedProductsDispatcher,'name',{value:'RecentlyViewedProductsDispatcher'});export var RecentlyViewedProductsDispatcher=middleware(_RecentlyViewedProductsDispatcher,\"Store/RecentlyViewedProducts/Dispatcher\");export default new RecentlyViewedProductsDispatcher();","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/store/RecentlyViewedProducts/RecentlyViewedProducts.dispatcher.js"],"names":["ProductListQuery","showNotification","updateRecentlyViewedProducts","QueryDispatcher","getStore","RecentlyViewedProductsDispatcher","dispatch","items","products","state","getState","storeCode","ConfigReducer","code","error","__","options","recentProducts","store","recentlyViewedProductsSKUs","reduce","productSKUs","item","sku","replace","getQuery","args","filter","productsSkuArray","notRequireInfo","Object","defineProperty","_RecentlyViewedProductsDispatcher","value"],"mappings":"69BAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAEA,MAAOA,CAAAA,gBAAP,iFACA,OAASC,gBAAT,gGACA,OACIC,4BADJ,oHAGA,OAASC,eAAT,sEACA,MAAOC,CAAAA,QAAP,oEAEA;AACA;AACA;AACA;AACA;AACA,GACA,UAAaC,CAAAA,iCAAb,2WACI,sBAAc,CACV,gGAAkB,wBAAlB,EACH,CAHL,yBAKI,wBAAmCC,QAAnC,CAA6C,IAArBC,CAAAA,KAAqB,MAAjCC,QAAiC,CAArBD,KAAqB,CACzC,GAAME,CAAAA,KAAK,CAAGL,QAAQ,GAAGM,QAAX,EAAd,CADyC,GAG/BC,CAAAA,SAH+B,CAIrCF,KAAK,CAACG,aAJ+B,CAGrCC,IAHqC,CAMzCP,QAAQ,CAACJ,4BAA4B,CAACK,KAAD,CAAQI,SAAR,CAA7B,CAAR,CACH,CAZL,uBAcI,iBAAQG,KAAR,CAAeR,QAAf,CAAyB,CACrBA,QAAQ,CAACL,gBAAgB,CAAC,OAAD,CAAUc,EAAE,CAAC,sDAAD,CAAZ,CAAsED,KAAtE,CAAjB,CAAR,CACH,CAED;AACJ;AACA;AACA;AACA;AACA,OAvBA,8BAwBI,wBAAeE,OAAf,CAAwB,IACZC,CAAAA,cADY,CACcD,OADd,CACZC,cADY,CACIC,KADJ,CACcF,OADd,CACIE,KADJ,CAEpB,GAAMC,CAAAA,0BAA0B,CAAGF,cAAc,CAACC,KAAD,CAAd,CAAsBE,MAAtB,CAA6B,SAACC,WAAD,CAAcC,IAAd,CAAuB,IAC3EC,CAAAA,GAD2E,CACnED,IADmE,CAC3EC,GAD2E,CAEnF,mCAAWF,WAAX,aAA4BE,GAAG,CAACC,OAAJ,CAAY,IAAZ,CAAkB,KAAlB,CAA5B,IACH,CAHkC,CAGhC,EAHgC,CAAnC,CAKA,MAAO,CACHxB,gBAAgB,CAACyB,QAAjB,CAA0B,CACtBC,IAAI,CAAE,CACFC,MAAM,CAAE,CACJC,gBAAgB,CAAET,0BADd,CADN,CADgB,CAMtBU,cAAc,CAAE,IANM,CAA1B,CADG,CAAP,CAUH,CAzCL,4EAzBAC,MAAM,CAACC,cAAP,CAAsBC,iCAAtB,CAAyD,MAAzD,CAAiE,CAAEC,KAAK,CAAE,kCAAT,CAAjE,E,oIAqEA,cAAe,IAAI5B,CAAAA,gCAAJ,EAAf","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport ProductListQuery from 'Query/ProductList.query';\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport {\n    updateRecentlyViewedProducts\n} from 'Store/RecentlyViewedProducts/RecentlyViewedProducts.action';\nimport { QueryDispatcher } from 'Util/Request';\nimport getStore from 'Util/Store';\n\n/**\n * RecentlyViewedProducts Dispatcher\n * @class RecentlyViewedProductsDispatcher\n * @extends QueryDispatcher\n * @namespace Store/RecentlyViewedProducts/Dispatcher\n */\nexport class RecentlyViewedProductsDispatcher extends QueryDispatcher {\n    __construct() {\n        super.__construct('recentlyViewedProducts');\n    }\n\n    onSuccess({ products: { items } }, dispatch) {\n        const state = getStore().getState();\n        const {\n            code: storeCode\n        } = state.ConfigReducer;\n\n        dispatch(updateRecentlyViewedProducts(items, storeCode));\n    }\n\n    onError(error, dispatch) {\n        dispatch(showNotification('error', __('Error fetching Recently Viewed Products Information!'), error));\n    }\n\n    /**\n     * Prepare recentlyViewedProducts query\n     * @return {Query} RecentlyViewedProducts query\n     * @memberof recentlyViewedProductsDispatcher\n     * @param recentlyViewedProducts\n     */\n    prepareRequest(options) {\n        const { recentProducts, store } = options;\n        const recentlyViewedProductsSKUs = recentProducts[store].reduce((productSKUs, item) => {\n            const { sku } = item;\n            return [...productSKUs, `${ sku.replace(/ /g, '%20') }`];\n        }, []);\n\n        return [\n            ProductListQuery.getQuery({\n                args: {\n                    filter: {\n                        productsSkuArray: recentlyViewedProductsSKUs\n                    }\n                },\n                notRequireInfo: true\n            })\n        ];\n    }\n}\n\nexport default new RecentlyViewedProductsDispatcher();\n"]},"metadata":{},"sourceType":"module"}