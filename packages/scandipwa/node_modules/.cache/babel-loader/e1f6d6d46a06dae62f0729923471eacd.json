{"ast":null,"code":"import _objectSpread from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import BrowserDatabase from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/BrowserDatabase\";import{getIndexedProduct}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Product\";import{UPDATE_SHIPPING_PRICE,UPDATE_TOTALS}from\"./Cart.action\";export var CART_TOTALS='cart_totals';/** @namespace Store/Cart/Reducer/updateCartTotals */export var updateCartTotals=middleware(function(action){var cartTotals=action.cartData;if(Object.hasOwnProperty.call(cartTotals,'items')){var normalizedItemsProduct=cartTotals.items.map(function(item){var variants=item.variants,normalizedItem=_objectWithoutProperties(item,[\"variants\"]);normalizedItem.product=getIndexedProduct(item.product,item.sku);return normalizedItem;});cartTotals.items=normalizedItemsProduct;}BrowserDatabase.setItem(cartTotals,CART_TOTALS);return{cartTotals:cartTotals};},\"Store/Cart/Reducer/updateCartTotals\");/** @namespace Store/Cart/Reducer/updateShippingPrice */export var updateShippingPrice=middleware(function(action,state){var _action$data=action.data;_action$data=_action$data===void 0?{}:_action$data;var items=_action$data.items,rest=_objectWithoutProperties(_action$data,[\"items\"]);return{cartTotals:_objectSpread(_objectSpread({},state.cartTotals),rest)};},\"Store/Cart/Reducer/updateShippingPrice\");/** @namespace Store/Cart/Reducer/getInitialState */export var getInitialState=middleware(function(){return{cartTotals:BrowserDatabase.getItem(CART_TOTALS)||{}};},\"Store/Cart/Reducer/getInitialState\");/** @namespace Store/Cart/Reducer */export var CartReducer=middleware(function(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:getInitialState();var action=arguments.length>1?arguments[1]:undefined;var type=action.type;switch(type){case UPDATE_TOTALS:return updateCartTotals(action,state);case UPDATE_SHIPPING_PRICE:return updateShippingPrice(action,state);default:return state;}},\"Store/Cart/Reducer\");export default CartReducer;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/store/Cart/Cart.reducer.js"],"names":["BrowserDatabase","getIndexedProduct","UPDATE_SHIPPING_PRICE","UPDATE_TOTALS","CART_TOTALS","updateCartTotals","action","cartTotals","cartData","Object","hasOwnProperty","call","normalizedItemsProduct","items","map","item","variants","normalizedItem","product","sku","setItem","updateShippingPrice","state","data","rest","getInitialState","getItem","CartReducer","type"],"mappings":"qTAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAEA,MAAOA,CAAAA,eAAP,8EACA,OAASC,iBAAT,sEAEA,OAASC,qBAAT,CAAgCC,aAAhC,qBAEA,MAAO,IAAMC,CAAAA,WAAW,CAAG,aAApB,CAEP,qDACA,MAAO,IAAMC,CAAAA,gBAAgB,YAAG,SAACC,MAAD,CAAY,IACtBC,CAAAA,UADsB,CACPD,MADO,CAChCE,QADgC,CAGxC,GAAIC,MAAM,CAACC,cAAP,CAAsBC,IAAtB,CAA2BJ,UAA3B,CAAuC,OAAvC,CAAJ,CAAqD,CACjD,GAAMK,CAAAA,sBAAsB,CAAGL,UAAU,CAACM,KAAX,CAAiBC,GAAjB,CAAqB,SAACC,IAAD,CAAU,IAClDC,CAAAA,QADkD,CAClBD,IADkB,CAClDC,QADkD,CACrCC,cADqC,0BAClBF,IADkB,eAE1DE,cAAc,CAACC,OAAf,CAAyBjB,iBAAiB,CAACc,IAAI,CAACG,OAAN,CAAeH,IAAI,CAACI,GAApB,CAA1C,CAEA,MAAOF,CAAAA,cAAP,CACH,CAL8B,CAA/B,CAOAV,UAAU,CAACM,KAAX,CAAmBD,sBAAnB,CACH,CAEDZ,eAAe,CAACoB,OAAhB,CACIb,UADJ,CAEIH,WAFJ,EAKA,MAAO,CAAEG,UAAU,CAAVA,UAAF,CAAP,CACH,CApB4B,uCAAtB,CAsBP,wDACA,MAAO,IAAMc,CAAAA,mBAAmB,YAAG,SAACf,MAAD,CAASgB,KAAT,CAAmB,kBAM9ChB,MAN8C,CAE9CiB,IAF8C,oCAK1C,EAL0C,iBAG1CV,CAAAA,KAH0C,cAG1CA,KAH0C,CAIvCW,IAJuC,kDAQlD,MAAO,CACHjB,UAAU,gCACHe,KAAK,CAACf,UADH,EAEHiB,IAFG,CADP,CAAP,CAMH,CAd+B,0CAAzB,CAgBP,oDACA,MAAO,IAAMC,CAAAA,eAAe,YAAG,iBAAO,CAClClB,UAAU,CAAEP,eAAe,CAAC0B,OAAhB,CAAwBtB,WAAxB,GAAwC,EADlB,CAAP,EAAH,sCAArB,CAIP,oCACA,MAAO,IAAMuB,CAAAA,WAAW,YAAG,UAGtB,IAFDL,CAAAA,KAEC,2DAFOG,eAAe,EAEtB,IADDnB,CAAAA,MACC,8CACOsB,CAAAA,IADP,CACgBtB,MADhB,CACOsB,IADP,CAGD,OAAQA,IAAR,EACA,IAAKzB,CAAAA,aAAL,CACI,MAAOE,CAAAA,gBAAgB,CAACC,MAAD,CAASgB,KAAT,CAAvB,CACJ,IAAKpB,CAAAA,qBAAL,CACI,MAAOmB,CAAAA,mBAAmB,CAACf,MAAD,CAASgB,KAAT,CAA1B,CACJ,QACI,MAAOA,CAAAA,KAAP,CANJ,CAQH,CAduB,sBAAjB,CAgBP,cAAeK,CAAAA,WAAf","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport BrowserDatabase from 'Util/BrowserDatabase';\nimport { getIndexedProduct } from 'Util/Product';\n\nimport { UPDATE_SHIPPING_PRICE, UPDATE_TOTALS } from './Cart.action';\n\nexport const CART_TOTALS = 'cart_totals';\n\n/** @namespace Store/Cart/Reducer/updateCartTotals */\nexport const updateCartTotals = (action) => {\n    const { cartData: cartTotals } = action;\n\n    if (Object.hasOwnProperty.call(cartTotals, 'items')) {\n        const normalizedItemsProduct = cartTotals.items.map((item) => {\n            const { variants, ...normalizedItem } = item;\n            normalizedItem.product = getIndexedProduct(item.product, item.sku);\n\n            return normalizedItem;\n        });\n\n        cartTotals.items = normalizedItemsProduct;\n    }\n\n    BrowserDatabase.setItem(\n        cartTotals,\n        CART_TOTALS\n    );\n\n    return { cartTotals };\n};\n\n/** @namespace Store/Cart/Reducer/updateShippingPrice */\nexport const updateShippingPrice = (action, state) => {\n    const {\n        data: {\n            items,\n            ...rest\n        } = {}\n    } = action;\n\n    return {\n        cartTotals: {\n            ...state.cartTotals,\n            ...rest\n        }\n    };\n};\n\n/** @namespace Store/Cart/Reducer/getInitialState */\nexport const getInitialState = () => ({\n    cartTotals: BrowserDatabase.getItem(CART_TOTALS) || {}\n});\n\n/** @namespace Store/Cart/Reducer */\nexport const CartReducer = (\n    state = getInitialState(),\n    action\n) => {\n    const { type } = action;\n\n    switch (type) {\n    case UPDATE_TOTALS:\n        return updateCartTotals(action, state);\n    case UPDATE_SHIPPING_PRICE:\n        return updateShippingPrice(action, state);\n    default:\n        return state;\n    }\n};\n\nexport default CartReducer;\n"]},"metadata":{},"sourceType":"module"}