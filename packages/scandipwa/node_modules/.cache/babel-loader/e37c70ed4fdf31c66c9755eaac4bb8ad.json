{"ast":null,"code":"import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import CategoryDetails from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CategoryDetails\";import CategoryFilterOverlay from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CategoryFilterOverlay\";import{CATEGORY_FILTER_OVERLAY_ID}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CategoryFilterOverlay/CategoryFilterOverlay.config\";import CategoryItemsCount from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CategoryItemsCount\";import CategoryProductList from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CategoryProductList\";import CategorySort from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CategorySort\";import ContentWrapper from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ContentWrapper\";import Html from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/Html\";import{CategoryTreeType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Category\";import{DeviceType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Device\";import{FilterInputType,FilterType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/ProductList\";import BrowserDatabase from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/BrowserDatabase\";import{DISPLAY_MODE_BOTH,DISPLAY_MODE_CMS_BLOCK,DISPLAY_MODE_PRODUCTS,GRID_LAYOUT,LAYOUT_KEY,LIST_LAYOUT}from\"./CategoryPage.config\";import\"./CategoryPage.style\";/** @namespace Route/CategoryPage/Component */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _CategoryPage=/*#__PURE__*/function(_Extensible){_inherits(_CategoryPage,_Extensible);var _super=_createSuper(_CategoryPage);function _CategoryPage(){var _this;_classCallCheck(this,_CategoryPage);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={};_this.onFilterButtonClick=function(){var toggleOverlayByKey=_this.props.toggleOverlayByKey;toggleOverlayByKey(CATEGORY_FILTER_OVERLAY_ID);};_this.renderLayoutButton=function(type){var _this$props=_this.props,onGridButtonClick=_this$props.onGridButtonClick,onListButtonClick=_this$props.onListButtonClick;var activeLayoutType=_this.state.activeLayoutType;switch(type){case GRID_LAYOUT:return/*#__PURE__*/_checkBEM(React,\"button\",{key:type,onClick:onGridButtonClick,mix:{block:GRID_LAYOUT,mods:{isActive:activeLayoutType===GRID_LAYOUT}}},__('Grid'));case LIST_LAYOUT:return/*#__PURE__*/_checkBEM(React,\"button\",{key:type,onClick:onListButtonClick,mix:{block:LIST_LAYOUT,mods:{isActive:activeLayoutType===LIST_LAYOUT}}},__('List'));default:return false;}};return _this;}_createClass(_CategoryPage,[{key:\"displayProducts\",value:function displayProducts(){var _this$props$category=this.props.category;_this$props$category=_this$props$category===void 0?{}:_this$props$category;var _this$props$category$=_this$props$category.display_mode,display_mode=_this$props$category$===void 0?DISPLAY_MODE_PRODUCTS:_this$props$category$;return display_mode===null||display_mode===DISPLAY_MODE_PRODUCTS||display_mode===DISPLAY_MODE_BOTH;}},{key:\"displayCmsBlock\",value:function displayCmsBlock(){var _this$props$category2=this.props.category;_this$props$category2=_this$props$category2===void 0?{}:_this$props$category2;var display_mode=_this$props$category2.display_mode;return display_mode===DISPLAY_MODE_CMS_BLOCK||display_mode===DISPLAY_MODE_BOTH;}},{key:\"renderCategoryDetails\",value:function renderCategoryDetails(){var _this$props2=this.props,category=_this$props2.category,isCurrentCategoryLoaded=_this$props2.isCurrentCategoryLoaded;return/*#__PURE__*/_checkBEM(React,CategoryDetails,{category:category,isCurrentCategoryLoaded:isCurrentCategoryLoaded});}},{key:\"renderFilterButton\",value:function renderFilterButton(){var _this$props3=this.props,isContentFiltered=_this$props3.isContentFiltered,totalPages=_this$props3.totalPages,is_anchor=_this$props3.category.is_anchor;if(!isContentFiltered&&totalPages===0||!is_anchor){return null;}return/*#__PURE__*/_checkBEM(React,\"button\",{block:\"CategoryPage\",elem:\"Filter\",onClick:this.onFilterButtonClick},__('Filter'));}},{key:\"renderFilterOverlay\",value:function renderFilterOverlay(){var _this$props4=this.props,filters=_this$props4.filters,selectedFilters=_this$props4.selectedFilters,isMatchingInfoFilter=_this$props4.isMatchingInfoFilter;var is_anchor=this.props.category.is_anchor;if(!this.displayProducts()){return null;}return/*#__PURE__*/_checkBEM(React,CategoryFilterOverlay,{availableFilters:filters,customFiltersValues:selectedFilters,isMatchingInfoFilter:isMatchingInfoFilter,isCategoryAnchor:!!is_anchor});}},{key:\"renderCategorySort\",value:function renderCategorySort(){var _this$props5=this.props,sortFields=_this$props5.sortFields,selectedSort=_this$props5.selectedSort,onSortChange=_this$props5.onSortChange,isMatchingInfoFilter=_this$props5.isMatchingInfoFilter;var _sortFields$options=sortFields.options,options=_sortFields$options===void 0?{}:_sortFields$options;var updatedSortFields=Object.values(options).map(function(_ref){var id=_ref.value,label=_ref.label;return{id:id,label:label};});var sortDirection=selectedSort.sortDirection,sortKey=selectedSort.sortKey;return/*#__PURE__*/_checkBEM(React,CategorySort,{isMatchingInfoFilter:isMatchingInfoFilter,onSortChange:onSortChange,sortFields:updatedSortFields,sortKey:sortKey,sortDirection:sortDirection});}},{key:\"renderLayoutButtons\",value:function renderLayoutButtons(){var plpTypes=this.props.plpTypes;/*\n        * So far there is only two types of\n        * the Storefront list modes\n         */if(plpTypes.length!==2){return null;}return/*#__PURE__*/_checkBEM(React,\"div\",{block:\"CategoryPage\",elem:\"LayoutButtons\"},plpTypes.map(this.renderLayoutButton));}},{key:\"renderItemsCount\",value:function renderItemsCount(){var isVisibleOnMobile=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var _this$props6=this.props,isMatchingListFilter=_this$props6.isMatchingListFilter,device=_this$props6.device;if(isVisibleOnMobile&&!device.isMobile){return null;}if(!isVisibleOnMobile&&device.isMobile){return null;}return/*#__PURE__*/_checkBEM(React,CategoryItemsCount,{isMatchingListFilter:isMatchingListFilter});}},{key:\"renderCategoryProductList\",value:function renderCategoryProductList(){var _this$props7=this.props,filter=_this$props7.filter,search=_this$props7.search,selectedSort=_this$props7.selectedSort,selectedFilters=_this$props7.selectedFilters,isMatchingListFilter=_this$props7.isMatchingListFilter,isCurrentCategoryLoaded=_this$props7.isCurrentCategoryLoaded,isMatchingInfoFilter=_this$props7.isMatchingInfoFilter;var activeLayoutType=this.state.activeLayoutType;if(!this.displayProducts()){return null;}return/*#__PURE__*/_checkBEM(React,\"div\",{block:\"CategoryPage\",elem:\"ProductListWrapper\"},this.renderItemsCount(true),/*#__PURE__*/_checkBEM(React,CategoryProductList,{filter:filter,search:search,sort:selectedSort,selectedFilters:selectedFilters,isCurrentCategoryLoaded:isCurrentCategoryLoaded,isMatchingListFilter:isMatchingListFilter,isMatchingInfoFilter:isMatchingInfoFilter,layout:activeLayoutType}));}},{key:\"renderCmsBlock\",value:function renderCmsBlock(){var cms_block=this.props.category.cms_block;if(!cms_block||!this.displayCmsBlock()){return null;}var content=cms_block.content,disabled=cms_block.disabled;if(disabled){return null;}return/*#__PURE__*/_checkBEM(React,\"div\",{block:\"CategoryPage\",elem:\"CMS\"},/*#__PURE__*/_checkBEM(React,Html,{content:content}));}},{key:\"renderMiscellaneous\",value:function renderMiscellaneous(){if(!this.displayProducts()){return null;}return/*#__PURE__*/_checkBEM(React,\"aside\",{block:\"CategoryPage\",elem:\"Miscellaneous\"},/*#__PURE__*/_checkBEM(React,\"div\",{block:\"CategoryPage\",elem:\"LayoutWrapper\"},this.renderLayoutButtons(),this.renderItemsCount()),this.renderCategorySort(),this.renderFilterButton());}},{key:\"renderContent\",value:function renderContent(){return/*#__PURE__*/_checkBEM(React,React.Fragment,null,this.renderFilterOverlay(),this.renderCategoryDetails(),this.renderCmsBlock(),this.renderMiscellaneous(),this.renderCategoryProductList());}},{key:\"render\",value:function render(){var hideProducts=!this.displayProducts();return/*#__PURE__*/_checkBEM(React,\"main\",{block:\"CategoryPage\"},/*#__PURE__*/_checkBEM(React,ContentWrapper,{wrapperMix:{block:'CategoryPage',elem:'Wrapper',mods:{hideProducts:hideProducts}},label:\"Category page\"},this.renderContent()));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props){var isMobile=props.isMobile,defaultPlpType=props.defaultPlpType,selectedLayoutType=props.selectedLayoutType;/*\n        * Use stored plpType from the BrowserDatabase\n        * if there is one\n        */var storedPlpType=BrowserDatabase.getItem(LAYOUT_KEY)||selectedLayoutType;if(storedPlpType){var _activeLayoutType=isMobile?GRID_LAYOUT:storedPlpType||defaultPlpType;return{activeLayoutType:_activeLayoutType};}var activeLayoutType=isMobile?GRID_LAYOUT:selectedLayoutType||defaultPlpType;return{activeLayoutType:activeLayoutType};}}]);return _CategoryPage;}(Extensible(PureComponent));_CategoryPage.defaultProps={isContentFiltered:true,isMatchingListFilter:false,isCurrentCategoryLoaded:false,isMatchingInfoFilter:false,totalPages:1,is_anchor:true,search:'',selectedLayoutType:'',plpTypes:[]};Object.defineProperty(_CategoryPage,'name',{value:'CategoryPage'});export var CategoryPage=middleware(_CategoryPage,\"Route/CategoryPage/Component\");export default CategoryPage;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/route/CategoryPage/CategoryPage.component.js"],"names":["PureComponent","CategoryDetails","CategoryFilterOverlay","CATEGORY_FILTER_OVERLAY_ID","CategoryItemsCount","CategoryProductList","CategorySort","ContentWrapper","Html","CategoryTreeType","DeviceType","FilterInputType","FilterType","BrowserDatabase","DISPLAY_MODE_BOTH","DISPLAY_MODE_CMS_BLOCK","DISPLAY_MODE_PRODUCTS","GRID_LAYOUT","LAYOUT_KEY","LIST_LAYOUT","CategoryPage","state","onFilterButtonClick","toggleOverlayByKey","props","renderLayoutButton","type","onGridButtonClick","onListButtonClick","activeLayoutType","block","mods","isActive","__","category","display_mode","isCurrentCategoryLoaded","isContentFiltered","totalPages","is_anchor","filters","selectedFilters","isMatchingInfoFilter","displayProducts","sortFields","selectedSort","onSortChange","options","updatedSortFields","Object","values","map","id","value","label","sortDirection","sortKey","plpTypes","length","isVisibleOnMobile","isMatchingListFilter","device","isMobile","filter","search","renderItemsCount","cms_block","displayCmsBlock","content","disabled","renderLayoutButtons","renderCategorySort","renderFilterButton","renderFilterOverlay","renderCategoryDetails","renderCmsBlock","renderMiscellaneous","renderCategoryProductList","hideProducts","elem","renderContent","defaultPlpType","selectedLayoutType","storedPlpType","getItem","defaultProps","defineProperty","_CategoryPage"],"mappings":"ojBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAGA,OAASA,aAAT,KAA8B,OAA9B,CAEA,MAAOC,CAAAA,eAAP,mFACA,MAAOC,CAAAA,qBAAP,yFACA,OAASC,0BAAT,sHACA,MAAOC,CAAAA,kBAAP,sFACA,MAAOC,CAAAA,mBAAP,uFACA,MAAOC,CAAAA,YAAP,gFACA,MAAOC,CAAAA,cAAP,kFACA,MAAOC,CAAAA,IAAP,wEACA,OAASC,gBAAT,uEACA,OAASC,UAAT,qEACA,OAASC,eAAT,CAA0BC,UAA1B,0EACA,MAAOC,CAAAA,eAAP,8EAEA,OACIC,iBADJ,CAEIC,sBAFJ,CAGIC,qBAHJ,CAIIC,WAJJ,CAKIC,UALJ,CAMIC,WANJ,6BASA,6BAEA,8C,wEACA,UAAaC,CAAAA,aAAb,yVA8CIC,KA9CJ,CA8CY,EA9CZ,OA4EIC,mBA5EJ,CA4E0B,UAAM,IAChBC,CAAAA,kBADgB,CACO,MAAKC,KADZ,CAChBD,kBADgB,CAExBA,kBAAkB,CAACpB,0BAAD,CAAlB,CACH,CA/EL,OAiLIsB,kBAjLJ,CAiLyB,SAACC,IAAD,CAAU,iBAIvB,MAAKF,KAJkB,CAEvBG,iBAFuB,aAEvBA,iBAFuB,CAGvBC,iBAHuB,aAGvBA,iBAHuB,IAMnBC,CAAAA,gBANmB,CAME,MAAKR,KANP,CAMnBQ,gBANmB,CAQ3B,OAAQH,IAAR,EACA,IAAKT,CAAAA,WAAL,CACI,6CAEM,GAAG,CAAGS,IAFZ,CAGM,OAAO,CAAGC,iBAHhB,CAIM,GAAG,CAAG,CAAEG,KAAK,CAAEb,WAAT,CAAsBc,IAAI,CAAE,CAAEC,QAAQ,CAAEH,gBAAgB,GAAKZ,WAAjC,CAA5B,CAJZ,EAMUgB,EAAE,CAAC,MAAD,CANZ,EASJ,IAAKd,CAAAA,WAAL,CACI,6CAEM,GAAG,CAAGO,IAFZ,CAGM,OAAO,CAAGE,iBAHhB,CAIM,GAAG,CAAG,CAAEE,KAAK,CAAEX,WAAT,CAAsBY,IAAI,CAAE,CAAEC,QAAQ,CAAEH,gBAAgB,GAAKV,WAAjC,CAA5B,CAJZ,EAMUc,EAAE,CAAC,MAAD,CANZ,EASJ,QACI,MAAO,MAAP,CAtBJ,CAwBH,CAjNL,wEAiFI,0BAAkB,0BAKV,KAAKT,KALK,CAEVU,QAFU,oDAIN,EAJM,qEAGNC,YAHM,CAGNA,YAHM,gCAGSnB,qBAHT,uBAOd,MAAOmB,CAAAA,YAAY,GAAK,IAAjB,EACAA,YAAY,GAAKnB,qBADjB,EAEAmB,YAAY,GAAKrB,iBAFxB,CAGH,CA3FL,+BA6FI,0BAAkB,2BAC8B,KAAKU,KADnC,CACNU,QADM,sDACuB,EADvB,0BACMC,CAAAA,YADN,uBACMA,YADN,CAEd,MAAOA,CAAAA,YAAY,GAAKpB,sBAAjB,EACAoB,YAAY,GAAKrB,iBADxB,CAEH,CAjGL,qCAmGI,gCAAwB,kBAIhB,KAAKU,KAJW,CAEhBU,QAFgB,cAEhBA,QAFgB,CAGhBE,uBAHgB,cAGhBA,uBAHgB,CAMpB,mCACK,eADL,EAEM,QAAQ,CAAGF,QAFjB,CAGM,uBAAuB,CAAGE,uBAHhC,GAMH,CA/GL,kCAiHI,6BAAqB,kBACkD,KAAKZ,KADvD,CACTa,iBADS,cACTA,iBADS,CACUC,UADV,cACUA,UADV,CACkCC,SADlC,cACsBL,QADtB,CACkCK,SADlC,CAGjB,GAAK,CAACF,iBAAD,EAAsBC,UAAU,GAAK,CAAtC,EAA4C,CAACC,SAAjD,CAA4D,CACxD,MAAO,KAAP,CACH,CAED,6CAEM,KAAK,CAAC,cAFZ,CAGM,IAAI,CAAC,QAHX,CAIM,OAAO,CAAG,KAAKjB,mBAJrB,EAMUW,EAAE,CAAC,QAAD,CANZ,EASH,CAjIL,mCAmII,8BAAsB,kBAKd,KAAKT,KALS,CAEdgB,OAFc,cAEdA,OAFc,CAGdC,eAHc,cAGdA,eAHc,CAIdC,oBAJc,cAIdA,oBAJc,IAOEH,CAAAA,SAPF,CAOkB,KAAKf,KAPvB,CAOVU,QAPU,CAOEK,SAPF,CASlB,GAAI,CAAC,KAAKI,eAAL,EAAL,CAA6B,CACzB,MAAO,KAAP,CACH,CAED,mCACK,qBADL,EAEM,gBAAgB,CAAGH,OAFzB,CAGM,mBAAmB,CAAGC,eAH5B,CAIM,oBAAoB,CAAGC,oBAJ7B,CAKM,gBAAgB,CAAG,CAAC,CAACH,SAL3B,GAQH,CAxJL,kCA0JI,6BAAqB,kBAMb,KAAKf,KANQ,CAEboB,UAFa,cAEbA,UAFa,CAGbC,YAHa,cAGbA,YAHa,CAIbC,YAJa,cAIbA,YAJa,CAKbJ,oBALa,cAKbA,oBALa,yBAQQE,UARR,CAQTG,OARS,CAQTA,OARS,8BAQC,EARD,qBASjB,GAAMC,CAAAA,iBAAiB,CAAGC,MAAM,CAACC,MAAP,CAAcH,OAAd,EAAuBI,GAAvB,CAA2B,kBAAUC,CAAAA,EAAV,MAAGC,KAAH,CAAcC,KAAd,MAAcA,KAAd,OAA2B,CAAEF,EAAE,CAAFA,EAAF,CAAME,KAAK,CAALA,KAAN,CAA3B,EAA3B,CAA1B,CATiB,GAUTC,CAAAA,aAVS,CAUkBV,YAVlB,CAUTU,aAVS,CAUMC,OAVN,CAUkBX,YAVlB,CAUMW,OAVN,CAYjB,mCACK,YADL,EAEM,oBAAoB,CAAGd,oBAF7B,CAGM,YAAY,CAAGI,YAHrB,CAIM,UAAU,CAAGE,iBAJnB,CAKM,OAAO,CAAGQ,OALhB,CAMM,aAAa,CAAGD,aANtB,GASH,CA/KL,mCAmNI,8BAAsB,IACVE,CAAAA,QADU,CACG,KAAKjC,KADR,CACViC,QADU,CAGlB;AACR;AACA;AACA,WACQ,GAAIA,QAAQ,CAACC,MAAT,GAAoB,CAAxB,CAA2B,CACvB,MAAO,KAAP,CACH,CAED,0CACS,KAAK,CAAC,cADf,CAC8B,IAAI,CAAC,eADnC,EAEUD,QAAQ,CAACN,GAAT,CAAa,KAAK1B,kBAAlB,CAFV,EAKH,CAnOL,gCAqOI,2BAA4C,IAA3BkC,CAAAA,iBAA2B,2DAAP,KAAO,kBACC,KAAKnC,KADN,CAChCoC,oBADgC,cAChCA,oBADgC,CACVC,MADU,cACVA,MADU,CAGxC,GAAIF,iBAAiB,EAAI,CAACE,MAAM,CAACC,QAAjC,CAA2C,CACvC,MAAO,KAAP,CACH,CAED,GAAI,CAACH,iBAAD,EAAsBE,MAAM,CAACC,QAAjC,CAA2C,CACvC,MAAO,KAAP,CACH,CAED,mCACK,kBADL,EAEM,oBAAoB,CAAGF,oBAF7B,GAKH,CArPL,yCAuPI,oCAA4B,kBASpB,KAAKpC,KATe,CAEpBuC,MAFoB,cAEpBA,MAFoB,CAGpBC,MAHoB,cAGpBA,MAHoB,CAIpBnB,YAJoB,cAIpBA,YAJoB,CAKpBJ,eALoB,cAKpBA,eALoB,CAMpBmB,oBANoB,cAMpBA,oBANoB,CAOpBxB,uBAPoB,cAOpBA,uBAPoB,CAQpBM,oBARoB,cAQpBA,oBARoB,IAWhBb,CAAAA,gBAXgB,CAWK,KAAKR,KAXV,CAWhBQ,gBAXgB,CAaxB,GAAI,CAAC,KAAKc,eAAL,EAAL,CAA6B,CACzB,MAAO,KAAP,CACH,CAED,0CACS,KAAK,CAAC,cADf,CAC8B,IAAI,CAAC,oBADnC,EAEU,KAAKsB,gBAAL,CAAsB,IAAtB,CAFV,8BAGS,mBAHT,EAIU,MAAM,CAAGF,MAJnB,CAKU,MAAM,CAAGC,MALnB,CAMU,IAAI,CAAGnB,YANjB,CAOU,eAAe,CAAGJ,eAP5B,CAQU,uBAAuB,CAAGL,uBARpC,CASU,oBAAoB,CAAGwB,oBATjC,CAUU,oBAAoB,CAAGlB,oBAVjC,CAWU,MAAM,CAAGb,gBAXnB,IAeH,CAvRL,8BAyRI,yBAAiB,IACOqC,CAAAA,SADP,CACuB,KAAK1C,KAD5B,CACLU,QADK,CACOgC,SADP,CAGb,GAAI,CAACA,SAAD,EAAc,CAAC,KAAKC,eAAL,EAAnB,CAA2C,CACvC,MAAO,KAAP,CACH,CALY,GAOLC,CAAAA,OAPK,CAOiBF,SAPjB,CAOLE,OAPK,CAOIC,QAPJ,CAOiBH,SAPjB,CAOIG,QAPJ,CASb,GAAIA,QAAJ,CAAc,CACV,MAAO,KAAP,CACH,CAED,0CAEM,KAAK,CAAC,cAFZ,CAGM,IAAI,CAAC,KAHX,+BAKS,IALT,EAKc,OAAO,CAAGD,OALxB,IAQH,CA9SL,mCAgTI,8BAAsB,CAClB,GAAI,CAAC,KAAKzB,eAAL,EAAL,CAA6B,CACzB,MAAO,KAAP,CACH,CAED,4CACW,KAAK,CAAC,cADjB,CACgC,IAAI,CAAC,eADrC,sCAEa,KAAK,CAAC,cAFnB,CAEkC,IAAI,CAAC,eAFvC,EAGc,KAAK2B,mBAAL,EAHd,CAIc,KAAKL,gBAAL,EAJd,EAMU,KAAKM,kBAAL,EANV,CAOU,KAAKC,kBAAL,EAPV,EAUH,CA/TL,6BAiUI,wBAAgB,CACZ,uDAEU,KAAKC,mBAAL,EAFV,CAGU,KAAKC,qBAAL,EAHV,CAIU,KAAKC,cAAL,EAJV,CAKU,KAAKC,mBAAL,EALV,CAMU,KAAKC,yBAAL,EANV,EASH,CA3UL,sBA6UI,iBAAS,CACL,GAAMC,CAAAA,YAAY,CAAG,CAAC,KAAKnC,eAAL,EAAtB,CAEA,2CACU,KAAK,CAAC,cADhB,+BAES,cAFT,EAGU,UAAU,CAAG,CACTb,KAAK,CAAE,cADE,CAETiD,IAAI,CAAE,SAFG,CAGThD,IAAI,CAAE,CAAE+C,YAAY,CAAZA,YAAF,CAHG,CAHvB,CAQU,KAAK,CAAC,eARhB,EAUc,KAAKE,aAAL,EAVd,GAcH,CA9VL,0CAgDI,kCAAgCxD,KAAhC,CAAuC,IAE/BsC,CAAAA,QAF+B,CAK/BtC,KAL+B,CAE/BsC,QAF+B,CAG/BmB,cAH+B,CAK/BzD,KAL+B,CAG/ByD,cAH+B,CAI/BC,kBAJ+B,CAK/B1D,KAL+B,CAI/B0D,kBAJ+B,CAOnC;AACR;AACA;AACA,UACQ,GAAMC,CAAAA,aAAa,CAAGtE,eAAe,CAACuE,OAAhB,CAAwBlE,UAAxB,GAAuCgE,kBAA7D,CAEA,GAAIC,aAAJ,CAAmB,CACf,GAAMtD,CAAAA,iBAAgB,CAAGiC,QAAQ,CAC3B7C,WAD2B,CAE3BkE,aAAa,EAAIF,cAFvB,CAIA,MAAO,CAAEpD,gBAAgB,CAAhBA,iBAAF,CAAP,CACH,CAED,GAAMA,CAAAA,gBAAgB,CAAGiC,QAAQ,CAC3B7C,WAD2B,CAE3BiE,kBAAkB,EAAID,cAF5B,CAIA,MAAO,CAAEpD,gBAAgB,CAAhBA,gBAAF,CAAP,CACH,CA1EL,sDAAaT,a,CAkCFiE,Y,CAAe,CAClBhD,iBAAiB,CAAE,IADD,CAElBuB,oBAAoB,CAAE,KAFJ,CAGlBxB,uBAAuB,CAAE,KAHP,CAIlBM,oBAAoB,CAAE,KAJJ,CAKlBJ,UAAU,CAAE,CALM,CAMlBC,SAAS,CAAE,IANO,CAOlByB,MAAM,CAAE,EAPU,CAQlBkB,kBAAkB,CAAE,EARF,CASlBzB,QAAQ,CAAE,EATQ,C,CAzE1BR,MAAM,CAACqC,cAAP,CAAsBC,aAAtB,CAAqC,MAArC,CAA6C,CAAElC,KAAK,CAAE,cAAT,CAA7C,E,iFAwYA,cAAejC,CAAAA,YAAf","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport CategoryDetails from 'Component/CategoryDetails';\nimport CategoryFilterOverlay from 'Component/CategoryFilterOverlay';\nimport { CATEGORY_FILTER_OVERLAY_ID } from 'Component/CategoryFilterOverlay/CategoryFilterOverlay.config';\nimport CategoryItemsCount from 'Component/CategoryItemsCount';\nimport CategoryProductList from 'Component/CategoryProductList';\nimport CategorySort from 'Component/CategorySort';\nimport ContentWrapper from 'Component/ContentWrapper';\nimport Html from 'Component/Html';\nimport { CategoryTreeType } from 'Type/Category';\nimport { DeviceType } from 'Type/Device';\nimport { FilterInputType, FilterType } from 'Type/ProductList';\nimport BrowserDatabase from 'Util/BrowserDatabase';\n\nimport {\n    DISPLAY_MODE_BOTH,\n    DISPLAY_MODE_CMS_BLOCK,\n    DISPLAY_MODE_PRODUCTS,\n    GRID_LAYOUT,\n    LAYOUT_KEY,\n    LIST_LAYOUT\n} from './CategoryPage.config';\n\nimport './CategoryPage.style';\n\n/** @namespace Route/CategoryPage/Component */\nexport class CategoryPage extends PureComponent {\n    static propTypes = {\n        category: CategoryTreeType.isRequired,\n        filters: PropTypes.objectOf(PropTypes.shape).isRequired,\n        sortFields: PropTypes.shape({\n            options: PropTypes.array\n        }).isRequired,\n        selectedSort: PropTypes.shape({\n            sortDirection: PropTypes.oneOf([\n                'ASC',\n                'DESC'\n            ]),\n            sortKey: PropTypes.string\n        }).isRequired,\n        onSortChange: PropTypes.func.isRequired,\n        toggleOverlayByKey: PropTypes.func.isRequired,\n        selectedFilters: FilterType.isRequired,\n        filter: FilterInputType.isRequired,\n        search: PropTypes.string,\n        isContentFiltered: PropTypes.bool,\n        isCurrentCategoryLoaded: PropTypes.bool,\n        isMatchingListFilter: PropTypes.bool,\n        isMatchingInfoFilter: PropTypes.bool,\n        totalPages: PropTypes.number,\n        device: DeviceType.isRequired,\n        is_anchor: PropTypes.bool,\n        isMobile: PropTypes.bool.isRequired,\n        onGridButtonClick: PropTypes.func.isRequired,\n        onListButtonClick: PropTypes.func.isRequired,\n        defaultPlpType: PropTypes.string.isRequired,\n        selectedLayoutType: PropTypes.string,\n        plpTypes: PropTypes.arrayOf(PropTypes.string)\n    };\n\n    static defaultProps = {\n        isContentFiltered: true,\n        isMatchingListFilter: false,\n        isCurrentCategoryLoaded: false,\n        isMatchingInfoFilter: false,\n        totalPages: 1,\n        is_anchor: true,\n        search: '',\n        selectedLayoutType: '',\n        plpTypes: []\n    };\n\n    state = {};\n\n    static getDerivedStateFromProps(props) {\n        const {\n            isMobile,\n            defaultPlpType,\n            selectedLayoutType\n        } = props;\n\n        /*\n        * Use stored plpType from the BrowserDatabase\n        * if there is one\n        */\n        const storedPlpType = BrowserDatabase.getItem(LAYOUT_KEY) || selectedLayoutType;\n\n        if (storedPlpType) {\n            const activeLayoutType = isMobile\n                ? GRID_LAYOUT\n                : storedPlpType || defaultPlpType;\n\n            return { activeLayoutType };\n        }\n\n        const activeLayoutType = isMobile\n            ? GRID_LAYOUT\n            : selectedLayoutType || defaultPlpType;\n\n        return { activeLayoutType };\n    }\n\n    onFilterButtonClick = () => {\n        const { toggleOverlayByKey } = this.props;\n        toggleOverlayByKey(CATEGORY_FILTER_OVERLAY_ID);\n    };\n\n    displayProducts() {\n        const {\n            category: {\n                display_mode = DISPLAY_MODE_PRODUCTS\n            } = {}\n        } = this.props;\n\n        return display_mode === null\n            || display_mode === DISPLAY_MODE_PRODUCTS\n            || display_mode === DISPLAY_MODE_BOTH;\n    }\n\n    displayCmsBlock() {\n        const { category: { display_mode } = {} } = this.props;\n        return display_mode === DISPLAY_MODE_CMS_BLOCK\n            || display_mode === DISPLAY_MODE_BOTH;\n    }\n\n    renderCategoryDetails() {\n        const {\n            category,\n            isCurrentCategoryLoaded\n        } = this.props;\n\n        return (\n            <CategoryDetails\n              category={ category }\n              isCurrentCategoryLoaded={ isCurrentCategoryLoaded }\n            />\n        );\n    }\n\n    renderFilterButton() {\n        const { isContentFiltered, totalPages, category: { is_anchor } } = this.props;\n\n        if ((!isContentFiltered && totalPages === 0) || !is_anchor) {\n            return null;\n        }\n\n        return (\n            <button\n              block=\"CategoryPage\"\n              elem=\"Filter\"\n              onClick={ this.onFilterButtonClick }\n            >\n                { __('Filter') }\n            </button>\n        );\n    }\n\n    renderFilterOverlay() {\n        const {\n            filters,\n            selectedFilters,\n            isMatchingInfoFilter\n        } = this.props;\n\n        const { category: { is_anchor } } = this.props;\n\n        if (!this.displayProducts()) {\n            return null;\n        }\n\n        return (\n            <CategoryFilterOverlay\n              availableFilters={ filters }\n              customFiltersValues={ selectedFilters }\n              isMatchingInfoFilter={ isMatchingInfoFilter }\n              isCategoryAnchor={ !!is_anchor }\n            />\n        );\n    }\n\n    renderCategorySort() {\n        const {\n            sortFields,\n            selectedSort,\n            onSortChange,\n            isMatchingInfoFilter\n        } = this.props;\n\n        const { options = {} } = sortFields;\n        const updatedSortFields = Object.values(options).map(({ value: id, label }) => ({ id, label }));\n        const { sortDirection, sortKey } = selectedSort;\n\n        return (\n            <CategorySort\n              isMatchingInfoFilter={ isMatchingInfoFilter }\n              onSortChange={ onSortChange }\n              sortFields={ updatedSortFields }\n              sortKey={ sortKey }\n              sortDirection={ sortDirection }\n            />\n        );\n    }\n\n    renderLayoutButton = (type) => {\n        const {\n            onGridButtonClick,\n            onListButtonClick\n        } = this.props;\n\n        const { activeLayoutType } = this.state;\n\n        switch (type) {\n        case GRID_LAYOUT:\n            return (\n                <button\n                  key={ type }\n                  onClick={ onGridButtonClick }\n                  mix={ { block: GRID_LAYOUT, mods: { isActive: activeLayoutType === GRID_LAYOUT } } }\n                >\n                    { __('Grid') }\n                </button>\n            );\n        case LIST_LAYOUT:\n            return (\n                <button\n                  key={ type }\n                  onClick={ onListButtonClick }\n                  mix={ { block: LIST_LAYOUT, mods: { isActive: activeLayoutType === LIST_LAYOUT } } }\n                >\n                    { __('List') }\n                </button>\n            );\n        default:\n            return false;\n        }\n    };\n\n    renderLayoutButtons() {\n        const { plpTypes } = this.props;\n\n        /*\n        * So far there is only two types of\n        * the Storefront list modes\n         */\n        if (plpTypes.length !== 2) {\n            return null;\n        }\n\n        return (\n            <div block=\"CategoryPage\" elem=\"LayoutButtons\">\n                { plpTypes.map(this.renderLayoutButton) }\n            </div>\n        );\n    }\n\n    renderItemsCount(isVisibleOnMobile = false) {\n        const { isMatchingListFilter, device } = this.props;\n\n        if (isVisibleOnMobile && !device.isMobile) {\n            return null;\n        }\n\n        if (!isVisibleOnMobile && device.isMobile) {\n            return null;\n        }\n\n        return (\n            <CategoryItemsCount\n              isMatchingListFilter={ isMatchingListFilter }\n            />\n        );\n    }\n\n    renderCategoryProductList() {\n        const {\n            filter,\n            search,\n            selectedSort,\n            selectedFilters,\n            isMatchingListFilter,\n            isCurrentCategoryLoaded,\n            isMatchingInfoFilter\n        } = this.props;\n\n        const { activeLayoutType } = this.state;\n\n        if (!this.displayProducts()) {\n            return null;\n        }\n\n        return (\n            <div block=\"CategoryPage\" elem=\"ProductListWrapper\">\n                { this.renderItemsCount(true) }\n                <CategoryProductList\n                  filter={ filter }\n                  search={ search }\n                  sort={ selectedSort }\n                  selectedFilters={ selectedFilters }\n                  isCurrentCategoryLoaded={ isCurrentCategoryLoaded }\n                  isMatchingListFilter={ isMatchingListFilter }\n                  isMatchingInfoFilter={ isMatchingInfoFilter }\n                  layout={ activeLayoutType }\n                />\n            </div>\n        );\n    }\n\n    renderCmsBlock() {\n        const { category: { cms_block } } = this.props;\n\n        if (!cms_block || !this.displayCmsBlock()) {\n            return null;\n        }\n\n        const { content, disabled } = cms_block;\n\n        if (disabled) {\n            return null;\n        }\n\n        return (\n            <div\n              block=\"CategoryPage\"\n              elem=\"CMS\"\n            >\n                <Html content={ content } />\n            </div>\n        );\n    }\n\n    renderMiscellaneous() {\n        if (!this.displayProducts()) {\n            return null;\n        }\n\n        return (\n            <aside block=\"CategoryPage\" elem=\"Miscellaneous\">\n                <div block=\"CategoryPage\" elem=\"LayoutWrapper\">\n                    { this.renderLayoutButtons() }\n                    { this.renderItemsCount() }\n                </div>\n                { this.renderCategorySort() }\n                { this.renderFilterButton() }\n            </aside>\n        );\n    }\n\n    renderContent() {\n        return (\n            <>\n                { this.renderFilterOverlay() }\n                { this.renderCategoryDetails() }\n                { this.renderCmsBlock() }\n                { this.renderMiscellaneous() }\n                { this.renderCategoryProductList() }\n            </>\n        );\n    }\n\n    render() {\n        const hideProducts = !this.displayProducts();\n\n        return (\n            <main block=\"CategoryPage\">\n                <ContentWrapper\n                  wrapperMix={ {\n                      block: 'CategoryPage',\n                      elem: 'Wrapper',\n                      mods: { hideProducts }\n                  } }\n                  label=\"Category page\"\n                >\n                    { this.renderContent() }\n                </ContentWrapper>\n            </main>\n        );\n    }\n}\n\nexport default CategoryPage;\n"]},"metadata":{},"sourceType":"module"}