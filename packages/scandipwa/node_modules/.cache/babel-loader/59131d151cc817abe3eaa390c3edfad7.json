{"ast":null,"code":"var _jsxFileName = \"/home/marketihor/scandipwa/packages/scandipwa/src/component/WishlistItem/WishlistItem.container.js\";\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport SwipeToDelete from \"/home/marketihor/scandipwa/packages/scandipwa/src/component/SwipeToDelete\";\nimport { changeNavigationState } from \"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.action\";\nimport { TOP_NAVIGATION_TYPE } from \"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.reducer\";\nimport { showNotification } from \"/home/marketihor/scandipwa/packages/scandipwa/src/store/Notification/Notification.action\";\nimport { ProductType } from \"/home/marketihor/scandipwa/packages/scandipwa/src/type/ProductList\";\nimport { isSignedIn } from \"/home/marketihor/scandipwa/packages/scandipwa/src/util/Auth\";\nimport history from \"/home/marketihor/scandipwa/packages/scandipwa/src/util/History\";\nimport { debounce } from \"/home/marketihor/scandipwa/packages/scandipwa/src/util/Request\";\nimport { appendWithStoreCode } from \"/home/marketihor/scandipwa/packages/scandipwa/src/util/Url\";\nimport WishlistItem from \"./WishlistItem.component\";\nimport { UPDATE_WISHLIST_FREQUENCY } from \"./WishlistItem.config\";\nexport const CartDispatcher = import(\n/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Cart/Cart.dispatcher\");\nexport const WishlistDispatcher = import(\n/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Wishlist/Wishlist.dispatcher\");\n/** @namespace Component/WishlistItem/Container/mapStateToProps */\n// eslint-disable-next-line no-unused-vars\n\nexport const mapStateToProps = middleware(function (state) {\n  return {\n    isMobile: state.ConfigReducer.device.isMobile\n  };\n}, \"Component/WishlistItem/Container/mapStateToProps\");\n/** @namespace Component/WishlistItem/Container/mapDispatchToProps */\n\nexport const mapDispatchToProps = middleware(function (dispatch) {\n  return {\n    showNotification: function (type, message) {\n      return dispatch(showNotification(type, message));\n    },\n    addProductToCart: function (options) {\n      return CartDispatcher.then(function ({\n        default: dispatcher\n      }) {\n        return dispatcher.addProductToCart(dispatch, options);\n      });\n    },\n    updateWishlistItem: function (options) {\n      return WishlistDispatcher.then(function ({\n        default: dispatcher\n      }) {\n        return dispatcher.updateWishlistItem(dispatch, options);\n      });\n    },\n    removeFromWishlist: function (options) {\n      return WishlistDispatcher.then(function ({\n        default: dispatcher\n      }) {\n        return dispatcher.removeItemFromWishlist(dispatch, options);\n      });\n    },\n    changeHeaderState: function (state) {\n      return dispatch(changeNavigationState(TOP_NAVIGATION_TYPE, state));\n    }\n  };\n}, \"Component/WishlistItem/Container/mapDispatchToProps\");\n/** @namespace Component/WishlistItem/Container */\n\nvar _checkBEM = require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;\n\nexport class _WishlistItemContainer extends Extensible(PureComponent) {\n  constructor(...args) {\n    var _this;\n\n    super(...args);\n    _this = this;\n    this.containerFunctions = {\n      addToCart: this.addItemToCart.bind(this),\n      removeItem: this.removeItem.bind(this, false, true)\n    };\n    this.state = {\n      isLoading: false\n    };\n    this.removeItemOnSwipe = this.removeItem.bind(this, false, true);\n    this.changeQuantity = debounce(function (quantity) {\n      const {\n        product: {\n          wishlist: {\n            id: item_id\n          }\n        },\n        updateWishlistItem\n      } = _this.props;\n      updateWishlistItem({\n        item_id,\n        quantity\n      });\n    }, UPDATE_WISHLIST_FREQUENCY);\n    this.changeDescription = debounce(function (description) {\n      const {\n        product: {\n          wishlist: {\n            id: item_id\n          }\n        },\n        updateWishlistItem\n      } = _this.props;\n      updateWishlistItem({\n        item_id,\n        description\n      });\n    }, UPDATE_WISHLIST_FREQUENCY);\n\n    this.containerProps = function () {\n      const {\n        isLoading\n      } = _this.state;\n      return {\n        changeQuantity: _this.changeQuantity,\n        changeDescription: _this.changeDescription,\n        attributes: _this.getAttributes(),\n        isLoading\n      };\n    };\n\n    this.getConfigurableVariantIndex = function (sku, variants) {\n      return Object.keys(variants).find(function (i) {\n        return variants[i].sku === sku;\n      });\n    };\n\n    this.getAttributes = function () {\n      const {\n        product: {\n          variants,\n          configurable_options,\n          wishlist: {\n            sku: wishlistSku\n          }\n        }\n      } = _this.props;\n      const {\n        attributes = []\n      } = variants.find(function ({\n        sku\n      }) {\n        return sku === wishlistSku;\n      }) || {};\n      return attributes ? Object.values(attributes).reduce(function (acc, {\n        attribute_code,\n        attribute_value\n      }) {\n        const {\n          attribute_options: {\n            [attribute_value]: {\n              value,\n              label\n            } = {}\n          } = {}\n        } = configurable_options[attribute_code] || {};\n\n        if (value === attribute_value) {\n          acc.push(label);\n          return acc;\n        }\n\n        return acc;\n      }, []) : [];\n    };\n\n    this.renderRightSideContent = function () {\n      return /*#__PURE__*/_checkBEM(React, \"button\", {\n        block: \"WishlistItem\",\n        elem: \"SwipeToDeleteRightSide\",\n        onClick: _this.removeItemOnSwipe,\n        \"aria-label\": __('Remove'),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 9\n        }\n      }, __('Delete'));\n    };\n  }\n\n  addItemToCart() {\n    var _this2 = this;\n\n    const {\n      product: item,\n      addProductToCart,\n      showNotification\n    } = this.props;\n    const {\n      type_id,\n      variants,\n      wishlist: {\n        id,\n        sku,\n        quantity,\n        buy_request\n      }\n    } = item;\n\n    if (!isSignedIn()) {\n      return null;\n    }\n\n    if (type_id === 'configurable') {\n      const configurableVariantIndex = this.getConfigurableVariantIndex(sku, variants);\n\n      if (!configurableVariantIndex) {\n        history.push({\n          pathname: appendWithStoreCode(item.url)\n        });\n        showNotification('info', __('Please select product options!'));\n        return Promise.resolve();\n      }\n\n      item.configurableVariantIndex = configurableVariantIndex;\n    }\n\n    this.setState({\n      isLoading: true\n    });\n    return addProductToCart({\n      product: item,\n      quantity,\n      buyRequest: buy_request\n    }).then(\n    /** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartThen */\n    middleware(function () {\n      return _this2.removeItem(id);\n    }, \"Component/WishlistItem/Container/addItemToCartAddProductToCartThen\"),\n    /** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartCatch */\n    middleware(function () {\n      return _this2.showNotification('error', __('Error Adding Product To Cart'));\n    }, \"Component/WishlistItem/Container/addItemToCartAddProductToCartCatch\")).then(\n    /** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartThenThen */\n    middleware(function () {\n      return showNotification('success', __('Product Added To Cart'));\n    }, \"Component/WishlistItem/Container/addItemToCartAddProductToCartThenThen\")).catch(\n    /** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartThenThenCatch */\n    middleware(function () {\n      return _this2.showNotification('error', __('Error cleaning wishlist'));\n    }, \"Component/WishlistItem/Container/addItemToCartAddProductToCartThenThenCatch\"));\n  }\n\n  showNotification(...args) {\n    const {\n      showNotification\n    } = this.props;\n    this.setState({\n      isLoading: false\n    });\n    showNotification(...args);\n  }\n\n  removeItem(noMessages = true, isRemoveOnly = false) {\n    const {\n      product: {\n        wishlist: {\n          id: item_id\n        }\n      },\n      removeFromWishlist,\n      handleSelectIdChange\n    } = this.props;\n    this.setState({\n      isLoading: true\n    });\n    handleSelectIdChange(item_id, isRemoveOnly);\n    return removeFromWishlist({\n      item_id,\n      noMessages\n    });\n  }\n\n  render() {\n    const {\n      isLoading\n    } = this.state;\n    return /*#__PURE__*/_checkBEM(React, SwipeToDelete, {\n      renderRightSideContent: this.renderRightSideContent,\n      topElemMix: {\n        block: 'WishlistItem'\n      },\n      onAheadOfDragItemRemoveThreshold: this.containerFunctions.removeItem,\n      isLoading: isLoading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/_checkBEM(React, WishlistItem, Object.assign({}, this.props, this.containerProps(), this.containerFunctions, this.state, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 17\n      }\n    })));\n  }\n\n}\n_WishlistItemContainer.propTypes = {\n  product: ProductType.isRequired,\n  addProductToCart: PropTypes.func.isRequired,\n  showNotification: PropTypes.func.isRequired,\n  updateWishlistItem: PropTypes.func.isRequired,\n  removeFromWishlist: PropTypes.func.isRequired,\n  handleSelectIdChange: PropTypes.func.isRequired\n};\nObject.defineProperty(_WishlistItemContainer, 'name', {\n  value: 'WishlistItemContainer'\n});\n\nexport const WishlistItemContainer = middleware(_WishlistItemContainer, \"Component/WishlistItem/Container\");\nexport default connect(mapStateToProps, mapDispatchToProps)(WishlistItemContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/WishlistItem/WishlistItem.container.js"],"names":["PropTypes","PureComponent","connect","SwipeToDelete","changeNavigationState","TOP_NAVIGATION_TYPE","showNotification","ProductType","isSignedIn","history","debounce","appendWithStoreCode","WishlistItem","UPDATE_WISHLIST_FREQUENCY","CartDispatcher","WishlistDispatcher","mapStateToProps","state","isMobile","ConfigReducer","device","mapDispatchToProps","dispatch","type","message","addProductToCart","options","then","default","dispatcher","updateWishlistItem","removeFromWishlist","removeItemFromWishlist","changeHeaderState","WishlistItemContainer","containerFunctions","addToCart","addItemToCart","bind","removeItem","isLoading","removeItemOnSwipe","changeQuantity","quantity","product","wishlist","id","item_id","props","changeDescription","description","containerProps","attributes","getAttributes","getConfigurableVariantIndex","sku","variants","Object","keys","find","i","configurable_options","wishlistSku","values","reduce","acc","attribute_code","attribute_value","attribute_options","value","label","push","renderRightSideContent","__","item","type_id","buy_request","configurableVariantIndex","pathname","url","Promise","resolve","setState","buyRequest","catch","args","noMessages","isRemoveOnly","handleSelectIdChange","render","block","propTypes","isRequired","func","defineProperty","_WishlistItemContainer"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport SwipeToDelete from 'Component/SwipeToDelete';\nimport { changeNavigationState } from 'Store/Navigation/Navigation.action';\nimport { TOP_NAVIGATION_TYPE } from 'Store/Navigation/Navigation.reducer';\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport { ProductType } from 'Type/ProductList';\nimport { isSignedIn } from 'Util/Auth';\nimport history from 'Util/History';\nimport { debounce } from 'Util/Request';\nimport { appendWithStoreCode } from 'Util/Url';\n\nimport WishlistItem from './WishlistItem.component';\nimport { UPDATE_WISHLIST_FREQUENCY } from './WishlistItem.config';\n\nexport const CartDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/Cart/Cart.dispatcher'\n);\nexport const WishlistDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/Wishlist/Wishlist.dispatcher'\n);\n\n/** @namespace Component/WishlistItem/Container/mapStateToProps */\n// eslint-disable-next-line no-unused-vars\nexport const mapStateToProps = (state) => ({\n    isMobile: state.ConfigReducer.device.isMobile\n});\n\n/** @namespace Component/WishlistItem/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    showNotification: (type, message) => dispatch(showNotification(type, message)),\n    addProductToCart: (options) => CartDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.addProductToCart(dispatch, options)\n    ),\n    updateWishlistItem: (options) => WishlistDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.updateWishlistItem(dispatch, options)\n    ),\n    removeFromWishlist: (options) => WishlistDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.removeItemFromWishlist(dispatch, options)\n    ),\n    changeHeaderState: (state) => dispatch(changeNavigationState(TOP_NAVIGATION_TYPE, state))\n});\n\n/** @namespace Component/WishlistItem/Container */\nexport class WishlistItemContainer extends PureComponent {\n    static propTypes = {\n        product: ProductType.isRequired,\n        addProductToCart: PropTypes.func.isRequired,\n        showNotification: PropTypes.func.isRequired,\n        updateWishlistItem: PropTypes.func.isRequired,\n        removeFromWishlist: PropTypes.func.isRequired,\n        handleSelectIdChange: PropTypes.func.isRequired\n    };\n\n    containerFunctions = {\n        addToCart: this.addItemToCart.bind(this),\n        removeItem: this.removeItem.bind(this, false, true)\n    };\n\n    state = {\n        isLoading: false\n    };\n\n    removeItemOnSwipe = this.removeItem.bind(this, false, true);\n\n    changeQuantity = debounce((quantity) => {\n        const { product: { wishlist: { id: item_id } }, updateWishlistItem } = this.props;\n        updateWishlistItem({ item_id, quantity });\n    }, UPDATE_WISHLIST_FREQUENCY);\n\n    changeDescription = debounce((description) => {\n        const { product: { wishlist: { id: item_id } }, updateWishlistItem } = this.props;\n        updateWishlistItem({ item_id, description });\n    }, UPDATE_WISHLIST_FREQUENCY);\n\n    containerProps = () => {\n        const { isLoading } = this.state;\n\n        return {\n            changeQuantity: this.changeQuantity,\n            changeDescription: this.changeDescription,\n            attributes: this.getAttributes(),\n            isLoading\n        };\n    };\n\n    getConfigurableVariantIndex = (sku, variants) => Object.keys(variants).find((i) => variants[i].sku === sku);\n\n    getAttributes = () => {\n        const { product: { variants, configurable_options, wishlist: { sku: wishlistSku } } } = this.props;\n\n        const { attributes = [] } = variants.find(({ sku }) => sku === wishlistSku) || {};\n\n        return attributes ? Object.values(attributes).reduce((acc, { attribute_code, attribute_value }) => {\n            const {\n                attribute_options: {\n                    [attribute_value]: {\n                        value,\n                        label\n                    } = {}\n                } = {}\n            } = configurable_options[attribute_code] || {};\n\n            if (value === attribute_value) {\n                acc.push(label);\n\n                return acc;\n            }\n\n            return acc;\n        }, []) : [];\n    };\n\n    addItemToCart() {\n        const { product: item, addProductToCart, showNotification } = this.props;\n        const {\n            type_id,\n            variants,\n            wishlist: {\n                id, sku, quantity, buy_request\n            }\n        } = item;\n\n        if (!isSignedIn()) {\n            return null;\n        }\n\n        if (type_id === 'configurable') {\n            const configurableVariantIndex = this.getConfigurableVariantIndex(sku, variants);\n\n            if (!configurableVariantIndex) {\n                history.push({ pathname: appendWithStoreCode(item.url) });\n                showNotification('info', __('Please select product options!'));\n                return Promise.resolve();\n            }\n\n            item.configurableVariantIndex = configurableVariantIndex;\n        }\n\n        this.setState({ isLoading: true });\n\n        return addProductToCart({ product: item, quantity, buyRequest: buy_request })\n            .then(\n                /** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartThen */\n                () => this.removeItem(id),\n                /** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartCatch */\n                () => this.showNotification('error', __('Error Adding Product To Cart'))\n            )\n            .then(\n                /** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartThenThen */\n                () => showNotification('success', __('Product Added To Cart'))\n            )\n            .catch(\n                /** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartThenThenCatch */\n                () => this.showNotification('error', __('Error cleaning wishlist'))\n            );\n    }\n\n    showNotification(...args) {\n        const { showNotification } = this.props;\n        this.setState({ isLoading: false });\n        showNotification(...args);\n    }\n\n    removeItem(noMessages = true, isRemoveOnly = false) {\n        const { product: { wishlist: { id: item_id } }, removeFromWishlist, handleSelectIdChange } = this.props;\n        this.setState({ isLoading: true });\n\n        handleSelectIdChange(item_id, isRemoveOnly);\n\n        return removeFromWishlist({ item_id, noMessages });\n    }\n\n    renderRightSideContent = () => (\n        <button\n          block=\"WishlistItem\"\n          elem=\"SwipeToDeleteRightSide\"\n          onClick={ this.removeItemOnSwipe }\n          aria-label={ __('Remove') }\n        >\n            { __('Delete') }\n        </button>\n    );\n\n    render() {\n        const { isLoading } = this.state;\n\n        return (\n            <SwipeToDelete\n              renderRightSideContent={ this.renderRightSideContent }\n              topElemMix={ { block: 'WishlistItem' } }\n              onAheadOfDragItemRemoveThreshold={ this.containerFunctions.removeItem }\n              isLoading={ isLoading }\n            >\n                <WishlistItem\n                  { ...this.props }\n                  { ...this.containerProps() }\n                  { ...this.containerFunctions }\n                  { ...this.state }\n                />\n            </SwipeToDelete>\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(WishlistItemContainer);\n"]},"metadata":{},"sourceType":"module"}