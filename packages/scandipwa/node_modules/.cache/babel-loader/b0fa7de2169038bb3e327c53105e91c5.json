{"ast":null,"code":"import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import{connect}from'react-redux';import{goToPreviousNavigationState}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.action\";import{TOP_NAVIGATION_TYPE}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.reducer\";import{hideActiveOverlay as _hideActiveOverlay}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Overlay/Overlay.action\";import{showPopup as _showPopup}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Popup/Popup.action\";import{DeviceType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Device\";import NewVersionPopup from\"./NewVersionPopup.component\";import{NEW_VERSION_POPUP_ID}from\"./NewVersionPopup.config\";/** @namespace Component/NewVersionPopup/Container/mapStateToProps */export var mapStateToProps=middleware(function(state){return{device:state.ConfigReducer.device};},\"Component/NewVersionPopup/Container/mapStateToProps\");/** @namespace Component/NewVersionPopup/Container/mapDispatchToProps */export var mapDispatchToProps=middleware(function(dispatch){return{showPopup:function showPopup(payload){return dispatch(_showPopup(NEW_VERSION_POPUP_ID,payload));},goToPreviousHeaderState:function goToPreviousHeaderState(){return dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE));},hideActiveOverlay:function hideActiveOverlay(){return dispatch(_hideActiveOverlay());}};},\"Component/NewVersionPopup/Container/mapDispatchToProps\");/** @namespace Component/NewVersionPopup/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _NewVersionPopupContainer=/*#__PURE__*/function(_Extensible){_inherits(_NewVersionPopupContainer,_Extensible);var _super=_createSuper(_NewVersionPopupContainer);function _NewVersionPopupContainer(){var _this;_classCallCheck(this,_NewVersionPopupContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.containerFunctions={toggleNewVersion:_this.toggleNewVersion.bind(_assertThisInitialized(_this)),handleDismiss:_this.handleDismiss.bind(_assertThisInitialized(_this))};return _this;}_createClass(_NewVersionPopupContainer,[{key:\"componentDidMount\",value:function componentDidMount(){var _this$props=this.props,showPopup=_this$props.showPopup,goToPreviousHeaderState=_this$props.goToPreviousHeaderState,device=_this$props.device;if('serviceWorker'in navigator){navigator.serviceWorker.addEventListener('controllerchange',function(){showPopup({title:__('New version available!')});if(device.isMobile){goToPreviousHeaderState();}});}}},{key:\"toggleNewVersion\",value:function toggleNewVersion(){window.location.reload();}},{key:\"handleDismiss\",value:function handleDismiss(){var hideActiveOverlay=this.props.hideActiveOverlay;hideActiveOverlay();}},{key:\"render\",value:function render(){return/*#__PURE__*/_checkBEM(React,NewVersionPopup,Object.assign({},this.props,this.containerFunctions));}}]);return _NewVersionPopupContainer;}(Extensible(PureComponent));Object.defineProperty(_NewVersionPopupContainer,'name',{value:'NewVersionPopupContainer'});export var NewVersionPopupContainer=middleware(_NewVersionPopupContainer,\"Component/NewVersionPopup/Container\");export default connect(mapStateToProps,mapDispatchToProps)(NewVersionPopupContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/NewVersionPopup/NewVersionPopup.container.js"],"names":["PureComponent","connect","goToPreviousNavigationState","TOP_NAVIGATION_TYPE","hideActiveOverlay","showPopup","DeviceType","NewVersionPopup","NEW_VERSION_POPUP_ID","mapStateToProps","state","device","ConfigReducer","mapDispatchToProps","dispatch","payload","goToPreviousHeaderState","NewVersionPopupContainer","containerFunctions","toggleNewVersion","bind","handleDismiss","props","navigator","serviceWorker","addEventListener","title","__","isMobile","window","location","reload","Object","defineProperty","_NewVersionPopupContainer","value"],"mappings":"qtBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAGA,OAASA,aAAT,KAA8B,OAA9B,CACA,OAASC,OAAT,KAAwB,aAAxB,CAEA,OAASC,2BAAT,4FACA,OAASC,mBAAT,6FACA,OAASC,iBAAiB,GAAjBA,CAAAA,kBAAT,sFACA,OAASC,SAAS,GAATA,CAAAA,UAAT,kFACA,OAASC,UAAT,qEAEA,MAAOC,CAAAA,eAAP,mCACA,OAASC,oBAAT,gCAEA,qEACA,MAAO,IAAMC,CAAAA,eAAe,YAAG,SAACC,KAAD,QAAY,CACvCC,MAAM,CAAED,KAAK,CAACE,aAAN,CAAoBD,MADW,CAAZ,EAAH,uDAArB,CAIP,wEACA,MAAO,IAAME,CAAAA,kBAAkB,YAAG,SAACC,QAAD,QAAe,CAC7CT,SAAS,CAAE,mBAACU,OAAD,QAAaD,CAAAA,QAAQ,CAACT,UAAS,CAACG,oBAAD,CAAuBO,OAAvB,CAAV,CAArB,EADkC,CAE7CC,uBAAuB,CAAE,yCAAMF,CAAAA,QAAQ,CAACZ,2BAA2B,CAACC,mBAAD,CAA5B,CAAd,EAFoB,CAG7CC,iBAAiB,CAAE,mCAAMU,CAAAA,QAAQ,CAACV,kBAAiB,EAAlB,CAAd,EAH0B,CAAf,EAAH,0DAAxB,CAMP,qD,wEACA,UAAaa,CAAAA,yBAAb,yYAQIC,kBARJ,CAQyB,CACjBC,gBAAgB,CAAE,MAAKA,gBAAL,CAAsBC,IAAtB,+BADD,CAEjBC,aAAa,CAAE,MAAKA,aAAL,CAAmBD,IAAnB,+BAFE,CARzB,sFAaI,4BAAoB,iBACuC,KAAKE,KAD5C,CACRjB,SADQ,aACRA,SADQ,CACGW,uBADH,aACGA,uBADH,CAC4BL,MAD5B,aAC4BA,MAD5B,CAGhB,GAAI,iBAAmBY,CAAAA,SAAvB,CAAkC,CAC9BA,SAAS,CAACC,aAAV,CAAwBC,gBAAxB,CAAyC,kBAAzC,CAA6D,UAAM,CAC/DpB,SAAS,CAAC,CACNqB,KAAK,CAAEC,EAAE,CAAC,wBAAD,CADH,CAAD,CAAT,CAIA,GAAIhB,MAAM,CAACiB,QAAX,CAAqB,CACjBZ,uBAAuB,GAC1B,CACJ,CARD,EASH,CACJ,CA3BL,gCA6BI,2BAAmB,CACfa,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GACH,CA/BL,6BAiCI,wBAAgB,IACJ3B,CAAAA,iBADI,CACkB,KAAKkB,KADvB,CACJlB,iBADI,CAGZA,iBAAiB,GACpB,CArCL,sBAuCI,iBAAS,CACL,mCACK,eADL,kBAEW,KAAKkB,KAFhB,CAGW,KAAKJ,kBAHhB,GAMH,CA9CL,kEArCAc,MAAM,CAACC,cAAP,CAAsBC,yBAAtB,CAAiD,MAAjD,CAAyD,CAAEC,KAAK,CAAE,0BAAT,CAAzD,E,gHAsFA,cAAelC,CAAAA,OAAO,CAACQ,eAAD,CAAkBI,kBAAlB,CAAP,CAA6CI,wBAA7C,CAAf","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { goToPreviousNavigationState } from 'Store/Navigation/Navigation.action';\nimport { TOP_NAVIGATION_TYPE } from 'Store/Navigation/Navigation.reducer';\nimport { hideActiveOverlay } from 'Store/Overlay/Overlay.action';\nimport { showPopup } from 'Store/Popup/Popup.action';\nimport { DeviceType } from 'Type/Device';\n\nimport NewVersionPopup from './NewVersionPopup.component';\nimport { NEW_VERSION_POPUP_ID } from './NewVersionPopup.config';\n\n/** @namespace Component/NewVersionPopup/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    device: state.ConfigReducer.device\n});\n\n/** @namespace Component/NewVersionPopup/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    showPopup: (payload) => dispatch(showPopup(NEW_VERSION_POPUP_ID, payload)),\n    goToPreviousHeaderState: () => dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE)),\n    hideActiveOverlay: () => dispatch(hideActiveOverlay())\n});\n\n/** @namespace Component/NewVersionPopup/Container */\nexport class NewVersionPopupContainer extends PureComponent {\n    static propTypes = {\n        showPopup: PropTypes.func.isRequired,\n        goToPreviousHeaderState: PropTypes.func.isRequired,\n        device: DeviceType.isRequired,\n        hideActiveOverlay: PropTypes.func.isRequired\n    };\n\n    containerFunctions = {\n        toggleNewVersion: this.toggleNewVersion.bind(this),\n        handleDismiss: this.handleDismiss.bind(this)\n    };\n\n    componentDidMount() {\n        const { showPopup, goToPreviousHeaderState, device } = this.props;\n\n        if ('serviceWorker' in navigator) {\n            navigator.serviceWorker.addEventListener('controllerchange', () => {\n                showPopup({\n                    title: __('New version available!')\n                });\n\n                if (device.isMobile) {\n                    goToPreviousHeaderState();\n                }\n            });\n        }\n    }\n\n    toggleNewVersion() {\n        window.location.reload();\n    }\n\n    handleDismiss() {\n        const { hideActiveOverlay } = this.props;\n\n        hideActiveOverlay();\n    }\n\n    render() {\n        return (\n            <NewVersionPopup\n              { ...this.props }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NewVersionPopupContainer);\n"]},"metadata":{},"sourceType":"module"}