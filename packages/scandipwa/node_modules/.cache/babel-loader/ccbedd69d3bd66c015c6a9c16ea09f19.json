{"ast":null,"code":"import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import ContentWrapper from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ContentWrapper\";import ExpandableContent from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ExpandableContent\";import Popup from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/Popup\";import ProductReviewForm from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ProductReviewForm\";import ProductReviewList from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ProductReviewList\";import ProductReviewRating from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ProductReviewRating\";import{ProductType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/ProductList\";import{REVIEW_POPUP_ID}from\"./ProductReviews.config\";import\"./ProductReviews.style\";/** @namespace Component/ProductReviews/Component */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _ProductReviews=/*#__PURE__*/function(_Extensible){_inherits(_ProductReviews,_Extensible);var _super=_createSuper(_ProductReviews);function _ProductReviews(){_classCallCheck(this,_ProductReviews);return _super.apply(this,arguments);}_createClass(_ProductReviews,[{key:\"renderPopup\",value:function renderPopup(){var product=this.props.product;return/*#__PURE__*/_checkBEM(React,Popup,{id:REVIEW_POPUP_ID,mix:{block:'ProductReviews',elem:'Popup'}},/*#__PURE__*/_checkBEM(React,ProductReviewForm,{product:product}));}},{key:\"renderButton\",value:function renderButton(){var showPopup=this.props.showPopup;return/*#__PURE__*/_checkBEM(React,\"button\",{block:\"ProductReviews\",elem:\"Button\",mix:{block:'Button'},onClick:showPopup},__('Write a new review'));}},{key:\"renderNoRating\",value:function renderNoRating(){return/*#__PURE__*/_checkBEM(React,\"p\",null,__('There are no reviews yet! Click button on the right to submit one!'));}},{key:\"renderRatingSchema\",value:function renderRatingSchema(percent,reviewCount){return/*#__PURE__*/_checkBEM(React,React.Fragment,null,/*#__PURE__*/_checkBEM(React,\"meta\",{itemProp:\"ratingValue\",content:percent}),/*#__PURE__*/_checkBEM(React,\"meta\",{itemProp:\"worstRating\",content:0}),/*#__PURE__*/_checkBEM(React,\"meta\",{itemProp:\"bestRating\",content:100}),/*#__PURE__*/_checkBEM(React,\"meta\",{itemProp:\"reviewCount\",content:reviewCount}));}},{key:\"renderRatingData\",value:function renderRatingData(){var _this$props$product$r=this.props.product.review_summary;_this$props$product$r=_this$props$product$r===void 0?{}:_this$props$product$r;var rating_summary=_this$props$product$r.rating_summary,review_count=_this$props$product$r.review_count;var STARS_COUNT=5;var PERCENT=100;// eslint-disable-next-line no-mixed-operators\nvar percent=parseFloat(STARS_COUNT*(rating_summary||0)/PERCENT).toFixed(2);if(!review_count){return this.renderNoRating();}return/*#__PURE__*/_checkBEM(React,React.Fragment,null,this.renderRatingSchema(rating_summary,review_count),/*#__PURE__*/_checkBEM(React,ProductReviewRating,{mix:{block:'ProductReviews',elem:'SummaryRating'},summary:rating_summary}),/*#__PURE__*/_checkBEM(React,\"p\",{block:\"ProductReviews\",elem:\"SummaryDetails\"},percent,/*#__PURE__*/_checkBEM(React,\"span\",null,__('%s reviews',review_count||0))));}},{key:\"renderSummary\",value:function renderSummary(){var _this$props$product$r2=this.props.product.review_summary;_this$props$product$r2=_this$props$product$r2===void 0?{}:_this$props$product$r2;var review_count=_this$props$product$r2.review_count;var reviewSchemaObject=review_count?{itemType:'http://schema.org/AggregateRating',itemProp:'aggregateRating',itemScope:true}:{};return/*#__PURE__*/_checkBEM(React,\"div\",Object.assign({block:\"ProductReviews\",elem:\"Summary\"},reviewSchemaObject),this.renderRatingData(),this.renderButton());}},{key:\"renderList\",value:function renderList(){var product=this.props.product;return/*#__PURE__*/_checkBEM(React,ProductReviewList,{product:product});}},{key:\"render\",value:function render(){var _this$props=this.props,product=_this$props.product,areDetailsLoaded=_this$props.areDetailsLoaded;var _product$review_summa=product.review_summary;_product$review_summa=_product$review_summa===void 0?{}:_product$review_summa;var review_count=_product$review_summa.review_count;var heading=areDetailsLoaded?__('Product reviews (%s)',review_count||'0'):'';return/*#__PURE__*/_checkBEM(React,ContentWrapper,{label:\"Product reviews\",mix:{block:'ProductReviews'},wrapperMix:{block:'ProductReviews',elem:'Wrapper'}},/*#__PURE__*/_checkBEM(React,ExpandableContent,{mix:{block:'ProductReviews',elem:'Content'},heading:heading},this.renderSummary(),this.renderList(),this.renderPopup()));}}]);return _ProductReviews;}(Extensible(PureComponent));_ProductReviews.defaultProps={areDetailsLoaded:false};Object.defineProperty(_ProductReviews,'name',{value:'ProductReviews'});export var ProductReviews=middleware(_ProductReviews,\"Component/ProductReviews/Component\");export default ProductReviews;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/ProductReviews/ProductReviews.component.js"],"names":["PureComponent","ContentWrapper","ExpandableContent","Popup","ProductReviewForm","ProductReviewList","ProductReviewRating","ProductType","REVIEW_POPUP_ID","ProductReviews","product","props","block","elem","showPopup","__","percent","reviewCount","review_summary","rating_summary","review_count","STARS_COUNT","PERCENT","parseFloat","toFixed","renderNoRating","renderRatingSchema","reviewSchemaObject","itemType","itemProp","itemScope","renderRatingData","renderButton","areDetailsLoaded","heading","renderSummary","renderList","renderPopup","defaultProps","Object","defineProperty","_ProductReviews","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport ContentWrapper from 'Component/ContentWrapper';\nimport ExpandableContent from 'Component/ExpandableContent';\nimport Popup from 'Component/Popup';\nimport ProductReviewForm from 'Component/ProductReviewForm';\nimport ProductReviewList from 'Component/ProductReviewList';\nimport ProductReviewRating from 'Component/ProductReviewRating';\nimport { ProductType } from 'Type/ProductList';\n\nimport { REVIEW_POPUP_ID } from './ProductReviews.config';\n\nimport './ProductReviews.style';\n\n/** @namespace Component/ProductReviews/Component */\nexport class ProductReviews extends PureComponent {\n    static propTypes = {\n        product: ProductType.isRequired,\n        showPopup: PropTypes.func.isRequired,\n        areDetailsLoaded: PropTypes.bool\n    };\n\n    static defaultProps = {\n        areDetailsLoaded: false\n    };\n\n    renderPopup() {\n        const { product } = this.props;\n\n        return (\n            <Popup\n              id={ REVIEW_POPUP_ID }\n              mix={ { block: 'ProductReviews', elem: 'Popup' } }\n            >\n                <ProductReviewForm product={ product } />\n            </Popup>\n        );\n    }\n\n    renderButton() {\n        const { showPopup } = this.props;\n\n        return (\n            <button\n              block=\"ProductReviews\"\n              elem=\"Button\"\n              mix={ { block: 'Button' } }\n              onClick={ showPopup }\n            >\n                { __('Write a new review') }\n            </button>\n        );\n    }\n\n    renderNoRating() {\n        return (\n            <p>\n                { __('There are no reviews yet! Click button on the right to submit one!') }\n            </p>\n        );\n    }\n\n    renderRatingSchema(percent, reviewCount) {\n        return (\n            <>\n                <meta itemProp=\"ratingValue\" content={ percent } />\n                <meta itemProp=\"worstRating\" content={ 0 } />\n                <meta itemProp=\"bestRating\" content={ 100 } />\n                <meta itemProp=\"reviewCount\" content={ reviewCount } />\n            </>\n        );\n    }\n\n    renderRatingData() {\n        const {\n            product: {\n                review_summary: {\n                    rating_summary,\n                    review_count\n                } = {}\n            }\n        } = this.props;\n\n        const STARS_COUNT = 5;\n        const PERCENT = 100;\n\n        // eslint-disable-next-line no-mixed-operators\n        const percent = parseFloat(STARS_COUNT * (rating_summary || 0) / PERCENT).toFixed(2);\n\n        if (!review_count) {\n            return this.renderNoRating();\n        }\n\n        return (\n            <>\n                { this.renderRatingSchema(rating_summary, review_count) }\n                <ProductReviewRating\n                  mix={ { block: 'ProductReviews', elem: 'SummaryRating' } }\n                  summary={ rating_summary }\n                />\n                <p block=\"ProductReviews\" elem=\"SummaryDetails\">\n                    { percent }\n                    <span>{ __('%s reviews', review_count || 0) }</span>\n                </p>\n            </>\n        );\n    }\n\n    renderSummary() {\n        const {\n            product: {\n                review_summary: {\n                    review_count\n                } = {}\n            }\n        } = this.props;\n\n        const reviewSchemaObject = review_count\n            ? {\n                itemType: 'http://schema.org/AggregateRating',\n                itemProp: 'aggregateRating',\n                itemScope: true\n            } : {};\n\n        return (\n            <div\n              block=\"ProductReviews\"\n              elem=\"Summary\"\n              { ...reviewSchemaObject }\n            >\n                { this.renderRatingData() }\n                { this.renderButton() }\n            </div>\n        );\n    }\n\n    renderList() {\n        const { product } = this.props;\n\n        return (\n            <ProductReviewList\n              product={ product }\n            />\n        );\n    }\n\n    render() {\n        const {\n            product,\n            areDetailsLoaded\n        } = this.props;\n\n        const {\n            review_summary: { review_count } = {}\n        } = product;\n\n        const heading = areDetailsLoaded\n            ? __('Product reviews (%s)', review_count || '0')\n            : '';\n\n        return (\n            <ContentWrapper\n              label=\"Product reviews\"\n              mix={ { block: 'ProductReviews' } }\n              wrapperMix={ { block: 'ProductReviews', elem: 'Wrapper' } }\n            >\n                <ExpandableContent\n                  mix={ { block: 'ProductReviews', elem: 'Content' } }\n                  heading={ heading }\n                >\n                    { this.renderSummary() }\n                    { this.renderList() }\n                    { this.renderPopup() }\n                </ExpandableContent>\n            </ContentWrapper>\n        );\n    }\n}\n\nexport default ProductReviews;\n"]},"metadata":{},"sourceType":"module"}