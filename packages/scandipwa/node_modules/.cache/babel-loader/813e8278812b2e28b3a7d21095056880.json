{"ast":null,"code":"import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{createRef,PureComponent}from'react';import{SHARED_ELEMENT_TRANSITION}from\"./SharedTransition.config\";import\"./SharedTransition.style\";/** @namespace Component/SharedTransition/Component */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _SharedTransition=/*#__PURE__*/function(_Extensible){_inherits(_SharedTransition,_Extensible);var _super=_createSuper(_SharedTransition);function _SharedTransition(){var _this;_classCallCheck(this,_SharedTransition);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.sharedContainer=/*#__PURE__*/createRef();_this.animationSpeed=SHARED_ELEMENT_TRANSITION;_this.setDestinationTransform=_this.setTransform.bind(_assertThisInitialized(_this),'destinationPosition');_this.setStartingTransform=_this.setTransform.bind(_assertThisInitialized(_this),'startingPosition');_this.cleanUpTransition=function(){var wrapper=_this.sharedContainer.current;var cleanUpTransition=_this.props.cleanUpTransition;var range=document.createRange();range.selectNodeContents(wrapper);range.deleteContents();_this.transitionInAction=false;cleanUpTransition();};return _this;}_createClass(_SharedTransition,[{key:\"componentDidUpdate\",value:function componentDidUpdate(){if(this.transitionInAction){return;}this.updateSharedElement();}},{key:\"setTransform\",value:function setTransform(key){var _this$props$state$key=this.props.state[key],width=_this$props$state$key.width,height=_this$props$state$key.height,left=_this$props$state$key.left,top=_this$props$state$key.top;this.sharedContainer.current.style.cssText=\"\\n            --shared-element-width: \".concat(width,\"px;\\n            --shared-element-height: \").concat(height,\"px;\\n            --shared-element-top: \").concat(top,\"px;\\n            --shared-element-left: \").concat(left,\"px;\\n            --shared-element-animation-speed: \").concat(this.animationSpeed,\"ms;\\n        \");}},{key:\"updateSharedElement\",value:function updateSharedElement(){var _this$props$state=this.props.state,sharedElementDestination=_this$props$state.sharedElementDestination,sharedElement=_this$props$state.sharedElement;var wrapper=this.sharedContainer.current;if(!sharedElement||!sharedElementDestination||!wrapper){// this.cleanUpTransition();\nreturn;}this.transitionInAction=true;this.setStartingTransform();wrapper.appendChild(sharedElement);setTimeout(this.setDestinationTransform,0);setTimeout(this.cleanUpTransition,this.animationSpeed);}},{key:\"render\",value:function render(){var sharedElement=this.props.state.sharedElement;return/*#__PURE__*/_checkBEM(React,\"div\",{block:\"SharedTransition\",mods:{isVisible:!!sharedElement},ref:this.sharedContainer});}}]);return _SharedTransition;}(Extensible(PureComponent));Object.defineProperty(_SharedTransition,'name',{value:'SharedTransition'});export var SharedTransition=middleware(_SharedTransition,\"Component/SharedTransition/Component\");export default SharedTransition;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/SharedTransition/SharedTransition.component.js"],"names":["createRef","PureComponent","SHARED_ELEMENT_TRANSITION","SharedTransition","sharedContainer","animationSpeed","setDestinationTransform","setTransform","bind","setStartingTransform","cleanUpTransition","wrapper","current","props","range","document","createRange","selectNodeContents","deleteContents","transitionInAction","updateSharedElement","key","state","width","height","left","top","style","cssText","sharedElementDestination","sharedElement","appendChild","setTimeout","isVisible","Object","defineProperty","_SharedTransition","value"],"mappings":"qtBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAGA,OAASA,SAAT,CAAoBC,aAApB,KAAyC,OAAzC,CAEA,OAASC,yBAAT,iCAEA,iCAEA,sD,wEACA,UAAaC,CAAAA,iBAAb,yWAqBIC,eArBJ,cAqBsBJ,SAAS,EArB/B,OAuBIK,cAvBJ,CAuBqBH,yBAvBrB,OAyBII,uBAzBJ,CAyB8B,MAAKC,YAAL,CAAkBC,IAAlB,+BAA6B,qBAA7B,CAzB9B,OA2BIC,oBA3BJ,CA2B2B,MAAKF,YAAL,CAAkBC,IAAlB,+BAA6B,kBAA7B,CA3B3B,OAyDIE,iBAzDJ,CAyDwB,UAAM,IACLC,CAAAA,OADK,CACO,MAAKP,eADZ,CACdQ,OADc,IAEdF,CAAAA,iBAFc,CAEQ,MAAKG,KAFb,CAEdH,iBAFc,CAItB,GAAMI,CAAAA,KAAK,CAAGC,QAAQ,CAACC,WAAT,EAAd,CACAF,KAAK,CAACG,kBAAN,CAAyBN,OAAzB,EACAG,KAAK,CAACI,cAAN,GAEA,MAAKC,kBAAL,CAA0B,KAA1B,CACAT,iBAAiB,GACpB,CAnEL,+EA6BI,6BAAqB,CACjB,GAAI,KAAKS,kBAAT,CAA6B,CACzB,OACH,CACD,KAAKC,mBAAL,GACH,CAlCL,4BAoCI,sBAAaC,GAAb,CAAkB,2BAUV,KAAKR,KAVK,CAEVS,KAFU,CAGLD,GAHK,EAIFE,KAJE,uBAIFA,KAJE,CAKFC,MALE,uBAKFA,MALE,CAMFC,IANE,uBAMFA,IANE,CAOFC,GAPE,uBAOFA,GAPE,CAYd,KAAKtB,eAAL,CAAqBQ,OAArB,CAA6Be,KAA7B,CAAmCC,OAAnC,iDAC8BL,KAD9B,sDAE+BC,MAF/B,mDAG4BE,GAH5B,oDAI6BD,IAJ7B,+DAKwC,KAAKpB,cAL7C,kBAOH,CAvDL,mCAqEI,8BAAsB,uBAMd,KAAKQ,KANS,CAEdS,KAFc,CAGVO,wBAHU,mBAGVA,wBAHU,CAIVC,aAJU,mBAIVA,aAJU,IAQDnB,CAAAA,OARC,CAQW,KAAKP,eARhB,CAQVQ,OARU,CAUlB,GACI,CAACkB,aAAD,EACG,CAACD,wBADJ,EAEG,CAAClB,OAHR,CAIE,CACE;AACA,OACH,CAED,KAAKQ,kBAAL,CAA0B,IAA1B,CACA,KAAKV,oBAAL,GACAE,OAAO,CAACoB,WAAR,CAAoBD,aAApB,EACAE,UAAU,CAAC,KAAK1B,uBAAN,CAA+B,CAA/B,CAAV,CACA0B,UAAU,CAAC,KAAKtB,iBAAN,CAAyB,KAAKL,cAA9B,CAAV,CACH,CA7FL,sBA+FI,iBAAS,IACYyB,CAAAA,aADZ,CACgC,KAAKjB,KADrC,CACGS,KADH,CACYQ,aADZ,CAGL,0CAEM,KAAK,CAAC,kBAFZ,CAGM,IAAI,CAAG,CAAEG,SAAS,CAAE,CAAC,CAACH,aAAf,CAHb,CAIM,GAAG,CAAG,KAAK1B,eAJjB,GAOH,CAzGL,0DAnBA8B,MAAM,CAACC,cAAP,CAAsBC,iBAAtB,CAAyC,MAAzC,CAAiD,CAAEC,KAAK,CAAE,kBAAT,CAAjD,E,iGA+HA,cAAelC,CAAAA,gBAAf","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { createRef, PureComponent } from 'react';\n\nimport { SHARED_ELEMENT_TRANSITION } from './SharedTransition.config';\n\nimport './SharedTransition.style';\n\n/** @namespace Component/SharedTransition/Component */\nexport class SharedTransition extends PureComponent {\n    static propTypes = {\n        state: PropTypes.shape({\n            startingPosition: PropTypes.shape({\n                width: PropTypes.number,\n                height: PropTypes.number,\n                left: PropTypes.number,\n                top: PropTypes.number\n            }),\n            destinationPosition: PropTypes.shape({\n                width: PropTypes.number,\n                height: PropTypes.number,\n                left: PropTypes.number,\n                top: PropTypes.number\n            }),\n            sharedElementDestination: PropTypes.object,\n            sharedElement: PropTypes.object\n        }).isRequired,\n        cleanUpTransition: PropTypes.func.isRequired\n    };\n\n    sharedContainer = createRef();\n\n    animationSpeed = SHARED_ELEMENT_TRANSITION;\n\n    setDestinationTransform = this.setTransform.bind(this, 'destinationPosition');\n\n    setStartingTransform = this.setTransform.bind(this, 'startingPosition');\n\n    componentDidUpdate() {\n        if (this.transitionInAction) {\n            return;\n        }\n        this.updateSharedElement();\n    }\n\n    setTransform(key) {\n        const {\n            state: {\n                [key]: {\n                    width,\n                    height,\n                    left,\n                    top\n                }\n            }\n        } = this.props;\n\n        this.sharedContainer.current.style.cssText = `\n            --shared-element-width: ${width}px;\n            --shared-element-height: ${height}px;\n            --shared-element-top: ${top}px;\n            --shared-element-left: ${left}px;\n            --shared-element-animation-speed: ${this.animationSpeed}ms;\n        `;\n    }\n\n    cleanUpTransition = () => {\n        const { current: wrapper } = this.sharedContainer;\n        const { cleanUpTransition } = this.props;\n\n        const range = document.createRange();\n        range.selectNodeContents(wrapper);\n        range.deleteContents();\n\n        this.transitionInAction = false;\n        cleanUpTransition();\n    };\n\n    updateSharedElement() {\n        const {\n            state: {\n                sharedElementDestination,\n                sharedElement\n            }\n        } = this.props;\n\n        const { current: wrapper } = this.sharedContainer;\n\n        if (\n            !sharedElement\n            || !sharedElementDestination\n            || !wrapper\n        ) {\n            // this.cleanUpTransition();\n            return;\n        }\n\n        this.transitionInAction = true;\n        this.setStartingTransform();\n        wrapper.appendChild(sharedElement);\n        setTimeout(this.setDestinationTransform, 0);\n        setTimeout(this.cleanUpTransition, this.animationSpeed);\n    }\n\n    render() {\n        const { state: { sharedElement } } = this.props;\n\n        return (\n            <div\n              block=\"SharedTransition\"\n              mods={ { isVisible: !!sharedElement } }\n              ref={ this.sharedContainer }\n            />\n        );\n    }\n}\n\nexport default SharedTransition;\n"]},"metadata":{},"sourceType":"module"}