{"ast":null,"code":"import _objectSpread from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _get from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";import _getPrototypeOf from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/* eslint-disable react/no-unused-prop-types */ /**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import PropTypes from'prop-types';import{createPortal}from'react-dom';import ClickOutside from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ClickOutside\";import Overlay from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/Overlay/Overlay.component\";import{ESCAPE_KEY}from\"./Popup.config\";import\"./Popup.style\";/** @namespace Component/Popup/Component */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _Popup=/*#__PURE__*/function(_Extensible){_inherits(_Popup,_Extensible);var _super=_createSuper(_Popup);function _Popup(){var _this;_classCallCheck(this,_Popup);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.hidePopUp=function(){var _this$props=_this.props,hideActiveOverlay=_this$props.hideActiveOverlay,goToPreviousNavigationState=_this$props.goToPreviousNavigationState,onClose=_this$props.onClose;var isVisible=_this.getIsVisible();if(isVisible){_this.unfreezeScroll();hideActiveOverlay();goToPreviousNavigationState();onClose();}};_this.handleClickOutside=function(){var clickOutside=_this.props.clickOutside;if(!clickOutside){return;}_this.hidePopUp();};_this.handleKeyDown=function(e){switch(e.keyCode){case ESCAPE_KEY:_this.hidePopUp();break;default:break;}};return _this;}_createClass(_Popup,[{key:\"componentDidMount\",value:function componentDidMount(){document.addEventListener('keydown',this.handleKeyDown);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var _this$props2=this.props,shouldPopupClose=_this$props2.shouldPopupClose,resetHideActivePopup=_this$props2.resetHideActivePopup;var prevShouldPopupClose=prevProps.shouldPopupClose;if(shouldPopupClose&&shouldPopupClose!==prevShouldPopupClose){this.hidePopUp();resetHideActivePopup();}_get(_getPrototypeOf(_Popup.prototype),\"componentDidUpdate\",this).call(this,prevProps);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){document.removeEventListener('keydown',this.handleKeyDown);}},{key:\"onVisible\",value:function onVisible(){var onVisible=this.props.onVisible;this.freezeScroll();this.overlayRef.current.focus();window.addEventListener('popstate',this.hidePopUp);window.history.pushState({popupOpen:true},'',location.pathname);onVisible();}},{key:\"onHide\",value:function onHide(){var onHide=this.props.onHide;window.removeEventListener('popstate',this.hidePopUp);this.unfreezeScroll();onHide();}},{key:\"renderTitle\",value:function renderTitle(){var title=this.props.title;if(!title){return null;}return/*#__PURE__*/_checkBEM(React,\"h3\",{block:\"Popup\",elem:\"Heading\"},title);}},{key:\"renderCloseButton\",value:function renderCloseButton(){return/*#__PURE__*/_checkBEM(React,\"button\",{block:\"Popup\",elem:\"CloseBtn\",\"aria-label\":__('Close'),onClick:this.hidePopUp});}},{key:\"renderContent\",value:function renderContent(){var _this$props3=this.props,children=_this$props3.children,contentMix=_this$props3.contentMix;var isVisible=this.getIsVisible();if(!isVisible){return null;}return/*#__PURE__*/_checkBEM(React,ClickOutside,{onClick:this.handleClickOutside},/*#__PURE__*/_checkBEM(React,\"div\",{block:\"Popup\",elem:\"Content\",mix:contentMix},/*#__PURE__*/_checkBEM(React,\"header\",{block:\"Popup\",elem:\"Header\"},this.renderTitle(),this.renderCloseButton()),children));}},{key:\"render\",value:function render(){var _this$props4=this.props,mix=_this$props4.mix,areOtherOverlaysOpen=_this$props4.areOtherOverlaysOpen;var isVisible=this.getIsVisible();return/*#__PURE__*/createPortal(/*#__PURE__*/_checkBEM(React,\"div\",{ref:this.overlayRef,block:\"Popup\",mods:{isVisible:isVisible,isInstant:areOtherOverlaysOpen},mix:_objectSpread(_objectSpread({},mix),{},{mods:_objectSpread(_objectSpread({},mix.mods),{},{isVisible:isVisible})})},this.renderContent()),document.body);}}]);return _Popup;}(Extensible(Overlay));_Popup.propTypes=_objectSpread(_objectSpread({},Overlay.propTypes),{},{clickOutside:PropTypes.bool,title:PropTypes.string});_Popup.defaultProps=_objectSpread(_objectSpread({},Overlay.defaultProps),{},{clickOutside:true,title:''});Object.defineProperty(_Popup,'name',{value:'Popup'});export var Popup=middleware(_Popup,\"Component/Popup/Component\");export default Popup;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/Popup/Popup.component.js"],"names":["PropTypes","createPortal","ClickOutside","Overlay","ESCAPE_KEY","Popup","hidePopUp","props","hideActiveOverlay","goToPreviousNavigationState","onClose","isVisible","getIsVisible","unfreezeScroll","handleClickOutside","clickOutside","handleKeyDown","e","keyCode","document","addEventListener","prevProps","shouldPopupClose","resetHideActivePopup","prevShouldPopupClose","removeEventListener","onVisible","freezeScroll","overlayRef","current","focus","window","history","pushState","popupOpen","location","pathname","onHide","title","__","children","contentMix","renderTitle","renderCloseButton","mix","areOtherOverlaysOpen","isInstant","mods","renderContent","body","propTypes","bool","string","defaultProps","Object","defineProperty","_Popup","value"],"mappings":"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","sourcesContent":["/* eslint-disable react/no-unused-prop-types */\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { createPortal } from 'react-dom';\n\nimport ClickOutside from 'Component/ClickOutside';\nimport Overlay from 'Component/Overlay/Overlay.component';\n\nimport { ESCAPE_KEY } from './Popup.config';\n\nimport './Popup.style';\n\n/** @namespace Component/Popup/Component */\nexport class Popup extends Overlay {\n    static propTypes = {\n        ...Overlay.propTypes,\n        clickOutside: PropTypes.bool,\n        title: PropTypes.string\n    };\n\n    static defaultProps = {\n        ...Overlay.defaultProps,\n        clickOutside: true,\n        title: ''\n    };\n\n    componentDidMount() {\n        document.addEventListener('keydown', this.handleKeyDown);\n    }\n\n    componentDidUpdate(prevProps) {\n        const { shouldPopupClose, resetHideActivePopup } = this.props;\n        const { shouldPopupClose: prevShouldPopupClose } = prevProps;\n\n        if (shouldPopupClose && shouldPopupClose !== prevShouldPopupClose) {\n            this.hidePopUp();\n            resetHideActivePopup();\n        }\n\n        super.componentDidUpdate(prevProps);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.handleKeyDown);\n    }\n\n    onVisible() {\n        const { onVisible } = this.props;\n\n        this.freezeScroll();\n        this.overlayRef.current.focus();\n\n        window.addEventListener('popstate', this.hidePopUp);\n\n        window.history.pushState(\n            {\n                popupOpen: true\n            },\n            '',\n            location.pathname\n        );\n\n        onVisible();\n    }\n\n    onHide() {\n        const { onHide } = this.props;\n        window.removeEventListener('popstate', this.hidePopUp);\n\n        this.unfreezeScroll();\n\n        onHide();\n    }\n\n    hidePopUp = () => {\n        const { hideActiveOverlay, goToPreviousNavigationState, onClose } = this.props;\n        const isVisible = this.getIsVisible();\n        if (isVisible) {\n            this.unfreezeScroll();\n            hideActiveOverlay();\n            goToPreviousNavigationState();\n            onClose();\n        }\n    };\n\n    // Same with click outside\n    handleClickOutside = () => {\n        const { clickOutside } = this.props;\n        if (!clickOutside) {\n            return;\n        }\n        this.hidePopUp();\n    };\n\n    handleKeyDown = (e) => {\n        switch (e.keyCode) {\n        case ESCAPE_KEY:\n            this.hidePopUp();\n            break;\n        default:\n            break;\n        }\n    };\n\n    renderTitle() {\n        const { title } = this.props;\n        if (!title) {\n            return null;\n        }\n\n        return (\n            <h3 block=\"Popup\" elem=\"Heading\">\n                { title }\n            </h3>\n        );\n    }\n\n    renderCloseButton() {\n        return (\n            <button\n              block=\"Popup\"\n              elem=\"CloseBtn\"\n              aria-label={ __('Close') }\n              onClick={ this.hidePopUp }\n            />\n        );\n    }\n\n    renderContent() {\n        const { children, contentMix } = this.props;\n        const isVisible = this.getIsVisible();\n\n        if (!isVisible) {\n            return null;\n        }\n\n        return (\n            <ClickOutside onClick={ this.handleClickOutside }>\n                <div block=\"Popup\" elem=\"Content\" mix={ contentMix }>\n                    <header block=\"Popup\" elem=\"Header\">\n                        { this.renderTitle() }\n                        { this.renderCloseButton() }\n                    </header>\n                    { children }\n                </div>\n            </ClickOutside>\n        );\n    }\n\n    render() {\n        const { mix, areOtherOverlaysOpen } = this.props;\n        const isVisible = this.getIsVisible();\n\n        return createPortal(\n            <div\n              ref={ this.overlayRef }\n              block=\"Popup\"\n              mods={ { isVisible, isInstant: areOtherOverlaysOpen } }\n              mix={ { ...mix, mods: { ...mix.mods, isVisible } } }\n            >\n                { this.renderContent() }\n            </div>,\n            document.body\n        );\n    }\n}\n\nexport default Popup;\n"]},"metadata":{},"sourceType":"module"}