{"ast":null,"code":"import _objectSpread from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _get from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";import _getPrototypeOf from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import UrlRewritesQuery from\"/home/marketihor/scandipwa/packages/scandipwa/src/query/UrlRewrites.query\";import{showNotification}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Notification/Notification.action\";import{setIsUrlRewritesLoading,updateUrlRewrite}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/UrlRewrites/UrlRewrites.action\";import{QueryDispatcher}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Request\";/**\n * Url Rewrite Dispathcer\n * @class UrlRewritesDispatcher\n * @extends RequestDispatcher\n * @namespace Store/UrlRewrites/Dispatcher\n */export var _UrlRewritesDispatcher=/*#__PURE__*/function(_Extensible){_inherits(_UrlRewritesDispatcher,_Extensible);var _super=_createSuper(_UrlRewritesDispatcher);function _UrlRewritesDispatcher(){_classCallCheck(this,_UrlRewritesDispatcher);return _super.apply(this,arguments);}_createClass(_UrlRewritesDispatcher,[{key:\"__construct\",value:function __construct(){_get(_getPrototypeOf(_UrlRewritesDispatcher.prototype),\"__construct\",this).call(this,'UrlRewrites');}},{key:\"onSuccess\",value:function onSuccess(_ref,dispatch,_ref2){var urlResolver=_ref.urlResolver;var urlParam=_ref2.urlParam;dispatch(updateUrlRewrite(urlResolver||{notFound:true},urlParam));}},{key:\"onError\",value:function onError(error,dispatch){dispatch(setIsUrlRewritesLoading(false));dispatch(showNotification('error',__('Error fetching URL-rewrites!'),error));}/**\n     * Prepare UrlRewrite requests\n     * @param {Object} options A object containing different aspects of query, each item can be omitted\n     * @return {Query} UrlRewrite query\n     * @memberof UrlRewritesDispatcher\n     */},{key:\"prepareRequest\",value:function prepareRequest(options,dispatch){dispatch(setIsUrlRewritesLoading(true));return[UrlRewritesQuery.getQuery(this.processUrlOptions(options))];}},{key:\"processUrlOptions\",value:function processUrlOptions(options){var urlParam=options.urlParam;// FAILSAFE: Trim index.php if someone forgot to set \"Use Web Server Rewrites\" to \"Yes\"\nvar trimmedParam=urlParam.replace('index.php/','');return _objectSpread(_objectSpread({},options),{},{urlParam:trimmedParam.replace(new RegExp(window.storeRegexText),'')});}}]);return _UrlRewritesDispatcher;}(Extensible(QueryDispatcher));Object.defineProperty(_UrlRewritesDispatcher,'name',{value:'UrlRewritesDispatcher'});export var UrlRewritesDispatcher=middleware(_UrlRewritesDispatcher,\"Store/UrlRewrites/Dispatcher\");export default new UrlRewritesDispatcher();","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/store/UrlRewrites/UrlRewrites.dispatcher.js"],"names":["UrlRewritesQuery","showNotification","setIsUrlRewritesLoading","updateUrlRewrite","QueryDispatcher","UrlRewritesDispatcher","dispatch","urlResolver","urlParam","notFound","error","__","options","getQuery","processUrlOptions","trimmedParam","replace","RegExp","window","storeRegexText","Object","defineProperty","_UrlRewritesDispatcher","value"],"mappings":"o9BAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAEA,MAAOA,CAAAA,gBAAP,iFACA,OAASC,gBAAT,gGACA,OAASC,uBAAT,CAAkCC,gBAAlC,8FACA,OAASC,eAAT,sEAEA;AACA;AACA;AACA;AACA;AACA,GACA,UAAaC,CAAAA,sBAAb,oTACI,sBAAc,CACV,qFAAkB,aAAlB,EACH,CAHL,yBAKI,wBAA2BC,QAA3B,OAAmD,IAAvCC,CAAAA,WAAuC,MAAvCA,WAAuC,IAAZC,CAAAA,QAAY,OAAZA,QAAY,CAC/CF,QAAQ,CAACH,gBAAgB,CAACI,WAAW,EAAI,CAAEE,QAAQ,CAAE,IAAZ,CAAhB,CAAoCD,QAApC,CAAjB,CAAR,CACH,CAPL,uBASI,iBAAQE,KAAR,CAAeJ,QAAf,CAAyB,CACrBA,QAAQ,CAACJ,uBAAuB,CAAC,KAAD,CAAxB,CAAR,CACAI,QAAQ,CAACL,gBAAgB,CAAC,OAAD,CAAUU,EAAE,CAAC,8BAAD,CAAZ,CAA8CD,KAA9C,CAAjB,CAAR,CACH,CAED;AACJ;AACA;AACA;AACA;AACA,OAnBA,8BAoBI,wBAAeE,OAAf,CAAwBN,QAAxB,CAAkC,CAC9BA,QAAQ,CAACJ,uBAAuB,CAAC,IAAD,CAAxB,CAAR,CAEA,MAAO,CACHF,gBAAgB,CAACa,QAAjB,CAA0B,KAAKC,iBAAL,CAAuBF,OAAvB,CAA1B,CADG,CAAP,CAGH,CA1BL,iCA4BI,2BAAkBA,OAAlB,CAA2B,IACfJ,CAAAA,QADe,CACFI,OADE,CACfJ,QADe,CAGvB;AACA,GAAMO,CAAAA,YAAY,CAAGP,QAAQ,CAACQ,OAAT,CAAiB,YAAjB,CAA+B,EAA/B,CAArB,CAEA,sCACOJ,OADP,MAEIJ,QAAQ,CAAEO,YAAY,CAACC,OAAb,CAAqB,GAAIC,CAAAA,MAAJ,CAAWC,MAAM,CAACC,cAAlB,CAArB,CAAwD,EAAxD,CAFd,GAIH,CAtCL,iEAtBAC,MAAM,CAACC,cAAP,CAAsBC,sBAAtB,CAA8C,MAA9C,CAAsD,CAAEC,KAAK,CAAE,uBAAT,CAAtD,E,mGA+DA,cAAe,IAAIlB,CAAAA,qBAAJ,EAAf","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport UrlRewritesQuery from 'Query/UrlRewrites.query';\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport { setIsUrlRewritesLoading, updateUrlRewrite } from 'Store/UrlRewrites/UrlRewrites.action';\nimport { QueryDispatcher } from 'Util/Request';\n\n/**\n * Url Rewrite Dispathcer\n * @class UrlRewritesDispatcher\n * @extends RequestDispatcher\n * @namespace Store/UrlRewrites/Dispatcher\n */\nexport class UrlRewritesDispatcher extends QueryDispatcher {\n    __construct() {\n        super.__construct('UrlRewrites');\n    }\n\n    onSuccess({ urlResolver }, dispatch, { urlParam }) {\n        dispatch(updateUrlRewrite(urlResolver || { notFound: true }, urlParam));\n    }\n\n    onError(error, dispatch) {\n        dispatch(setIsUrlRewritesLoading(false));\n        dispatch(showNotification('error', __('Error fetching URL-rewrites!'), error));\n    }\n\n    /**\n     * Prepare UrlRewrite requests\n     * @param {Object} options A object containing different aspects of query, each item can be omitted\n     * @return {Query} UrlRewrite query\n     * @memberof UrlRewritesDispatcher\n     */\n    prepareRequest(options, dispatch) {\n        dispatch(setIsUrlRewritesLoading(true));\n\n        return [\n            UrlRewritesQuery.getQuery(this.processUrlOptions(options))\n        ];\n    }\n\n    processUrlOptions(options) {\n        const { urlParam } = options;\n\n        // FAILSAFE: Trim index.php if someone forgot to set \"Use Web Server Rewrites\" to \"Yes\"\n        const trimmedParam = urlParam.replace('index.php/', '');\n\n        return {\n            ...options,\n            urlParam: trimmedParam.replace(new RegExp(window.storeRegexText), '')\n        };\n    }\n}\n\nexport default new UrlRewritesDispatcher();\n"]},"metadata":{},"sourceType":"module"}