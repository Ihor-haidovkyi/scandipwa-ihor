{"ast":null,"code":"import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import{connect}from'react-redux';import MyAccountQuery from\"/home/marketihor/scandipwa/packages/scandipwa/src/query/MyAccount.query\";import{goToPreviousNavigationState}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.action\";import{TOP_NAVIGATION_TYPE}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.reducer\";import{showNotification}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Notification/Notification.action\";import{hideActiveOverlay as _hideActiveOverlay}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Overlay/Overlay.action\";import{addressType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Account\";import{isSignedIn}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Auth\";import{fetchMutation,getErrorMessage}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Request\";import MyAccountAddressPopup from\"./MyAccountAddressPopup.component\";import{ADDRESS_POPUP_ID}from\"./MyAccountAddressPopup.config\";export var MyAccountDispatcher=import(/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\"/home/marketihor/scandipwa/packages/scandipwa/src/store/MyAccount/MyAccount.dispatcher\");/** @namespace Component/MyAccountAddressPopup/Container/mapStateToProps */export var mapStateToProps=middleware(function(state){return{payload:state.PopupReducer.popupPayload[ADDRESS_POPUP_ID]||{}};},\"Component/MyAccountAddressPopup/Container/mapStateToProps\");/** @namespace Component/MyAccountAddressPopup/Container/mapDispatchToProps */export var mapDispatchToProps=middleware(function(dispatch){return{hideActiveOverlay:function hideActiveOverlay(){return dispatch(_hideActiveOverlay());},showErrorNotification:function showErrorNotification(error){return dispatch(showNotification('error',getErrorMessage(error)));},showSuccessNotification:function showSuccessNotification(message){return dispatch(showNotification('success',message));},updateCustomerDetails:function updateCustomerDetails(){return MyAccountDispatcher.then(function(_ref){var dispatcher=_ref.default;return dispatcher.requestCustomerData(dispatch);});},goToPreviousHeaderState:function goToPreviousHeaderState(){return dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE));}};},\"Component/MyAccountAddressPopup/Container/mapDispatchToProps\");/** @namespace Component/MyAccountAddressPopup/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _MyAccountAddressPopupContainer=/*#__PURE__*/function(_Extensible){_inherits(_MyAccountAddressPopupContainer,_Extensible);var _super=_createSuper(_MyAccountAddressPopupContainer);function _MyAccountAddressPopupContainer(){var _this;_classCallCheck(this,_MyAccountAddressPopupContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={isLoading:false};_this.containerFunctions={handleAddress:_this.handleAddress.bind(_assertThisInitialized(_this)),handleDeleteAddress:_this.handleDeleteAddress.bind(_assertThisInitialized(_this))};_this.handleAfterAction=function(){var _this$props=_this.props,hideActiveOverlay=_this$props.hideActiveOverlay,updateCustomerDetails=_this$props.updateCustomerDetails,showErrorNotification=_this$props.showErrorNotification,goToPreviousHeaderState=_this$props.goToPreviousHeaderState;updateCustomerDetails().then(/** @namespace Component/MyAccountAddressPopup/Container/updateCustomerDetailsThen */middleware(function(){_this.setState({isLoading:false},function(){hideActiveOverlay();goToPreviousHeaderState();});},\"Component/MyAccountAddressPopup/Container/updateCustomerDetailsThen\"),showErrorNotification);};_this.handleError=function(error){var showErrorNotification=_this.props.showErrorNotification;showErrorNotification(error);_this.setState({isLoading:false});};return _this;}_createClass(_MyAccountAddressPopupContainer,[{key:\"handleAddress\",value:function handleAddress(address){var id=this.props.payload.address.id;this.setState({isLoading:true});if(id){return this.handleEditAddress(address);}return this.handleCreateAddress(address);}},{key:\"handleEditAddress\",value:function handleEditAddress(address){var id=this.props.payload.address.id;var query=MyAccountQuery.getUpdateAddressMutation(id,address);if(!isSignedIn()){return;}fetchMutation(query).then(this.handleAfterAction,this.handleError);}},{key:\"handleDeleteAddress\",value:function handleDeleteAddress(){var id=this.props.payload.address.id;if(!isSignedIn()){return;}this.setState({isLoading:true});var query=MyAccountQuery.getDeleteAddressMutation(id);fetchMutation(query).then(this.handleAfterAction,this.handleError);}},{key:\"handleCreateAddress\",value:function handleCreateAddress(address){if(!isSignedIn()){return;}var query=MyAccountQuery.getCreateAddressMutation(address);fetchMutation(query).then(this.handleAfterAction,this.handleError);}},{key:\"render\",value:function render(){return/*#__PURE__*/_checkBEM(React,MyAccountAddressPopup,Object.assign({},this.props,this.state,this.containerFunctions));}}]);return _MyAccountAddressPopupContainer;}(Extensible(PureComponent));Object.defineProperty(_MyAccountAddressPopupContainer,'name',{value:'MyAccountAddressPopupContainer'});export var MyAccountAddressPopupContainer=middleware(_MyAccountAddressPopupContainer,\"Component/MyAccountAddressPopup/Container\");export default connect(mapStateToProps,mapDispatchToProps)(MyAccountAddressPopupContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/MyAccountAddressPopup/MyAccountAddressPopup.container.js"],"names":["PureComponent","connect","MyAccountQuery","goToPreviousNavigationState","TOP_NAVIGATION_TYPE","showNotification","hideActiveOverlay","addressType","isSignedIn","fetchMutation","getErrorMessage","MyAccountAddressPopup","ADDRESS_POPUP_ID","MyAccountDispatcher","mapStateToProps","state","payload","PopupReducer","popupPayload","mapDispatchToProps","dispatch","showErrorNotification","error","showSuccessNotification","message","updateCustomerDetails","then","dispatcher","default","requestCustomerData","goToPreviousHeaderState","MyAccountAddressPopupContainer","isLoading","containerFunctions","handleAddress","bind","handleDeleteAddress","handleAfterAction","props","setState","handleError","address","id","handleEditAddress","handleCreateAddress","query","getUpdateAddressMutation","getDeleteAddressMutation","getCreateAddressMutation","Object","defineProperty","_MyAccountAddressPopupContainer","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport MyAccountQuery from 'Query/MyAccount.query';\nimport { goToPreviousNavigationState } from 'Store/Navigation/Navigation.action';\nimport { TOP_NAVIGATION_TYPE } from 'Store/Navigation/Navigation.reducer';\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport { hideActiveOverlay } from 'Store/Overlay/Overlay.action';\nimport { addressType } from 'Type/Account';\nimport { isSignedIn } from 'Util/Auth';\nimport { fetchMutation, getErrorMessage } from 'Util/Request';\n\nimport MyAccountAddressPopup from './MyAccountAddressPopup.component';\nimport { ADDRESS_POPUP_ID } from './MyAccountAddressPopup.config';\n\nexport const MyAccountDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/MyAccount/MyAccount.dispatcher'\n);\n\n/** @namespace Component/MyAccountAddressPopup/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    payload: state.PopupReducer.popupPayload[ADDRESS_POPUP_ID] || {}\n});\n\n/** @namespace Component/MyAccountAddressPopup/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    hideActiveOverlay: () => dispatch(hideActiveOverlay()),\n    showErrorNotification: (error) => dispatch(showNotification('error', getErrorMessage(error))),\n    showSuccessNotification: (message) => dispatch(showNotification('success', message)),\n    updateCustomerDetails: () => MyAccountDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.requestCustomerData(dispatch)\n    ),\n    goToPreviousHeaderState: () => dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE))\n});\n\n/** @namespace Component/MyAccountAddressPopup/Container */\nexport class MyAccountAddressPopupContainer extends PureComponent {\n    static propTypes = {\n        showErrorNotification: PropTypes.func.isRequired,\n        updateCustomerDetails: PropTypes.func.isRequired,\n        hideActiveOverlay: PropTypes.func.isRequired,\n        goToPreviousHeaderState: PropTypes.func.isRequired,\n        payload: PropTypes.shape({\n            address: addressType\n        }).isRequired\n    };\n\n    state = {\n        isLoading: false\n    };\n\n    containerFunctions = {\n        handleAddress: this.handleAddress.bind(this),\n        handleDeleteAddress: this.handleDeleteAddress.bind(this)\n    };\n\n    handleAfterAction = () => {\n        const {\n            hideActiveOverlay,\n            updateCustomerDetails,\n            showErrorNotification,\n            goToPreviousHeaderState\n        } = this.props;\n\n        updateCustomerDetails().then(\n            /** @namespace Component/MyAccountAddressPopup/Container/updateCustomerDetailsThen */\n            () => {\n                this.setState({ isLoading: false }, () => {\n                    hideActiveOverlay();\n                    goToPreviousHeaderState();\n                });\n            }, showErrorNotification\n        );\n    };\n\n    handleError = (error) => {\n        const { showErrorNotification } = this.props;\n        showErrorNotification(error);\n        this.setState({ isLoading: false });\n    };\n\n    handleAddress(address) {\n        const { payload: { address: { id } } } = this.props;\n        this.setState({ isLoading: true });\n        if (id) {\n            return this.handleEditAddress(address);\n        }\n\n        return this.handleCreateAddress(address);\n    }\n\n    handleEditAddress(address) {\n        const { payload: { address: { id } } } = this.props;\n        const query = MyAccountQuery.getUpdateAddressMutation(id, address);\n\n        if (!isSignedIn()) {\n            return;\n        }\n\n        fetchMutation(query).then(this.handleAfterAction, this.handleError);\n    }\n\n    handleDeleteAddress() {\n        const { payload: { address: { id } } } = this.props;\n\n        if (!isSignedIn()) {\n            return;\n        }\n\n        this.setState({ isLoading: true });\n        const query = MyAccountQuery.getDeleteAddressMutation(id);\n        fetchMutation(query).then(this.handleAfterAction, this.handleError);\n    }\n\n    handleCreateAddress(address) {\n        if (!isSignedIn()) {\n            return;\n        }\n\n        const query = MyAccountQuery.getCreateAddressMutation(address);\n        fetchMutation(query).then(this.handleAfterAction, this.handleError);\n    }\n\n    render() {\n        return (\n            <MyAccountAddressPopup\n              { ...this.props }\n              { ...this.state }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MyAccountAddressPopupContainer);\n"]},"metadata":{},"sourceType":"module"}