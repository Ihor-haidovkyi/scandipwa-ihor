{"ast":null,"code":"import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _get from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";import _getPrototypeOf from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import PropTypes from'prop-types';import{connect}from'react-redux';import{withRouter}from'react-router';import{CUSTOMER_ACCOUNT_OVERLAY_KEY}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/MyAccountOverlay/MyAccountOverlay.config\";import{DEFAULT_STATE_NAME}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/NavigationAbstract/NavigationAbstract.config\";import{NavigationAbstractContainer}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/NavigationAbstract/NavigationAbstract.container\";import{SHARE_WISHLIST_POPUP_ID}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ShareWishlistPopup/ShareWishlistPopup.config\";import{CHECKOUT_URL}from\"/home/marketihor/scandipwa/packages/scandipwa/src/route/Checkout/Checkout.config\";import{changeNavigationState,goToPreviousNavigationState as _goToPreviousNavigationState}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.action\";import{TOP_NAVIGATION_TYPE}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.reducer\";import{hideActiveOverlay as _hideActiveOverlay,toggleOverlayByKey}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Overlay/Overlay.action\";import{showPopup as _showPopup}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Popup/Popup.action\";import{DeviceType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Device\";import{isSignedIn}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Auth\";import history from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/History\";import{appendWithStoreCode,setQueryParams}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Url\";import Header from\"./Header.component\";import{CART,CART_OVERLAY,CATEGORY,CHECKOUT,CHECKOUT_ACCOUNT,CHECKOUT_SUCCESS,CMS_PAGE,CONTACT_US,CUSTOMER_ACCOUNT,CUSTOMER_ACCOUNT_PAGE,CUSTOMER_SUB_ACCOUNT,MENU,PDP,SEARCH}from\"./Header.config\";/** @namespace Component/Header/Container/mapStateToProps */export var mapStateToProps=middleware(function(state){return{navigationState:state.NavigationReducer[TOP_NAVIGATION_TYPE].navigationState,cartTotals:state.CartReducer.cartTotals,header_logo_src:state.ConfigReducer.header_logo_src,isOffline:state.OfflineReducer.isOffline,logo_alt:state.ConfigReducer.logo_alt,logo_height:state.ConfigReducer.logo_height,logo_width:state.ConfigReducer.logo_width,isLoading:state.ConfigReducer.isLoading,device:state.ConfigReducer.device,activeOverlay:state.OverlayReducer.activeOverlay,isWishlistLoading:state.WishlistReducer.isLoading};},\"Component/Header/Container/mapStateToProps\");/** @namespace Component/Header/Container/mapDispatchToProps */export var mapDispatchToProps=middleware(function(dispatch){return{showOverlay:function showOverlay(overlayKey){return dispatch(toggleOverlayByKey(overlayKey));},hideActiveOverlay:function hideActiveOverlay(){return dispatch(_hideActiveOverlay());},setNavigationState:function setNavigationState(stateName){return dispatch(changeNavigationState(TOP_NAVIGATION_TYPE,stateName));},showPopup:function showPopup(payload){return dispatch(_showPopup(SHARE_WISHLIST_POPUP_ID,payload));},goToPreviousNavigationState:function goToPreviousNavigationState(){return dispatch(_goToPreviousNavigationState(TOP_NAVIGATION_TYPE));}};},\"Component/Header/Container/mapDispatchToProps\");export var DEFAULT_HEADER_STATE={name:DEFAULT_STATE_NAME,isHiddenOnMobile:false};/** @namespace Component/Header/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _HeaderContainer=/*#__PURE__*/function(_Extensible){_inherits(_HeaderContainer,_Extensible);var _super=_createSuper(_HeaderContainer);function _HeaderContainer(){var _this;_classCallCheck(this,_HeaderContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.default_state=DEFAULT_HEADER_STATE;_this.routeMap={// eslint-disable-next-line max-len\n'/account/confirm':{name:CMS_PAGE,title:__('Confirm account'),onBackClick:function onBackClick(){return history.push(appendWithStoreCode('/'));}},'/category':{name:CATEGORY},'/checkout/success':{name:CHECKOUT_SUCCESS},'/checkout':{name:CHECKOUT,onBackClick:function onBackClick(){return history.push(appendWithStoreCode('/cart'));}},'/my-account':{name:CUSTOMER_ACCOUNT_PAGE,onBackClick:function onBackClick(){return history.push(appendWithStoreCode('/'));}},'/product':{name:PDP,onBackClick:function onBackClick(){return history.goBack();}},'/cart':{name:CART},'/menu':{name:MENU},'/page':{name:CMS_PAGE,onBackClick:function onBackClick(){return history.goBack();}},'/contact':{name:CONTACT_US,onBackClick:function onBackClick(){return history.goBack();}},'/':{name:DEFAULT_STATE_NAME,isHiddenOnMobile:true}};_this.containerFunctions={onBackButtonClick:_this.onBackButtonClick.bind(_assertThisInitialized(_this)),onCloseButtonClick:_this.onCloseButtonClick.bind(_assertThisInitialized(_this)),onSearchBarFocus:_this.onSearchBarFocus.bind(_assertThisInitialized(_this)),onClearSearchButtonClick:_this.onClearSearchButtonClick.bind(_assertThisInitialized(_this)),onMyAccountButtonClick:_this.onMyAccountButtonClick.bind(_assertThisInitialized(_this)),onSearchBarChange:_this.onSearchBarChange.bind(_assertThisInitialized(_this)),onClearButtonClick:_this.onClearButtonClick.bind(_assertThisInitialized(_this)),onEditButtonClick:_this.onEditButtonClick.bind(_assertThisInitialized(_this)),onMinicartButtonClick:_this.onMinicartButtonClick.bind(_assertThisInitialized(_this)),onOkButtonClick:_this.onOkButtonClick.bind(_assertThisInitialized(_this)),onCancelButtonClick:_this.onCancelButtonClick.bind(_assertThisInitialized(_this)),onSearchOutsideClick:_this.onSearchOutsideClick.bind(_assertThisInitialized(_this)),onMyAccountOutsideClick:_this.onMyAccountOutsideClick.bind(_assertThisInitialized(_this)),onMinicartOutsideClick:_this.onMinicartOutsideClick.bind(_assertThisInitialized(_this)),onSignIn:_this.onSignIn.bind(_assertThisInitialized(_this)),shareWishlist:_this.shareWishlist.bind(_assertThisInitialized(_this)),hideActiveOverlay:_this.props.hideActiveOverlay};_this.containerProps=function(){var _this$props=_this.props,activeOverlay=_this$props.activeOverlay,navigationState=_this$props.navigationState,cartTotals=_this$props.cartTotals,header_logo_src=_this$props.header_logo_src,logo_alt=_this$props.logo_alt,logo_height=_this$props.logo_height,logo_width=_this$props.logo_width,isLoading=_this$props.isLoading,device=_this$props.device,isWishlistLoading=_this$props.isWishlistLoading;var _this$state=_this.state,isClearEnabled=_this$state.isClearEnabled,searchCriteria=_this$state.searchCriteria,showMyAccountLogin=_this$state.showMyAccountLogin;var pathname=history.location.pathname;var isCheckout=pathname.includes(CHECKOUT_URL);return{activeOverlay:activeOverlay,navigationState:navigationState,cartTotals:cartTotals,header_logo_src:header_logo_src,logo_alt:logo_alt,logo_height:logo_height,logo_width:logo_width,isLoading:isLoading,isClearEnabled:isClearEnabled,searchCriteria:searchCriteria,isCheckout:isCheckout,showMyAccountLogin:showMyAccountLogin,device:device,isWishlistLoading:isWishlistLoading};};_this.closeOverlay=function(){var pathname=history.location.pathname;if(pathname.includes(CHECKOUT_URL)){_this.setState({showMyAccountLogin:false});}};return _this;}_createClass(_HeaderContainer,[{key:\"__construct\",value:function __construct(props){_get(_getPrototypeOf(_HeaderContainer.prototype),\"__construct\",this).call(this,props);this.state={prevPathname:'',searchCriteria:'',isClearEnabled:this.getIsClearEnabled(),showMyAccountLogin:false};}},{key:\"componentDidMount\",value:function componentDidMount(){this.handleHeaderVisibility();_get(_getPrototypeOf(_HeaderContainer.prototype),\"componentDidMount\",this).call(this);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){this.hideSearchOnStateChange(prevProps);this.handleHeaderVisibility();}},{key:\"shareWishlist\",value:function shareWishlist(){var showPopup=this.props.showPopup;showPopup({title:__('Share Wishlist')});}},{key:\"getNavigationState\",value:function getNavigationState(){var navigationState=this.props.navigationState;var _location=location,pathname=_location.pathname;var _ref=window.history||{},historyState=_ref.state;var _ref2=historyState||{},_ref2$state=_ref2.state,state=_ref2$state===void 0?{}:_ref2$state;// TODO: something here breaks /<STORE CODE> from being opened, and / when, the url-based stores are enabled.\nvar activeRoute=Object.keys(this.routeMap).find(function(route){return(route!=='/'||pathname===appendWithStoreCode('/')||pathname==='/')&&pathname.includes(route);});if(state.category||state.product||state.page||state.popupOpen){// keep state if it category is in state\nreturn navigationState;}return this.routeMap[activeRoute]||this.default_state;}},{key:\"hideSearchOnStateChange\",value:function hideSearchOnStateChange(prevProps){var prevName=prevProps.navigationState.name;var name=this.props.navigationState.name;if(prevName===SEARCH&&prevName!==name){this.hideSearchOverlay();}}},{key:\"hideSearchOverlay\",value:function hideSearchOverlay(){var _this$props2=this.props,hideActiveOverlay=_this$props2.hideActiveOverlay,activeOverlay=_this$props2.activeOverlay;this.setState({searchCriteria:''});document.activeElement.blur();if(activeOverlay===SEARCH){hideActiveOverlay();}}},{key:\"handleHeaderVisibility\",value:function handleHeaderVisibility(){var isHiddenOnMobile=this.props.navigationState.isHiddenOnMobile;if(isHiddenOnMobile){document.documentElement.classList.add('hiddenHeader');return;}document.documentElement.classList.remove('hiddenHeader');}},{key:\"handleMobileUrlChange\",value:function handleMobileUrlChange(history){var prevPathname=this.state.prevPathname;var pathname=history.pathname;var isClearEnabled=this.getIsClearEnabled();if(prevPathname===pathname){return{isClearEnabled:isClearEnabled};}return{isClearEnabled:isClearEnabled,showMyAccountLogin:false};}},{key:\"getIsClearEnabled\",value:function getIsClearEnabled(){var search=history.location.search;return new RegExp(['customFilters','priceMax','priceMin'].join('|')).test(search);}},{key:\"onBackButtonClick\",value:function onBackButtonClick(e){var onBackClick=this.props.navigationState.onBackClick;this.setState({searchCriteria:''});if(onBackClick){onBackClick(e);}}},{key:\"onCloseButtonClick\",value:function onCloseButtonClick(e){var _this$props3=this.props,hideActiveOverlay=_this$props3.hideActiveOverlay,goToPreviousNavigationState=_this$props3.goToPreviousNavigationState;var onCloseClick=this.props.navigationState.onCloseClick;this.setState({searchCriteria:''});if(onCloseClick){onCloseClick(e);}hideActiveOverlay();goToPreviousNavigationState();}},{key:\"onSearchOutsideClick\",value:function onSearchOutsideClick(){var _this$props4=this.props,goToPreviousNavigationState=_this$props4.goToPreviousNavigationState,name=_this$props4.navigationState.name,device=_this$props4.device;if(!device.isMobile&&name===SEARCH){this.hideSearchOverlay();goToPreviousNavigationState();}}},{key:\"onSearchBarFocus\",value:function onSearchBarFocus(){var _this$props5=this.props,setNavigationState=_this$props5.setNavigationState,goToPreviousNavigationState=_this$props5.goToPreviousNavigationState,showOverlay=_this$props5.showOverlay,name=_this$props5.navigationState.name,device=_this$props5.device;if(!device.isMobile&&name===SEARCH||device.isMobile&&name!==MENU){return;}showOverlay(SEARCH);setNavigationState({name:SEARCH,onBackClick:function onBackClick(){showOverlay(MENU);goToPreviousNavigationState();}});}},{key:\"onSearchBarChange\",value:function onSearchBarChange(_ref3){var searchCriteria=_ref3.target.value;this.setState({searchCriteria:searchCriteria});}},{key:\"onClearSearchButtonClick\",value:function onClearSearchButtonClick(){this.setState({searchCriteria:''});}},{key:\"onMyAccountButtonClick\",value:function onMyAccountButtonClick(){var _this2=this;var _this$props6=this.props,showOverlay=_this$props6.showOverlay,setNavigationState=_this$props6.setNavigationState;if(isSignedIn()){history.push({pathname:appendWithStoreCode('/my-account/dashboard')});return;}this.setState({showMyAccountLogin:true},function(){showOverlay(CUSTOMER_ACCOUNT_OVERLAY_KEY);setNavigationState({name:CHECKOUT_ACCOUNT,title:'Sign in',onCloseClick:_this2.closeOverlay});});}},{key:\"onMyAccountOutsideClick\",value:function onMyAccountOutsideClick(){var _this$props7=this.props,goToPreviousNavigationState=_this$props7.goToPreviousNavigationState,hideActiveOverlay=_this$props7.hideActiveOverlay,name=_this$props7.navigationState.name,device=_this$props7.device;if(device.isMobile||![CUSTOMER_ACCOUNT,CUSTOMER_SUB_ACCOUNT,CHECKOUT_ACCOUNT].includes(name)){return;}if(name===CUSTOMER_SUB_ACCOUNT){goToPreviousNavigationState();}this.goToDefaultHeaderState();hideActiveOverlay();}},{key:\"onSignIn\",value:function onSignIn(){var pathname=history.location.pathname;if(pathname.includes(CHECKOUT_URL)){this.setState({showMyAccountLogin:false});}}},{key:\"onClearButtonClick\",value:function onClearButtonClick(){var _this$props8=this.props,hideActiveOverlay=_this$props8.hideActiveOverlay,goToPreviousNavigationState=_this$props8.goToPreviousNavigationState;setQueryParams({customFilters:'',priceMax:'',priceMin:''},history.location,history);this.setState({isClearEnabled:false});hideActiveOverlay();goToPreviousNavigationState();}},{key:\"onMinicartButtonClick\",value:function onMinicartButtonClick(){var _this$props9=this.props,showOverlay=_this$props9.showOverlay,name=_this$props9.navigationState.name,device=_this$props9.device;if(name===CART_OVERLAY){return;}if(!device.isMobile){this.setState({shouldRenderCartOverlay:true});showOverlay(CART_OVERLAY);return;}history.push(appendWithStoreCode(\"/\".concat(CART)));}},{key:\"onMinicartOutsideClick\",value:function onMinicartOutsideClick(){var _this$props10=this.props,goToPreviousNavigationState=_this$props10.goToPreviousNavigationState,hideActiveOverlay=_this$props10.hideActiveOverlay,name=_this$props10.navigationState.name,device=_this$props10.device;if(device.isMobile||name!==CART_OVERLAY){return;}goToPreviousNavigationState();hideActiveOverlay();}},{key:\"onEditButtonClick\",value:function onEditButtonClick(e){var onEditClick=this.props.navigationState.onEditClick;if(onEditClick){onEditClick(e);}}},{key:\"onOkButtonClick\",value:function onOkButtonClick(e){var _this$props11=this.props,_this$props11$navigat=_this$props11.navigationState,onOkClick=_this$props11$navigat.onOkClick,_this$props11$navigat2=_this$props11$navigat.shouldNotGoToPrevState,shouldNotGoToPrevState=_this$props11$navigat2===void 0?false:_this$props11$navigat2,goToPreviousNavigationState=_this$props11.goToPreviousNavigationState;if(onOkClick){onOkClick(e);}if(!shouldNotGoToPrevState){goToPreviousNavigationState();}}},{key:\"onCancelButtonClick\",value:function onCancelButtonClick(){var _this$props12=this.props,onCancelClick=_this$props12.navigationState.onCancelClick,goToPreviousNavigationState=_this$props12.goToPreviousNavigationState;if(onCancelClick){onCancelClick();}goToPreviousNavigationState();}},{key:\"render\",value:function render(){return/*#__PURE__*/_checkBEM(React,Header,Object.assign({},this.state,this.containerProps(),this.containerFunctions));}}]);return _HeaderContainer;}(Extensible(NavigationAbstractContainer));_HeaderContainer.propTypes={showOverlay:PropTypes.func.isRequired,isWishlistLoading:PropTypes.bool.isRequired,showPopup:PropTypes.func.isRequired,goToPreviousNavigationState:PropTypes.func.isRequired,hideActiveOverlay:PropTypes.func.isRequired,header_logo_src:PropTypes.string,device:DeviceType.isRequired};_HeaderContainer.defaultProps={header_logo_src:''};Object.defineProperty(_HeaderContainer,'name',{value:'HeaderContainer'});export var HeaderContainer=middleware(_HeaderContainer,\"Component/Header/Container\");export default withRouter(connect(mapStateToProps,mapDispatchToProps)(HeaderContainer));","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/Header/Header.container.js"],"names":["PropTypes","connect","withRouter","CUSTOMER_ACCOUNT_OVERLAY_KEY","DEFAULT_STATE_NAME","NavigationAbstractContainer","SHARE_WISHLIST_POPUP_ID","CHECKOUT_URL","changeNavigationState","goToPreviousNavigationState","TOP_NAVIGATION_TYPE","hideActiveOverlay","toggleOverlayByKey","showPopup","DeviceType","isSignedIn","history","appendWithStoreCode","setQueryParams","Header","CART","CART_OVERLAY","CATEGORY","CHECKOUT","CHECKOUT_ACCOUNT","CHECKOUT_SUCCESS","CMS_PAGE","CONTACT_US","CUSTOMER_ACCOUNT","CUSTOMER_ACCOUNT_PAGE","CUSTOMER_SUB_ACCOUNT","MENU","PDP","SEARCH","mapStateToProps","state","navigationState","NavigationReducer","cartTotals","CartReducer","header_logo_src","ConfigReducer","isOffline","OfflineReducer","logo_alt","logo_height","logo_width","isLoading","device","activeOverlay","OverlayReducer","isWishlistLoading","WishlistReducer","mapDispatchToProps","dispatch","showOverlay","overlayKey","setNavigationState","stateName","payload","DEFAULT_HEADER_STATE","name","isHiddenOnMobile","HeaderContainer","default_state","routeMap","title","__","onBackClick","push","goBack","containerFunctions","onBackButtonClick","bind","onCloseButtonClick","onSearchBarFocus","onClearSearchButtonClick","onMyAccountButtonClick","onSearchBarChange","onClearButtonClick","onEditButtonClick","onMinicartButtonClick","onOkButtonClick","onCancelButtonClick","onSearchOutsideClick","onMyAccountOutsideClick","onMinicartOutsideClick","onSignIn","shareWishlist","props","containerProps","isClearEnabled","searchCriteria","showMyAccountLogin","pathname","location","isCheckout","includes","closeOverlay","setState","prevPathname","getIsClearEnabled","handleHeaderVisibility","prevProps","hideSearchOnStateChange","window","historyState","activeRoute","Object","keys","find","route","category","product","page","popupOpen","prevName","hideSearchOverlay","document","activeElement","blur","documentElement","classList","add","remove","search","RegExp","join","test","e","onCloseClick","isMobile","target","value","goToDefaultHeaderState","customFilters","priceMax","priceMin","shouldRenderCartOverlay","onEditClick","onOkClick","shouldNotGoToPrevState","onCancelClick","propTypes","func","isRequired","bool","string","defaultProps","defineProperty","_HeaderContainer"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router';\n\nimport { CUSTOMER_ACCOUNT_OVERLAY_KEY } from 'Component/MyAccountOverlay/MyAccountOverlay.config';\nimport { DEFAULT_STATE_NAME } from 'Component/NavigationAbstract/NavigationAbstract.config';\nimport { NavigationAbstractContainer } from 'Component/NavigationAbstract/NavigationAbstract.container';\nimport { SHARE_WISHLIST_POPUP_ID } from 'Component/ShareWishlistPopup/ShareWishlistPopup.config';\nimport { CHECKOUT_URL } from 'Route/Checkout/Checkout.config';\nimport { changeNavigationState, goToPreviousNavigationState } from 'Store/Navigation/Navigation.action';\nimport { TOP_NAVIGATION_TYPE } from 'Store/Navigation/Navigation.reducer';\nimport { hideActiveOverlay, toggleOverlayByKey } from 'Store/Overlay/Overlay.action';\nimport { showPopup } from 'Store/Popup/Popup.action';\nimport { DeviceType } from 'Type/Device';\nimport { isSignedIn } from 'Util/Auth';\nimport history from 'Util/History';\nimport { appendWithStoreCode, setQueryParams } from 'Util/Url';\n\nimport Header from './Header.component';\nimport {\n    CART,\n    CART_OVERLAY, CATEGORY,\n    CHECKOUT, CHECKOUT_ACCOUNT, CHECKOUT_SUCCESS,\n    CMS_PAGE, CONTACT_US, CUSTOMER_ACCOUNT,\n    CUSTOMER_ACCOUNT_PAGE, CUSTOMER_SUB_ACCOUNT,\n    MENU, PDP,\n    SEARCH\n} from './Header.config';\n\n/** @namespace Component/Header/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    navigationState: state.NavigationReducer[TOP_NAVIGATION_TYPE].navigationState,\n    cartTotals: state.CartReducer.cartTotals,\n    header_logo_src: state.ConfigReducer.header_logo_src,\n    isOffline: state.OfflineReducer.isOffline,\n    logo_alt: state.ConfigReducer.logo_alt,\n    logo_height: state.ConfigReducer.logo_height,\n    logo_width: state.ConfigReducer.logo_width,\n    isLoading: state.ConfigReducer.isLoading,\n    device: state.ConfigReducer.device,\n    activeOverlay: state.OverlayReducer.activeOverlay,\n    isWishlistLoading: state.WishlistReducer.isLoading\n});\n\n/** @namespace Component/Header/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    showOverlay: (overlayKey) => dispatch(toggleOverlayByKey(overlayKey)),\n    hideActiveOverlay: () => dispatch(hideActiveOverlay()),\n    setNavigationState: (stateName) => dispatch(changeNavigationState(TOP_NAVIGATION_TYPE, stateName)),\n    showPopup: (payload) => dispatch(showPopup(SHARE_WISHLIST_POPUP_ID, payload)),\n    goToPreviousNavigationState: () => dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE))\n});\n\nexport const DEFAULT_HEADER_STATE = {\n    name: DEFAULT_STATE_NAME,\n    isHiddenOnMobile: false\n};\n\n/** @namespace Component/Header/Container */\nexport class HeaderContainer extends NavigationAbstractContainer {\n    static propTypes = {\n        showOverlay: PropTypes.func.isRequired,\n        isWishlistLoading: PropTypes.bool.isRequired,\n        showPopup: PropTypes.func.isRequired,\n        goToPreviousNavigationState: PropTypes.func.isRequired,\n        hideActiveOverlay: PropTypes.func.isRequired,\n        header_logo_src: PropTypes.string,\n        device: DeviceType.isRequired\n    };\n\n    static defaultProps = {\n        header_logo_src: ''\n    };\n\n    default_state = DEFAULT_HEADER_STATE;\n\n    routeMap = {\n        // eslint-disable-next-line max-len\n        '/account/confirm': { name: CMS_PAGE, title: __('Confirm account'), onBackClick: () => history.push(appendWithStoreCode('/')) },\n        '/category': { name: CATEGORY },\n        '/checkout/success': { name: CHECKOUT_SUCCESS },\n        '/checkout': { name: CHECKOUT, onBackClick: () => history.push(appendWithStoreCode('/cart')) },\n        '/my-account': { name: CUSTOMER_ACCOUNT_PAGE, onBackClick: () => history.push(appendWithStoreCode('/')) },\n        '/product': { name: PDP, onBackClick: () => history.goBack() },\n        '/cart': { name: CART },\n        '/menu': { name: MENU },\n        '/page': { name: CMS_PAGE, onBackClick: () => history.goBack() },\n        '/contact': { name: CONTACT_US, onBackClick: () => history.goBack() },\n        '/': { name: DEFAULT_STATE_NAME, isHiddenOnMobile: true }\n    };\n\n    containerFunctions = {\n        onBackButtonClick: this.onBackButtonClick.bind(this),\n        onCloseButtonClick: this.onCloseButtonClick.bind(this),\n        onSearchBarFocus: this.onSearchBarFocus.bind(this),\n        onClearSearchButtonClick: this.onClearSearchButtonClick.bind(this),\n        onMyAccountButtonClick: this.onMyAccountButtonClick.bind(this),\n        onSearchBarChange: this.onSearchBarChange.bind(this),\n        onClearButtonClick: this.onClearButtonClick.bind(this),\n        onEditButtonClick: this.onEditButtonClick.bind(this),\n        onMinicartButtonClick: this.onMinicartButtonClick.bind(this),\n        onOkButtonClick: this.onOkButtonClick.bind(this),\n        onCancelButtonClick: this.onCancelButtonClick.bind(this),\n        onSearchOutsideClick: this.onSearchOutsideClick.bind(this),\n        onMyAccountOutsideClick: this.onMyAccountOutsideClick.bind(this),\n        onMinicartOutsideClick: this.onMinicartOutsideClick.bind(this),\n        onSignIn: this.onSignIn.bind(this),\n        shareWishlist: this.shareWishlist.bind(this),\n        hideActiveOverlay: this.props.hideActiveOverlay\n    };\n\n    containerProps = () => {\n        const {\n            activeOverlay,\n            navigationState,\n            cartTotals,\n            header_logo_src,\n            logo_alt,\n            logo_height,\n            logo_width,\n            isLoading,\n            device,\n            isWishlistLoading\n        } = this.props;\n\n        const {\n            isClearEnabled,\n            searchCriteria,\n            showMyAccountLogin\n        } = this.state;\n\n        const {\n            location: {\n                pathname\n            }\n        } = history;\n\n        const isCheckout = pathname.includes(CHECKOUT_URL);\n\n        return {\n            activeOverlay,\n            navigationState,\n            cartTotals,\n            header_logo_src,\n            logo_alt,\n            logo_height,\n            logo_width,\n            isLoading,\n            isClearEnabled,\n            searchCriteria,\n            isCheckout,\n            showMyAccountLogin,\n            device,\n            isWishlistLoading\n        };\n    };\n\n    __construct(props) {\n        super.__construct(props);\n\n        this.state = {\n            prevPathname: '',\n            searchCriteria: '',\n            isClearEnabled: this.getIsClearEnabled(),\n            showMyAccountLogin: false\n        };\n    }\n\n    componentDidMount() {\n        this.handleHeaderVisibility();\n        super.componentDidMount();\n    }\n\n    componentDidUpdate(prevProps) {\n        this.hideSearchOnStateChange(prevProps);\n        this.handleHeaderVisibility();\n    }\n\n    shareWishlist() {\n        const { showPopup } = this.props;\n        showPopup({ title: __('Share Wishlist') });\n    }\n\n    getNavigationState() {\n        const { navigationState } = this.props;\n\n        const { pathname } = location;\n        const { state: historyState } = window.history || {};\n        const { state = {} } = historyState || {};\n\n        // TODO: something here breaks /<STORE CODE> from being opened, and / when, the url-based stores are enabled.\n\n        const activeRoute = Object.keys(this.routeMap)\n            .find((route) => (\n                route !== '/'\n                || pathname === appendWithStoreCode('/')\n                || pathname === '/'\n            ) && pathname.includes(route));\n\n        if (state.category || state.product || state.page || state.popupOpen) { // keep state if it category is in state\n            return navigationState;\n        }\n\n        return this.routeMap[activeRoute] || this.default_state;\n    }\n\n    hideSearchOnStateChange(prevProps) {\n        const { navigationState: { name: prevName } } = prevProps;\n        const { navigationState: { name } } = this.props;\n\n        if (prevName === SEARCH && prevName !== name) {\n            this.hideSearchOverlay();\n        }\n    }\n\n    hideSearchOverlay() {\n        const { hideActiveOverlay, activeOverlay } = this.props;\n\n        this.setState({ searchCriteria: '' });\n\n        document.activeElement.blur();\n\n        if (activeOverlay === SEARCH) {\n            hideActiveOverlay();\n        }\n    }\n\n    handleHeaderVisibility() {\n        const { navigationState: { isHiddenOnMobile } } = this.props;\n\n        if (isHiddenOnMobile) {\n            document.documentElement.classList.add('hiddenHeader');\n            return;\n        }\n\n        document.documentElement.classList.remove('hiddenHeader');\n    }\n\n    handleMobileUrlChange(history) {\n        const { prevPathname } = this.state;\n        const { pathname } = history;\n        const isClearEnabled = this.getIsClearEnabled();\n\n        if (prevPathname === pathname) {\n            return { isClearEnabled };\n        }\n\n        return {\n            isClearEnabled,\n            showMyAccountLogin: false\n        };\n    }\n\n    getIsClearEnabled() {\n        const { location: { search } } = history;\n\n        return new RegExp([\n            'customFilters',\n            'priceMax',\n            'priceMin'\n        ].join('|')).test(search);\n    }\n\n    onBackButtonClick(e) {\n        const { navigationState: { onBackClick } } = this.props;\n\n        this.setState({ searchCriteria: '' });\n\n        if (onBackClick) {\n            onBackClick(e);\n        }\n    }\n\n    onCloseButtonClick(e) {\n        const { hideActiveOverlay, goToPreviousNavigationState } = this.props;\n        const { navigationState: { onCloseClick } } = this.props;\n\n        this.setState({ searchCriteria: '' });\n\n        if (onCloseClick) {\n            onCloseClick(e);\n        }\n\n        hideActiveOverlay();\n        goToPreviousNavigationState();\n    }\n\n    onSearchOutsideClick() {\n        const {\n            goToPreviousNavigationState,\n            navigationState: { name },\n            device\n        } = this.props;\n\n        if (!device.isMobile && name === SEARCH) {\n            this.hideSearchOverlay();\n            goToPreviousNavigationState();\n        }\n    }\n\n    onSearchBarFocus() {\n        const {\n            setNavigationState,\n            goToPreviousNavigationState,\n            showOverlay,\n            navigationState: { name },\n            device\n        } = this.props;\n\n        if (\n            (!device.isMobile && name === SEARCH)\n            || (device.isMobile && name !== MENU)\n        ) {\n            return;\n        }\n\n        showOverlay(SEARCH);\n\n        setNavigationState({\n            name: SEARCH,\n            onBackClick: () => {\n                showOverlay(MENU);\n                goToPreviousNavigationState();\n            }\n        });\n    }\n\n    onSearchBarChange({ target: { value: searchCriteria } }) {\n        this.setState({ searchCriteria });\n    }\n\n    onClearSearchButtonClick() {\n        this.setState({ searchCriteria: '' });\n    }\n\n    onMyAccountButtonClick() {\n        const {\n            showOverlay,\n            setNavigationState\n        } = this.props;\n\n        if (isSignedIn()) {\n            history.push({ pathname: appendWithStoreCode('/my-account/dashboard') });\n            return;\n        }\n\n        this.setState({ showMyAccountLogin: true }, () => {\n            showOverlay(CUSTOMER_ACCOUNT_OVERLAY_KEY);\n            setNavigationState({\n                name: CHECKOUT_ACCOUNT,\n                title: 'Sign in',\n                onCloseClick: this.closeOverlay\n            });\n        });\n    }\n\n    onMyAccountOutsideClick() {\n        const {\n            goToPreviousNavigationState,\n            hideActiveOverlay,\n            navigationState: { name },\n            device\n        } = this.props;\n\n        if (device.isMobile || ![CUSTOMER_ACCOUNT, CUSTOMER_SUB_ACCOUNT, CHECKOUT_ACCOUNT].includes(name)) {\n            return;\n        }\n\n        if (name === CUSTOMER_SUB_ACCOUNT) {\n            goToPreviousNavigationState();\n        }\n\n        this.goToDefaultHeaderState();\n        hideActiveOverlay();\n    }\n\n    closeOverlay = () => {\n        const { location: { pathname } } = history;\n\n        if (pathname.includes(CHECKOUT_URL)) {\n            this.setState({ showMyAccountLogin: false });\n        }\n    };\n\n    onSignIn() {\n        const { location: { pathname } } = history;\n\n        if (pathname.includes(CHECKOUT_URL)) {\n            this.setState({ showMyAccountLogin: false });\n        }\n    }\n\n    onClearButtonClick() {\n        const {\n            hideActiveOverlay,\n            goToPreviousNavigationState\n        } = this.props;\n\n        setQueryParams(\n            {\n                customFilters: '',\n                priceMax: '',\n                priceMin: ''\n            },\n            history.location,\n            history\n        );\n\n        this.setState({ isClearEnabled: false });\n\n        hideActiveOverlay();\n        goToPreviousNavigationState();\n    }\n\n    onMinicartButtonClick() {\n        const {\n            showOverlay,\n            navigationState: { name },\n            device\n        } = this.props;\n\n        if (name === CART_OVERLAY) {\n            return;\n        }\n\n        if (!device.isMobile) {\n            this.setState({ shouldRenderCartOverlay: true });\n\n            showOverlay(CART_OVERLAY);\n            return;\n        }\n\n        history.push(appendWithStoreCode(`/${ CART }`));\n    }\n\n    onMinicartOutsideClick() {\n        const {\n            goToPreviousNavigationState,\n            hideActiveOverlay,\n            navigationState: { name },\n            device\n        } = this.props;\n\n        if (device.isMobile || name !== CART_OVERLAY) {\n            return;\n        }\n\n        goToPreviousNavigationState();\n        hideActiveOverlay();\n    }\n\n    onEditButtonClick(e) {\n        const { navigationState: { onEditClick } } = this.props;\n\n        if (onEditClick) {\n            onEditClick(e);\n        }\n    }\n\n    onOkButtonClick(e) {\n        const {\n            navigationState: { onOkClick, shouldNotGoToPrevState = false },\n            goToPreviousNavigationState\n        } = this.props;\n\n        if (onOkClick) {\n            onOkClick(e);\n        }\n\n        if (!shouldNotGoToPrevState) {\n            goToPreviousNavigationState();\n        }\n    }\n\n    onCancelButtonClick() {\n        const {\n            navigationState: { onCancelClick },\n            goToPreviousNavigationState\n        } = this.props;\n\n        if (onCancelClick) {\n            onCancelClick();\n        }\n\n        goToPreviousNavigationState();\n    }\n\n    render() {\n        return (\n            <Header\n              { ...this.state }\n              { ...this.containerProps() }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(HeaderContainer));\n"]},"metadata":{},"sourceType":"module"}