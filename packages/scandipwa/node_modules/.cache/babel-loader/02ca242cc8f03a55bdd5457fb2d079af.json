{"ast":null,"code":"import _toConsumableArray from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _toPropertyKey from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toPropertyKey\";import _objectSpread from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import{connect}from'react-redux';import{withRouter}from'react-router';import{PRODUCT_IN_STOCK,PRODUCT_OUT_OF_STOCK}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CartItem/CartItem.config\";import{PDP}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/Header/Header.config\";import{MENU_TAB}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/NavigationTabs/NavigationTabs.config\";import{LOADING_TIME}from\"/home/marketihor/scandipwa/packages/scandipwa/src/route/CategoryPage/CategoryPage.config\";import{changeNavigationState as _changeNavigationState,goToPreviousNavigationState as _goToPreviousNavigationState}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.action\";import{BOTTOM_NAVIGATION_TYPE,TOP_NAVIGATION_TYPE}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.reducer\";import{setBigOfflineNotice as _setBigOfflineNotice}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Offline/Offline.action\";import{addRecentlyViewedProduct as _addRecentlyViewedProduct}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/RecentlyViewedProducts/RecentlyViewedProducts.action\";import{HistoryType,LocationType,MatchType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Common\";import{ProductType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/ProductList\";import{getVariantIndex}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Product\";import{debounce}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Request\";import{convertQueryStringToKeyValuePairs,objectToUri,removeQueryParamWithoutHistory,updateQueryParamWithoutHistory}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Url\";import ProductPage from\"./ProductPage.component\";export var BreadcrumbsDispatcher=import(/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Breadcrumbs/Breadcrumbs.dispatcher\");export var MetaDispatcher=import(/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Meta/Meta.dispatcher\");export var ProductDispatcher=import(/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Product/Product.dispatcher\");/** @namespace Route/ProductPage/Container/mapStateToProps */export var mapStateToProps=middleware(function(state){return{isOffline:state.OfflineReducer.isOffline,product:state.ProductReducer.product,navigation:state.NavigationReducer[TOP_NAVIGATION_TYPE],metaTitle:state.MetaReducer.title,device:state.ConfigReducer.device,store:state.ConfigReducer.code};},\"Route/ProductPage/Container/mapStateToProps\");/** @namespace Route/ProductPage/Container/mapDispatchToProps */export var mapDispatchToProps=middleware(function(dispatch){return{changeHeaderState:function changeHeaderState(state){return dispatch(_changeNavigationState(TOP_NAVIGATION_TYPE,state));},changeNavigationState:function changeNavigationState(state){return dispatch(_changeNavigationState(BOTTOM_NAVIGATION_TYPE,state));},requestProduct:function requestProduct(options){// TODO: check linked products, there might be issues :'(\nProductDispatcher.then(function(_ref){var dispatcher=_ref.default;return dispatcher.handleData(dispatch,options);});},setBigOfflineNotice:function setBigOfflineNotice(isBig){return dispatch(_setBigOfflineNotice(isBig));},updateBreadcrumbs:function updateBreadcrumbs(breadcrumbs,prevCategoryId){return BreadcrumbsDispatcher.then(function(_ref2){var dispatcher=_ref2.default;return dispatcher.updateWithProduct(breadcrumbs,prevCategoryId,dispatch);});},updateMetaFromProduct:function updateMetaFromProduct(product){return MetaDispatcher.then(function(_ref3){var dispatcher=_ref3.default;return dispatcher.updateWithProduct(product,dispatch);});},goToPreviousNavigationState:function goToPreviousNavigationState(state){return dispatch(_goToPreviousNavigationState(TOP_NAVIGATION_TYPE,state));},addRecentlyViewedProduct:function addRecentlyViewedProduct(product,store){return dispatch(_addRecentlyViewedProduct(product,store));}};},\"Route/ProductPage/Container/mapDispatchToProps\");/** @namespace Route/ProductPage/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _ProductPageContainer=/*#__PURE__*/function(_Extensible){_inherits(_ProductPageContainer,_Extensible);var _super=_createSuper(_ProductPageContainer);function _ProductPageContainer(){var _this;_classCallCheck(this,_ProductPageContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={configurableVariantIndex:-1,parameters:{},productOptionsData:{},selectedInitialBundlePrice:0,selectedBundlePrice:0,selectedBundlePriceExclTax:0,selectedLinkPrice:0,currentProductSKU:''};_this.containerFunctions={updateConfigurableVariant:_this.updateConfigurableVariant.bind(_assertThisInitialized(_this)),getLink:_this.getLink.bind(_assertThisInitialized(_this)),getSelectedCustomizableOptions:_this.getSelectedCustomizableOptions.bind(_assertThisInitialized(_this)),setBundlePrice:_this.setBundlePrice.bind(_assertThisInitialized(_this)),setLinkedDownloadables:_this.setLinkedDownloadables.bind(_assertThisInitialized(_this)),setLinkedDownloadablesPrice:_this.setLinkedDownloadablesPrice.bind(_assertThisInitialized(_this)),isProductInformationTabEmpty:_this.isProductInformationTabEmpty.bind(_assertThisInitialized(_this)),isProductAttributesTabEmpty:_this.isProductAttributesTabEmpty.bind(_assertThisInitialized(_this))};_this.setOfflineNoticeSize=function(){var _this$props=_this.props,setBigOfflineNotice=_this$props.setBigOfflineNotice,productSKU=_this$props.productSKU;var _this$getDataSource=_this.getDataSource(),sku=_this$getDataSource.sku;/**\n         * If there is any information about the product, in example,\n         * we know it's URL-rewrite SKU is matching the product SKU -\n         * show the small offline notice, else - show larger one.\n         */if(sku!==productSKU){setBigOfflineNotice(true);}else{setBigOfflineNotice(false);}};_this.containerProps=function(){return{productOrVariant:_this.getProductOrVariant(),dataSource:_this.getDataSource(),areDetailsLoaded:_this.getAreDetailsLoaded(),isInformationTabEmpty:_this.isProductInformationTabEmpty(),isAttributesTabEmpty:_this.isProductAttributesTabEmpty()};};return _this;}_createClass(_ProductPageContainer,[{key:\"componentDidMount\",value:function componentDidMount(){/**\n         * Always make sure the navigation switches into the MENU tab\n         * */this.updateNavigationState();/**\n         * Ensure transition PDP => homepage => PDP always having proper meta\n         */this.updateMeta();/**\n         * Make sure to update header state, the data-source will\n         * define the correct information to use for update\n         * (it can be a product, history state product or an empty object).\n         */this.updateHeaderState();this.updateBreadcrumbs();/**\n         * Scroll page top in order to display it from the start\n         */this.scrollTop();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var _history,_history$state,_history$state$state;var _this$props2=this.props,isOffline=_this$props2.isOffline,productSKU=_this$props2.productSKU,_this$props2$product=_this$props2.product,sku=_this$props2$product.sku,options=_this$props2$product.options,items=_this$props2$product.items;var prevProductSKU=prevProps.productSKU,_prevProps$product=prevProps.product,prevSku=_prevProps$product.sku,prevOptions=_prevProps$product.options,prevItems=_prevProps$product.items;var _ref4=((_history=history)===null||_history===void 0?void 0:(_history$state=_history.state)===null||_history$state===void 0?void 0:(_history$state$state=_history$state.state)===null||_history$state$state===void 0?void 0:_history$state$state.product)||{},stateSKU=_ref4.sku;if(isOffline){debounce(this.setOfflineNoticeSize,LOADING_TIME)();}/**\n         * We should also update product based data if, the URL\n         * rewrite SKU has changed to matching the product history SKU\n         * one. At this point there could be sufficient data for\n         * some updates (i.e. header state).\n         */if(productSKU!==prevProductSKU&&stateSKU===productSKU){this.updateHeaderState();}/**\n         * If the currently loaded category ID does not match the ID of\n         * category ID from URL rewrite, request category.\n         */if(productSKU!==sku){this.requestProduct();}/**\n         * If product ID was changed => it is loaded => we need to\n         * update product specific information, i.e. breadcrumbs.\n         */if(sku!==prevSku){this.updateBreadcrumbs();this.updateHeaderState();this.updateMeta();}/**\n         * LEGACY: needed to make sure required items are\n         * selected in the bundle product.\n         */if(JSON.stringify(options)!==JSON.stringify(prevOptions)){this.getRequiredProductOptions(options);}/**\n         * LEGACY needed to make sure required options are\n         * selected in the customizable options product.\n         */if(JSON.stringify(items)!==JSON.stringify(prevItems)){this.getRequiredProductOptions(items);}this._addToRecentlyViewedProducts();}},{key:\"isProductInformationTabEmpty\",value:function isProductInformationTabEmpty(){var _dataSource$descripti,_dataSource$descripti2;var dataSource=this.getDataSource();return(dataSource===null||dataSource===void 0?void 0:(_dataSource$descripti=dataSource.description)===null||_dataSource$descripti===void 0?void 0:(_dataSource$descripti2=_dataSource$descripti.html)===null||_dataSource$descripti2===void 0?void 0:_dataSource$descripti2.length)===0;}},{key:\"isProductAttributesTabEmpty\",value:function isProductAttributesTabEmpty(){var dataSource=this.getDataSource();return Object.keys((dataSource===null||dataSource===void 0?void 0:dataSource.attributes)||{}).length===0;}},{key:\"_addToRecentlyViewedProducts\",value:function _addToRecentlyViewedProducts(){var _this$props3=this.props,product=_this$props3.product,sku=_this$props3.product.sku,addRecentlyViewedProduct=_this$props3.addRecentlyViewedProduct,store=_this$props3.store;// necessary for skipping not loaded products\nif(!sku){return;}// push into localstorage only preview of product (image, name and etc)\nvar canonical_url=product.canonical_url,categories=product.categories,configurable_options=product.configurable_options,description=product.description,items=product.items,meta_description=product.meta_description,meta_keyword=product.meta_keyword,meta_title=product.meta_title,options=product.options,product_links=product.product_links,reviews=product.reviews,short_description=product.short_description,variants=product.variants,productPreview=_objectWithoutProperties(product,[\"canonical_url\",\"categories\",\"configurable_options\",\"description\",\"items\",\"meta_description\",\"meta_keyword\",\"meta_title\",\"options\",\"product_links\",\"reviews\",\"short_description\",\"variants\"]);addRecentlyViewedProduct(productPreview,store);}},{key:\"scrollTop\",value:function scrollTop(){window.scrollTo(0,0);}},{key:\"getLink\",value:function getLink(key,value){var _this$props$location=this.props.location,search=_this$props$location.search,pathname=_this$props$location.pathname;var obj=_objectSpread({},convertQueryStringToKeyValuePairs(search));if(key){obj[key]=value;}var query=objectToUri(obj);return\"\".concat(pathname).concat(query);}},{key:\"getRequiredProductOptions\",value:function getRequiredProductOptions(options){var productOptionsData=this.state.productOptionsData;if(!options){return[];}var requiredOptions=options.reduce(function(acc,_ref5){var option_id=_ref5.option_id,required=_ref5.required;if(required){acc.push(option_id);}return acc;},[]);return this.setState({productOptionsData:_objectSpread(_objectSpread({},productOptionsData),{},{requiredOptions:requiredOptions})});}},{key:\"setLinkedDownloadablesPrice\",value:function setLinkedDownloadablesPrice(price){this.setState({selectedLinkPrice:price});}},{key:\"setBundlePrice\",value:function setBundlePrice(prices){var _prices$price=prices.price,price=_prices$price===void 0?0:_prices$price,_prices$priceExclTax=prices.priceExclTax,priceExclTax=_prices$priceExclTax===void 0?0:_prices$priceExclTax,_prices$finalPrice=prices.finalPrice,finalPrice=_prices$finalPrice===void 0?0:_prices$finalPrice;this.setState({selectedInitialBundlePrice:price,selectedBundlePrice:finalPrice,selectedBundlePriceExclTax:priceExclTax});}},{key:\"setLinkedDownloadables\",value:function setLinkedDownloadables(links){var productOptionsData=this.state.productOptionsData;this.setState({productOptionsData:_objectSpread(_objectSpread({},productOptionsData),{},{downloadableLinks:links})});}},{key:\"getSelectedCustomizableOptions\",value:function getSelectedCustomizableOptions(values){var updateArray=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var productOptionsData=this.state.productOptionsData;if(updateArray){this.setState({productOptionsData:_objectSpread(_objectSpread({},productOptionsData),{},{productOptionsMulti:values})});}else{this.setState({productOptionsData:_objectSpread(_objectSpread({},productOptionsData),{},{productOptions:values})});}}},{key:\"getIsConfigurableParameterSelected\",value:function getIsConfigurableParameterSelected(parameters,key,value){return Object.hasOwnProperty.call(parameters,key)&&parameters[key]===value;}},{key:\"getNewParameters\",value:function getNewParameters(key,value){var parameters=this.state.parameters;// If value is already selected, than we remove the key to achieve deselection\nif(this.getIsConfigurableParameterSelected(parameters,key,value)){var oldValue=parameters[key],newParameters=_objectWithoutProperties(parameters,[key].map(_toPropertyKey));return newParameters;}return _objectSpread(_objectSpread({},parameters),{},_defineProperty({},key,value.toString()));}},{key:\"updateConfigurableVariant\",value:function updateConfigurableVariant(key,value){var parameters=this.getNewParameters(key,value);this.setState({parameters:parameters});this.updateUrl(key,value,parameters);this.updateConfigurableVariantIndex(parameters);}},{key:\"updateUrl\",value:function updateUrl(key,value,parameters){var _this$props4=this.props,location=_this$props4.location,history=_this$props4.history;var isParameterSelected=this.getIsConfigurableParameterSelected(parameters,key,value);if(isParameterSelected){updateQueryParamWithoutHistory(key,value,history,location);}else{removeQueryParamWithoutHistory(key,history,location);}}},{key:\"updateConfigurableVariantIndex\",value:function updateConfigurableVariantIndex(parameters){var _this$props$product=this.props.product,variants=_this$props$product.variants,configurable_options=_this$props$product.configurable_options;var configurableVariantIndex=this.state.configurableVariantIndex;var newIndex=Object.keys(parameters).length===Object.keys(configurable_options).length?getVariantIndex(variants,parameters)// Not all parameters are selected yet, therefore variantIndex must be invalid\n:-1;if(configurableVariantIndex!==newIndex){this.setState({configurableVariantIndex:newIndex});}}},{key:\"getAreDetailsLoaded\",value:function getAreDetailsLoaded(){var product=this.props.product;var dataSource=this.getDataSource();return dataSource===product;}},{key:\"getProductOrVariant\",value:function getProductOrVariant(){var dataSource=this.getDataSource();var variants=dataSource.variants;var currentVariantIndex=this.getConfigurableVariantIndex(variants);var variant=variants&&variants[currentVariantIndex];if((variants===null||variants===void 0?void 0:variants.length)>0){dataSource.stock_status=variants.some(function(v){return v.stock_status===PRODUCT_IN_STOCK;})?PRODUCT_IN_STOCK:PRODUCT_OUT_OF_STOCK;}return variant||dataSource;}},{key:\"getConfigurableVariantIndex\",value:function getConfigurableVariantIndex(variants){var _this$state=this.state,configurableVariantIndex=_this$state.configurableVariantIndex,parameters=_this$state.parameters;var hasParameters=!!Object.keys(parameters).length;if(configurableVariantIndex>=0){return configurableVariantIndex;}if(variants&&hasParameters){return getVariantIndex(variants,parameters);}return-1;}},{key:\"getDataSource\",value:function getDataSource(){var _history2,_history2$state;var _this$props5=this.props,productSKU=_this$props5.productSKU,product=_this$props5.product;var sku=product.sku;var _ref6=((_history2=history)===null||_history2===void 0?void 0:(_history2$state=_history2.state)===null||_history2$state===void 0?void 0:_history2$state.state)||{},stateProduct=_ref6.product;var _ref7=stateProduct||{},stateSKU=_ref7.sku;/**\n         * If URL rewrite requested matches loaded product SKU\n         * assume it is a data-source.\n         */if(productSKU===sku){return product;}/**\n         * If URL rewrite requested matches product SKU from\n         * history state - it is a data-source.\n         */if(productSKU===stateSKU){return stateProduct;}/**\n         * Else there is no place to get a up-to-date\n         * information about the product from.\n         */return{};}},{key:\"getProductRequestFilter\",value:function getProductRequestFilter(){var productSKU=this.props.productSKU;return{productSKU:productSKU};}},{key:\"requestProduct\",value:function requestProduct(){var _this$props6=this.props,requestProduct=_this$props6.requestProduct,productSKU=_this$props6.productSKU;var currentProductSKU=this.state.currentProductSKU;/**\n         * If URL rewrite was not passed - do not request the product.\n         */if(!productSKU){return;}/**\n         * Skip loading the same product SKU the second time\n         */if(currentProductSKU===productSKU){return;}this.setState({currentProductSKU:productSKU});var options={isSingleProduct:true,args:{filter:this.getProductRequestFilter()}};requestProduct(options);}},{key:\"updateNavigationState\",value:function updateNavigationState(){var changeNavigationState=this.props.changeNavigationState;changeNavigationState({name:MENU_TAB});}},{key:\"updateMeta\",value:function updateMeta(){var updateMetaFromProduct=this.props.updateMetaFromProduct;updateMetaFromProduct(this.getDataSource());}},{key:\"updateHeaderState\",value:function updateHeaderState(){var _this$getDataSource2=this.getDataSource(),_this$getDataSource2$=_this$getDataSource2.name,name=_this$getDataSource2$===void 0?'':_this$getDataSource2$;var changeHeaderState=this.props.changeHeaderState;changeHeaderState({name:PDP,title:name,onBackClick:function onBackClick(){return history.back();}});}},{key:\"updateBreadcrumbs\",value:function updateBreadcrumbs(){var _this$props7=this.props,updateBreadcrumbs=_this$props7.updateBreadcrumbs,location=_this$props7.location;var _location$state=location.state;_location$state=_location$state===void 0?{}:_location$state;var _location$state$prevC=_location$state.prevCategoryId,prevCategoryId=_location$state$prevC===void 0?null:_location$state$prevC;updateBreadcrumbs(this.getDataSource(),prevCategoryId);}},{key:\"render\",value:function render(){return/*#__PURE__*/_checkBEM(React,ProductPage,Object.assign({},this.props,this.state,this.containerFunctions,this.containerProps()));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){var _props$product=props.product,sku=_props$product.sku,variants=_props$product.variants,configurable_options=_props$product.configurable_options,options=_props$product.options,productOptionsData=_props$product.productOptionsData,search=props.location.search;var prevSKU=state.currentProductSKU,prevOptionData=state.productOptionsData;var currentProductSKU=prevSKU===sku?'':prevSKU;/**\n         * If the product we expect to load is loaded -\n         * reset expected SKU\n         */if(!configurable_options&&!variants){return{currentProductSKU:currentProductSKU};}var parameters=Object.entries(convertQueryStringToKeyValuePairs(search)).reduce(function(acc,_ref8){var _ref9=_slicedToArray(_ref8,2),key=_ref9[0],value=_ref9[1];if(key in configurable_options){return _objectSpread(_objectSpread({},acc),{},_defineProperty({},key,value));}return acc;},{});if(Object.keys(parameters).length!==Object.keys(configurable_options).length){return{parameters:parameters,currentProductSKU:currentProductSKU};}var configurableVariantIndex=getVariantIndex(variants,parameters);var newOptionsData=options.reduce(function(acc,_ref10){var option_id=_ref10.option_id,required=_ref10.required;if(required){acc.push(option_id);}return acc;},[]);var prevRequiredOptions=(productOptionsData===null||productOptionsData===void 0?void 0:productOptionsData.requiredOptions)||[];var requiredOptions=[].concat(_toConsumableArray(prevRequiredOptions),_toConsumableArray(newOptionsData));return{parameters:parameters,currentProductSKU:currentProductSKU,configurableVariantIndex:configurableVariantIndex,productOptionsData:_objectSpread(_objectSpread(_objectSpread({},prevOptionData),productOptionsData),{},{requiredOptions:requiredOptions})};}}]);return _ProductPageContainer;}(Extensible(PureComponent));_ProductPageContainer.defaultProps={location:{state:{}},productSKU:'',metaTitle:undefined};Object.defineProperty(_ProductPageContainer,'name',{value:'ProductPageContainer'});export var ProductPageContainer=middleware(_ProductPageContainer,\"Route/ProductPage/Container\");export default withRouter(connect(mapStateToProps,mapDispatchToProps)(ProductPageContainer));","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/route/ProductPage/ProductPage.container.js"],"names":["PureComponent","connect","withRouter","PRODUCT_IN_STOCK","PRODUCT_OUT_OF_STOCK","PDP","MENU_TAB","LOADING_TIME","changeNavigationState","goToPreviousNavigationState","BOTTOM_NAVIGATION_TYPE","TOP_NAVIGATION_TYPE","setBigOfflineNotice","addRecentlyViewedProduct","HistoryType","LocationType","MatchType","ProductType","getVariantIndex","debounce","convertQueryStringToKeyValuePairs","objectToUri","removeQueryParamWithoutHistory","updateQueryParamWithoutHistory","ProductPage","BreadcrumbsDispatcher","MetaDispatcher","ProductDispatcher","mapStateToProps","state","isOffline","OfflineReducer","product","ProductReducer","navigation","NavigationReducer","metaTitle","MetaReducer","title","device","ConfigReducer","store","code","mapDispatchToProps","dispatch","changeHeaderState","requestProduct","options","then","dispatcher","default","handleData","isBig","updateBreadcrumbs","breadcrumbs","prevCategoryId","updateWithProduct","updateMetaFromProduct","ProductPageContainer","configurableVariantIndex","parameters","productOptionsData","selectedInitialBundlePrice","selectedBundlePrice","selectedBundlePriceExclTax","selectedLinkPrice","currentProductSKU","containerFunctions","updateConfigurableVariant","bind","getLink","getSelectedCustomizableOptions","setBundlePrice","setLinkedDownloadables","setLinkedDownloadablesPrice","isProductInformationTabEmpty","isProductAttributesTabEmpty","setOfflineNoticeSize","props","productSKU","getDataSource","sku","containerProps","productOrVariant","getProductOrVariant","dataSource","areDetailsLoaded","getAreDetailsLoaded","isInformationTabEmpty","isAttributesTabEmpty","updateNavigationState","updateMeta","updateHeaderState","scrollTop","prevProps","items","prevProductSKU","prevSku","prevOptions","prevItems","history","stateSKU","JSON","stringify","getRequiredProductOptions","_addToRecentlyViewedProducts","description","html","length","Object","keys","attributes","canonical_url","categories","configurable_options","meta_description","meta_keyword","meta_title","product_links","reviews","short_description","variants","productPreview","window","scrollTo","key","value","location","search","pathname","obj","query","requiredOptions","reduce","acc","option_id","required","push","setState","price","prices","priceExclTax","finalPrice","links","downloadableLinks","values","updateArray","productOptionsMulti","productOptions","hasOwnProperty","call","getIsConfigurableParameterSelected","oldValue","newParameters","toString","getNewParameters","updateUrl","updateConfigurableVariantIndex","isParameterSelected","newIndex","currentVariantIndex","getConfigurableVariantIndex","variant","stock_status","some","v","hasParameters","stateProduct","isSingleProduct","args","filter","getProductRequestFilter","name","onBackClick","back","prevSKU","prevOptionData","entries","newOptionsData","prevRequiredOptions","defaultProps","undefined","defineProperty","_ProductPageContainer"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router';\n\nimport { PRODUCT_IN_STOCK, PRODUCT_OUT_OF_STOCK } from 'Component/CartItem/CartItem.config';\nimport { PDP } from 'Component/Header/Header.config';\nimport { MENU_TAB } from 'Component/NavigationTabs/NavigationTabs.config';\nimport { LOADING_TIME } from 'Route/CategoryPage/CategoryPage.config';\nimport { changeNavigationState, goToPreviousNavigationState } from 'Store/Navigation/Navigation.action';\nimport { BOTTOM_NAVIGATION_TYPE, TOP_NAVIGATION_TYPE } from 'Store/Navigation/Navigation.reducer';\nimport { setBigOfflineNotice } from 'Store/Offline/Offline.action';\nimport { addRecentlyViewedProduct } from 'Store/RecentlyViewedProducts/RecentlyViewedProducts.action';\nimport { HistoryType, LocationType, MatchType } from 'Type/Common';\nimport { ProductType } from 'Type/ProductList';\nimport { getVariantIndex } from 'Util/Product';\nimport { debounce } from 'Util/Request';\nimport {\n    convertQueryStringToKeyValuePairs,\n    objectToUri,\n    removeQueryParamWithoutHistory,\n    updateQueryParamWithoutHistory\n} from 'Util/Url';\n\nimport ProductPage from './ProductPage.component';\n\nexport const BreadcrumbsDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/Breadcrumbs/Breadcrumbs.dispatcher'\n);\n\nexport const MetaDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/Meta/Meta.dispatcher'\n);\n\nexport const ProductDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/Product/Product.dispatcher'\n);\n\n/** @namespace Route/ProductPage/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    isOffline: state.OfflineReducer.isOffline,\n    product: state.ProductReducer.product,\n    navigation: state.NavigationReducer[TOP_NAVIGATION_TYPE],\n    metaTitle: state.MetaReducer.title,\n    device: state.ConfigReducer.device,\n    store: state.ConfigReducer.code\n});\n\n/** @namespace Route/ProductPage/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    changeHeaderState: (state) => dispatch(changeNavigationState(TOP_NAVIGATION_TYPE, state)),\n    changeNavigationState: (state) => dispatch(changeNavigationState(BOTTOM_NAVIGATION_TYPE, state)),\n    requestProduct: (options) => {\n        // TODO: check linked products, there might be issues :'(\n        ProductDispatcher.then(\n            ({ default: dispatcher }) => dispatcher.handleData(dispatch, options)\n        );\n    },\n    setBigOfflineNotice: (isBig) => dispatch(setBigOfflineNotice(isBig)),\n    updateBreadcrumbs: (breadcrumbs, prevCategoryId) => BreadcrumbsDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.updateWithProduct(breadcrumbs, prevCategoryId, dispatch)\n    ),\n    updateMetaFromProduct: (product) => MetaDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.updateWithProduct(product, dispatch)\n    ),\n    goToPreviousNavigationState: (state) => dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE, state)),\n    addRecentlyViewedProduct: (product, store) => dispatch(addRecentlyViewedProduct(product, store))\n});\n\n/** @namespace Route/ProductPage/Container */\nexport class ProductPageContainer extends PureComponent {\n    state = {\n        configurableVariantIndex: -1,\n        parameters: {},\n        productOptionsData: {},\n        selectedInitialBundlePrice: 0,\n        selectedBundlePrice: 0,\n        selectedBundlePriceExclTax: 0,\n        selectedLinkPrice: 0,\n        currentProductSKU: ''\n    };\n\n    containerFunctions = {\n        updateConfigurableVariant: this.updateConfigurableVariant.bind(this),\n        getLink: this.getLink.bind(this),\n        getSelectedCustomizableOptions: this.getSelectedCustomizableOptions.bind(this),\n        setBundlePrice: this.setBundlePrice.bind(this),\n        setLinkedDownloadables: this.setLinkedDownloadables.bind(this),\n        setLinkedDownloadablesPrice: this.setLinkedDownloadablesPrice.bind(this),\n        isProductInformationTabEmpty: this.isProductInformationTabEmpty.bind(this),\n        isProductAttributesTabEmpty: this.isProductAttributesTabEmpty.bind(this)\n    };\n\n    static propTypes = {\n        location: LocationType,\n        changeHeaderState: PropTypes.func.isRequired,\n        setBigOfflineNotice: PropTypes.func.isRequired,\n        changeNavigationState: PropTypes.func.isRequired,\n        updateMetaFromProduct: PropTypes.func.isRequired,\n        updateBreadcrumbs: PropTypes.func.isRequired,\n        requestProduct: PropTypes.func.isRequired,\n        isOffline: PropTypes.bool.isRequired,\n        productSKU: PropTypes.string,\n        product: ProductType.isRequired,\n        history: HistoryType.isRequired,\n        match: MatchType.isRequired,\n        goToPreviousNavigationState: PropTypes.func.isRequired,\n        navigation: PropTypes.shape(PropTypes.shape).isRequired,\n        metaTitle: PropTypes.string,\n        addRecentlyViewedProduct: PropTypes.func.isRequired,\n        store: PropTypes.string.isRequired\n    };\n\n    static defaultProps = {\n        location: { state: {} },\n        productSKU: '',\n        metaTitle: undefined\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        const {\n            product: {\n                sku,\n                variants,\n                configurable_options,\n                options,\n                productOptionsData\n            },\n            location: { search }\n        } = props;\n\n        const {\n            currentProductSKU: prevSKU,\n            productOptionsData: prevOptionData\n        } = state;\n\n        const currentProductSKU = prevSKU === sku ? '' : prevSKU;\n\n        /**\n         * If the product we expect to load is loaded -\n         * reset expected SKU\n         */\n        if (!configurable_options && !variants) {\n            return {\n                currentProductSKU\n            };\n        }\n\n        const parameters = Object.entries(convertQueryStringToKeyValuePairs(search))\n            .reduce((acc, [key, value]) => {\n                if (key in configurable_options) {\n                    return { ...acc, [key]: value };\n                }\n\n                return acc;\n            }, {});\n\n        if (Object.keys(parameters).length !== Object.keys(configurable_options).length) {\n            return {\n                parameters,\n                currentProductSKU\n            };\n        }\n\n        const configurableVariantIndex = getVariantIndex(variants, parameters);\n\n        const newOptionsData = options.reduce((acc, { option_id, required }) => {\n            if (required) {\n                acc.push(option_id);\n            }\n\n            return acc;\n        }, []);\n\n        const prevRequiredOptions = productOptionsData?.requiredOptions || [];\n        const requiredOptions = [...prevRequiredOptions, ...newOptionsData];\n\n        return {\n            parameters,\n            currentProductSKU,\n            configurableVariantIndex,\n            productOptionsData: {\n                ...prevOptionData, ...productOptionsData, requiredOptions\n            }\n        };\n    }\n\n    componentDidMount() {\n        /**\n         * Always make sure the navigation switches into the MENU tab\n         * */\n        this.updateNavigationState();\n\n        /**\n         * Ensure transition PDP => homepage => PDP always having proper meta\n         */\n        this.updateMeta();\n\n        /**\n         * Make sure to update header state, the data-source will\n         * define the correct information to use for update\n         * (it can be a product, history state product or an empty object).\n         */\n        this.updateHeaderState();\n        this.updateBreadcrumbs();\n\n        /**\n         * Scroll page top in order to display it from the start\n         */\n        this.scrollTop();\n    }\n\n    componentDidUpdate(prevProps) {\n        const {\n            isOffline,\n            productSKU,\n            product: {\n                sku,\n                options,\n                items\n            }\n        } = this.props;\n\n        const {\n            productSKU: prevProductSKU,\n            product: {\n                sku: prevSku,\n                options: prevOptions,\n                items: prevItems\n            }\n        } = prevProps;\n\n        const { sku: stateSKU } = history?.state?.state?.product || {};\n\n        if (isOffline) {\n            debounce(this.setOfflineNoticeSize, LOADING_TIME)();\n        }\n\n        /**\n         * We should also update product based data if, the URL\n         * rewrite SKU has changed to matching the product history SKU\n         * one. At this point there could be sufficient data for\n         * some updates (i.e. header state).\n         */\n        if (\n            productSKU !== prevProductSKU\n            && stateSKU === productSKU\n        ) {\n            this.updateHeaderState();\n        }\n\n        /**\n         * If the currently loaded category ID does not match the ID of\n         * category ID from URL rewrite, request category.\n         */\n        if (productSKU !== sku) {\n            this.requestProduct();\n        }\n\n        /**\n         * If product ID was changed => it is loaded => we need to\n         * update product specific information, i.e. breadcrumbs.\n         */\n        if (sku !== prevSku) {\n            this.updateBreadcrumbs();\n            this.updateHeaderState();\n            this.updateMeta();\n        }\n\n        /**\n         * LEGACY: needed to make sure required items are\n         * selected in the bundle product.\n         */\n        if (JSON.stringify(options) !== JSON.stringify(prevOptions)) {\n            this.getRequiredProductOptions(options);\n        }\n\n        /**\n         * LEGACY needed to make sure required options are\n         * selected in the customizable options product.\n         */\n        if (JSON.stringify(items) !== JSON.stringify(prevItems)) {\n            this.getRequiredProductOptions(items);\n        }\n\n        this._addToRecentlyViewedProducts();\n    }\n\n    isProductInformationTabEmpty() {\n        const dataSource = this.getDataSource();\n\n        return dataSource?.description?.html?.length === 0;\n    }\n\n    isProductAttributesTabEmpty() {\n        const dataSource = this.getDataSource();\n\n        return Object.keys(dataSource?.attributes || {}).length === 0;\n    }\n\n    _addToRecentlyViewedProducts() {\n        const {\n            product,\n            product: { sku },\n            addRecentlyViewedProduct,\n            store\n        } = this.props;\n\n        // necessary for skipping not loaded products\n        if (!sku) {\n            return;\n        }\n\n        // push into localstorage only preview of product (image, name and etc)\n        const {\n            canonical_url,\n            categories,\n            configurable_options,\n            description,\n            items,\n            meta_description,\n            meta_keyword,\n            meta_title,\n            options,\n            product_links,\n            reviews,\n            short_description,\n            variants,\n            ...productPreview\n        } = product;\n\n        addRecentlyViewedProduct(productPreview, store);\n    }\n\n    scrollTop() {\n        window.scrollTo(0, 0);\n    }\n\n    setOfflineNoticeSize = () => {\n        const { setBigOfflineNotice, productSKU } = this.props;\n        const { sku } = this.getDataSource();\n\n        /**\n         * If there is any information about the product, in example,\n         * we know it's URL-rewrite SKU is matching the product SKU -\n         * show the small offline notice, else - show larger one.\n         */\n        if (sku !== productSKU) {\n            setBigOfflineNotice(true);\n        } else {\n            setBigOfflineNotice(false);\n        }\n    };\n\n    getLink(key, value) {\n        const { location: { search, pathname } } = this.props;\n        const obj = {\n            ...convertQueryStringToKeyValuePairs(search)\n        };\n\n        if (key) {\n            obj[key] = value;\n        }\n\n        const query = objectToUri(obj);\n\n        return `${pathname}${query}`;\n    }\n\n    getRequiredProductOptions(options) {\n        const { productOptionsData } = this.state;\n\n        if (!options) {\n            return [];\n        }\n        const requiredOptions = options.reduce((acc, { option_id, required }) => {\n            if (required) {\n                acc.push(option_id);\n            }\n\n            return acc;\n        }, []);\n\n        return this.setState({\n            productOptionsData:\n                { ...productOptionsData, requiredOptions }\n        });\n    }\n\n    setLinkedDownloadablesPrice(price) {\n        this.setState({\n            selectedLinkPrice: price\n        });\n    }\n\n    setBundlePrice(prices) {\n        const { price = 0, priceExclTax = 0, finalPrice = 0 } = prices;\n        this.setState({\n            selectedInitialBundlePrice: price,\n            selectedBundlePrice: finalPrice,\n            selectedBundlePriceExclTax: priceExclTax\n        });\n    }\n\n    setLinkedDownloadables(links) {\n        const { productOptionsData } = this.state;\n        this.setState({\n            productOptionsData: {\n                ...productOptionsData, downloadableLinks: links\n            }\n        });\n    }\n\n    getSelectedCustomizableOptions(values, updateArray = false) {\n        const { productOptionsData } = this.state;\n\n        if (updateArray) {\n            this.setState({\n                productOptionsData:\n                    { ...productOptionsData, productOptionsMulti: values }\n            });\n        } else {\n            this.setState({\n                productOptionsData:\n                    { ...productOptionsData, productOptions: values }\n            });\n        }\n    }\n\n    getIsConfigurableParameterSelected(parameters, key, value) {\n        return Object.hasOwnProperty.call(parameters, key) && parameters[key] === value;\n    }\n\n    getNewParameters(key, value) {\n        const { parameters } = this.state;\n\n        // If value is already selected, than we remove the key to achieve deselection\n        if (this.getIsConfigurableParameterSelected(parameters, key, value)) {\n            const { [key]: oldValue, ...newParameters } = parameters;\n\n            return newParameters;\n        }\n\n        return {\n            ...parameters,\n            [key]: value.toString()\n        };\n    }\n\n    containerProps = () => ({\n        productOrVariant: this.getProductOrVariant(),\n        dataSource: this.getDataSource(),\n        areDetailsLoaded: this.getAreDetailsLoaded(),\n        isInformationTabEmpty: this.isProductInformationTabEmpty(),\n        isAttributesTabEmpty: this.isProductAttributesTabEmpty()\n    });\n\n    updateConfigurableVariant(key, value) {\n        const parameters = this.getNewParameters(key, value);\n        this.setState({ parameters });\n\n        this.updateUrl(key, value, parameters);\n        this.updateConfigurableVariantIndex(parameters);\n    }\n\n    updateUrl(key, value, parameters) {\n        const { location, history } = this.props;\n\n        const isParameterSelected = this.getIsConfigurableParameterSelected(parameters, key, value);\n\n        if (isParameterSelected) {\n            updateQueryParamWithoutHistory(key, value, history, location);\n        } else {\n            removeQueryParamWithoutHistory(key, history, location);\n        }\n    }\n\n    updateConfigurableVariantIndex(parameters) {\n        const { product: { variants, configurable_options } } = this.props;\n        const { configurableVariantIndex } = this.state;\n\n        const newIndex = Object.keys(parameters).length === Object.keys(configurable_options).length\n            ? getVariantIndex(variants, parameters)\n            // Not all parameters are selected yet, therefore variantIndex must be invalid\n            : -1;\n\n        if (configurableVariantIndex !== newIndex) {\n            this.setState({ configurableVariantIndex: newIndex });\n        }\n    }\n\n    getAreDetailsLoaded() {\n        const { product } = this.props;\n        const dataSource = this.getDataSource();\n        return dataSource === product;\n    }\n\n    getProductOrVariant() {\n        const dataSource = this.getDataSource();\n        const { variants } = dataSource;\n        const currentVariantIndex = this.getConfigurableVariantIndex(variants);\n        const variant = variants && variants[currentVariantIndex];\n\n        if (variants?.length > 0) {\n            dataSource.stock_status = variants.some((v) => v.stock_status === PRODUCT_IN_STOCK)\n                ? PRODUCT_IN_STOCK\n                : PRODUCT_OUT_OF_STOCK;\n        }\n\n        return variant || dataSource;\n    }\n\n    getConfigurableVariantIndex(variants) {\n        const { configurableVariantIndex, parameters } = this.state;\n        const hasParameters = !!Object.keys(parameters).length;\n\n        if (configurableVariantIndex >= 0) {\n            return configurableVariantIndex;\n        }\n\n        if (variants && hasParameters) {\n            return getVariantIndex(variants, parameters);\n        }\n\n        return -1;\n    }\n\n    getDataSource() {\n        const {\n            productSKU,\n            product\n        } = this.props;\n\n        const { sku } = product;\n        const { product: stateProduct } = history?.state?.state || {};\n        const { sku: stateSKU } = stateProduct || {};\n\n        /**\n         * If URL rewrite requested matches loaded product SKU\n         * assume it is a data-source.\n         */\n        if (productSKU === sku) {\n            return product;\n        }\n\n        /**\n         * If URL rewrite requested matches product SKU from\n         * history state - it is a data-source.\n         */\n        if (productSKU === stateSKU) {\n            return stateProduct;\n        }\n\n        /**\n         * Else there is no place to get a up-to-date\n         * information about the product from.\n         */\n        return {};\n    }\n\n    getProductRequestFilter() {\n        const { productSKU } = this.props;\n        return { productSKU };\n    }\n\n    requestProduct() {\n        const { requestProduct, productSKU } = this.props;\n        const { currentProductSKU } = this.state;\n\n        /**\n         * If URL rewrite was not passed - do not request the product.\n         */\n        if (!productSKU) {\n            return;\n        }\n\n        /**\n         * Skip loading the same product SKU the second time\n         */\n        if (currentProductSKU === productSKU) {\n            return;\n        }\n\n        this.setState({ currentProductSKU: productSKU });\n\n        const options = {\n            isSingleProduct: true,\n            args: { filter: this.getProductRequestFilter() }\n        };\n\n        requestProduct(options);\n    }\n\n    updateNavigationState() {\n        const { changeNavigationState } = this.props;\n        changeNavigationState({ name: MENU_TAB });\n    }\n\n    updateMeta() {\n        const { updateMetaFromProduct } = this.props;\n        updateMetaFromProduct(this.getDataSource());\n    }\n\n    updateHeaderState() {\n        const { name = '' } = this.getDataSource();\n        const { changeHeaderState } = this.props;\n\n        changeHeaderState({\n            name: PDP,\n            title: name,\n            onBackClick: () => history.back()\n        });\n    }\n\n    updateBreadcrumbs() {\n        const { updateBreadcrumbs, location } = this.props;\n        const { state: { prevCategoryId = null } = {} } = location;\n        updateBreadcrumbs(this.getDataSource(), prevCategoryId);\n    }\n\n    render() {\n        return (\n            <ProductPage\n              { ...this.props }\n              { ...this.state }\n              { ...this.containerFunctions }\n              { ...this.containerProps() }\n            />\n        );\n    }\n}\n\nexport default withRouter(\n    connect(mapStateToProps, mapDispatchToProps)(ProductPageContainer)\n);\n"]},"metadata":{},"sourceType":"module"}