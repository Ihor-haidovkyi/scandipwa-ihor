{"ast":null,"code":"import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/* eslint-disable react/require-render-return */ /**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import{connect}from'react-redux';import{DeviceType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Device\";import{isSignedIn}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Auth\";import{isScrollDisabled,toggleScroll}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Browser\";import history from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/History\";import{appendWithStoreCode}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Url\";import{DEFAULT_STATE_NAME}from\"./NavigationAbstract.config\";export var DEFAULT_STATE={name:DEFAULT_STATE_NAME};/** @namespace Component/NavigationAbstract/Container/mapStateToProps */export var mapStateToProps=middleware(function(state){return{device:state.ConfigReducer.device};},\"Component/NavigationAbstract/Container/mapStateToProps\");/** @namespace Component/NavigationAbstract/Container/mapDispatchToProps */ // eslint-disable-next-line no-unused-vars\nexport var mapDispatchToProps=middleware(function(dispatch){return{};},\"Component/NavigationAbstract/Container/mapDispatchToProps\");/** @namespace Component/NavigationAbstract/Container */export var _NavigationAbstractContainer=/*#__PURE__*/function(_Extensible){_inherits(_NavigationAbstractContainer,_Extensible);var _super=_createSuper(_NavigationAbstractContainer);function _NavigationAbstractContainer(){var _this;_classCallCheck(this,_NavigationAbstractContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.default_state=DEFAULT_STATE;_this.routeMap={'/':_this.default_state};_this.state={prevPathname:''};return _this;}_createClass(_NavigationAbstractContainer,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var setNavigationState=this.props.setNavigationState;setNavigationState(this.getNavigationState());history.listen(function(history){_this2.handlePageScroll();_this2.setState(_this2.onRouteChanged(history));});}},{key:\"onRouteChanged\",value:function onRouteChanged(history){var device=this.props.device;// check if token is expired and logout\nisSignedIn();if(!device.isMobile){return this.handleDesktopRouteChange(history);}return this.handleMobileUrlChange(history);}},{key:\"getNavigationState\",value:function getNavigationState(){var _location=location,pathname=_location.pathname;var activeRoute=Object.keys(this.routeMap).find(function(route){return(route!=='/'||pathname===appendWithStoreCode('/')||pathname==='/')&&pathname.includes(route);});return this.routeMap[activeRoute]||this.default_state;}},{key:\"goToDefaultHeaderState\",value:function goToDefaultHeaderState(){var setNavigationState=this.props.setNavigationState;var state=this.getNavigationState();setNavigationState(state);}},{key:\"handleMobileUrlChange\",value:function handleMobileUrlChange(history){var prevPathname=this.state.prevPathname;var pathname=history.pathname;if(prevPathname===pathname){return{};}return this.handleMobileRouteChange(history);}},{key:\"handleMobileRouteChange\",value:function handleMobileRouteChange(history){var _this$props=this.props,setNavigationState=_this$props.setNavigationState,name=_this$props.navigationState.name;var pathname=history.pathname;// Find the new state name\nvar newNavigationState=this.getNavigationState();// Update the state if new name is set\nif(name!==newNavigationState.name){setNavigationState(newNavigationState);}// hideActiveOverlay();\nreturn{prevPathname:pathname};}},{key:\"handleDesktopRouteChange\",value:function handleDesktopRouteChange(){var _this$props2=this.props,hideActiveOverlay=_this$props2.hideActiveOverlay,setNavigationState=_this$props2.setNavigationState;setNavigationState(this.routeMap['/']);hideActiveOverlay();return{};}},{key:\"handlePageScroll\",value:function handlePageScroll(){if(isScrollDisabled()){toggleScroll(true);}}},{key:\"render\",value:function render(){throw new Error('Please re-define a \"render\" method.');}}]);return _NavigationAbstractContainer;}(Extensible(PureComponent));Object.defineProperty(_NavigationAbstractContainer,'name',{value:'NavigationAbstractContainer'});export var NavigationAbstractContainer=middleware(_NavigationAbstractContainer,\"Component/NavigationAbstract/Container\");export default connect(mapStateToProps,mapDispatchToProps)(NavigationAbstractContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/NavigationAbstract/NavigationAbstract.container.js"],"names":["PureComponent","connect","DeviceType","isSignedIn","isScrollDisabled","toggleScroll","history","appendWithStoreCode","DEFAULT_STATE_NAME","DEFAULT_STATE","name","mapStateToProps","state","device","ConfigReducer","mapDispatchToProps","dispatch","NavigationAbstractContainer","default_state","routeMap","prevPathname","setNavigationState","props","getNavigationState","listen","handlePageScroll","setState","onRouteChanged","isMobile","handleDesktopRouteChange","handleMobileUrlChange","location","pathname","activeRoute","Object","keys","find","route","includes","handleMobileRouteChange","navigationState","newNavigationState","hideActiveOverlay","Error","defineProperty","_NavigationAbstractContainer","value"],"mappings":"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","sourcesContent":["/* eslint-disable react/require-render-return */\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { DeviceType } from 'Type/Device';\nimport { isSignedIn } from 'Util/Auth';\nimport { isScrollDisabled, toggleScroll } from 'Util/Browser';\nimport history from 'Util/History';\nimport { appendWithStoreCode } from 'Util/Url';\n\nimport { DEFAULT_STATE_NAME } from './NavigationAbstract.config';\n\nexport const DEFAULT_STATE = { name: DEFAULT_STATE_NAME };\n\n/** @namespace Component/NavigationAbstract/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    device: state.ConfigReducer.device\n});\n\n/** @namespace Component/NavigationAbstract/Container/mapDispatchToProps */\n// eslint-disable-next-line no-unused-vars\nexport const mapDispatchToProps = (dispatch) => ({});\n\n/** @namespace Component/NavigationAbstract/Container */\nexport class NavigationAbstractContainer extends PureComponent {\n    static propTypes = {\n        setNavigationState: PropTypes.func.isRequired,\n        hideActiveOverlay: PropTypes.func.isRequired,\n        // eslint-disable-next-line react/no-unused-prop-types\n        navigationState: PropTypes.object.isRequired,\n        device: DeviceType.isRequired\n    };\n\n    default_state = DEFAULT_STATE;\n\n    routeMap = {\n        '/': this.default_state\n    };\n\n    state = {\n        prevPathname: ''\n    };\n\n    componentDidMount() {\n        const { setNavigationState } = this.props;\n        setNavigationState(this.getNavigationState());\n        history.listen((history) => {\n            this.handlePageScroll();\n            this.setState(this.onRouteChanged(history));\n        });\n    }\n\n    onRouteChanged(history) {\n        const { device } = this.props;\n\n        // check if token is expired and logout\n        isSignedIn();\n\n        if (!device.isMobile) {\n            return this.handleDesktopRouteChange(history);\n        }\n\n        return this.handleMobileUrlChange(history);\n    }\n\n    getNavigationState() {\n        const { pathname } = location;\n\n        const activeRoute = Object.keys(this.routeMap)\n            .find((route) => (\n                route !== '/'\n                || pathname === appendWithStoreCode('/')\n                || pathname === '/'\n            ) && pathname.includes(route));\n\n        return this.routeMap[activeRoute] || this.default_state;\n    }\n\n    goToDefaultHeaderState() {\n        const { setNavigationState } = this.props;\n        const state = this.getNavigationState();\n\n        setNavigationState(state);\n    }\n\n    handleMobileUrlChange(history) {\n        const { prevPathname } = this.state;\n        const { pathname } = history;\n\n        if (prevPathname === pathname) {\n            return {};\n        }\n\n        return this.handleMobileRouteChange(history);\n    }\n\n    handleMobileRouteChange(history) {\n        const {\n            // hideActiveOverlay,\n            setNavigationState,\n            navigationState: { name }\n        } = this.props;\n\n        const { pathname } = history;\n\n        // Find the new state name\n        const newNavigationState = this.getNavigationState();\n\n        // Update the state if new name is set\n        if (name !== newNavigationState.name) {\n            setNavigationState(newNavigationState);\n        }\n\n        // hideActiveOverlay();\n\n        return { prevPathname: pathname };\n    }\n\n    handleDesktopRouteChange() {\n        const {\n            hideActiveOverlay,\n            setNavigationState\n        } = this.props;\n\n        setNavigationState(this.routeMap['/']);\n        hideActiveOverlay();\n\n        return {};\n    }\n\n    handlePageScroll() {\n        if (isScrollDisabled()) {\n            toggleScroll(true);\n        }\n    }\n\n    render() {\n        throw new Error('Please re-define a \"render\" method.');\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NavigationAbstractContainer);\n"]},"metadata":{},"sourceType":"module"}