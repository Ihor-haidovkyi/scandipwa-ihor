{"ast":null,"code":"import _objectSpread from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{toggleBreadcrumbs,updateBreadcrumbs}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Breadcrumbs/Breadcrumbs.action\";/**\n * Breadcrumbs Dispatcher\n * @class BreadcrumbsDispatcher\n * @namespace Store/Breadcrumbs/Dispatcher\n */export var _BreadcrumbsDispatcher=/*#__PURE__*/function(_Extensible){_inherits(_BreadcrumbsDispatcher,_Extensible);var _super=_createSuper(_BreadcrumbsDispatcher);function _BreadcrumbsDispatcher(){_classCallCheck(this,_BreadcrumbsDispatcher);return _super.apply(this,arguments);}_createClass(_BreadcrumbsDispatcher,[{key:\"update\",value:/**\n     * Set breadcrumbs\n     * @param {Array<Object>} breadcrumbs Breadcrumbs array\n     * @param {Function} dispatch\n     * @memberof BreadcrumbsDispatcher\n     */function update(breadcrumbs,dispatch){dispatch(toggleBreadcrumbs(true));dispatch(updateBreadcrumbs(breadcrumbs));}/**\n     * Set breadcrumbs for category\n     * @param {Array<Object>} category Category breadcumbs items\n     * @param {Function} dispatch\n     * @memberof BreadcrumbsDispatcher\n     */},{key:\"updateWithCategory\",value:function updateWithCategory(category,dispatch){var breadcrumbs=this._getCategoryBreadcrumbs(category);dispatch(toggleBreadcrumbs(true));dispatch(updateBreadcrumbs(breadcrumbs));}/**\n     * Set breadcrumbs for category\n     * @param product\n     * @param prevCategoryId\n     * @param {Function} dispatch\n     * @memberof BreadcrumbsDispatcher\n     */},{key:\"updateWithProduct\",value:function updateWithProduct(product,prevCategoryId,dispatch){var breadcrumbs=this._getProductBreadcrumbs(product,prevCategoryId);dispatch(toggleBreadcrumbs(true));dispatch(updateBreadcrumbs(breadcrumbs));}/**\n     * Set breadcrumbs for category\n     * @param {Array<Object>} category Category breadcumbs items\n     * @param {Function} dispatch\n     * @memberof BreadcrumbsDispatcher\n     */},{key:\"updateWithCmsPage\",value:function updateWithCmsPage(_ref,dispatch){var title=_ref.title;var breadcrumbs=title?[{url:'',name:title}]:[];dispatch(updateBreadcrumbs(breadcrumbs));}/**\n     * Get breadcrumbs for category\n     * @param {Object} category Category breadcumbs items\n     * @return {Array<Object>} Breadcrumbs array\n     * @memberof BreadcrumbsDispatcher\n     */},{key:\"_getCategoryBreadcrumbs\",value:function _getCategoryBreadcrumbs(category){var url=category.url,name=category.name,breadcrumbs=category.breadcrumbs;var breadcrumbsList=[];if(breadcrumbs){breadcrumbs.sort(function(a,b){return a.category_level-b.category_level;}).forEach(function(crumb){var category_url=crumb.category_url,category_name=crumb.category_name,category_is_active=crumb.category_is_active;// do not add link to inactive categories\nif(category_is_active){breadcrumbsList.push({name:category_name,url:{pathname:category_url,state:{category:true}}});}else{breadcrumbsList.push({url:'',name:category_name});}});}return[{url:url,name:name}].concat(_toConsumableArray(breadcrumbsList.reverse()));}},{key:\"findCategoryById\",value:function findCategoryById(categories,categoryId){return categories.find(function(_ref2){var id=_ref2.id;return id===categoryId;});}},{key:\"findLongestBreadcrumbs\",value:function findLongestBreadcrumbs(categories){var _categories$reduce=categories.reduce(function(acc,category){var longestBreadcrumbsLength=acc.longestBreadcrumbsLength;var breadcrumbs=category.breadcrumbs;var breadcrumbsLength=(breadcrumbs||[]).length;if(!breadcrumbsLength&&longestBreadcrumbsLength!==0){return acc;}if(longestBreadcrumbsLength===0){return _objectSpread(_objectSpread({},acc),{},{breadcrumbsCategory:category});}if(breadcrumbsLength<=longestBreadcrumbsLength){return acc;}return{breadcrumbsCategory:category,longestBreadcrumbsLength:breadcrumbsLength};},{breadcrumbsCategory:{},longestBreadcrumbsLength:0}),_categories$reduce$br=_categories$reduce.breadcrumbsCategory,breadcrumbsCategory=_categories$reduce$br===void 0?{}:_categories$reduce$br;return breadcrumbsCategory;}/**\n     * Get breadcrumbs for product\n     *\n     * @param {Object} product Product breadcumbs items\n     * @param prevCategoryId\n     * @return {Array<Object>} Breadcrumbs array\n     * @memberof BreadcrumbsDispatcher\n     */},{key:\"_getProductBreadcrumbs\",value:function _getProductBreadcrumbs(product){var prevCategoryId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var categories=product.categories,url=product.url,name=product.name;if(!categories||!categories.length){return[];}return[{url:url,name:name}].concat(_toConsumableArray(this._getCategoryBreadcrumbs(this.findCategoryById(categories,prevCategoryId)||this.findLongestBreadcrumbs(categories))));}}]);return _BreadcrumbsDispatcher;}(Extensible());Object.defineProperty(_BreadcrumbsDispatcher,'name',{value:'BreadcrumbsDispatcher'});export var BreadcrumbsDispatcher=middleware(_BreadcrumbsDispatcher,\"Store/Breadcrumbs/Dispatcher\");export default new BreadcrumbsDispatcher();","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/store/Breadcrumbs/Breadcrumbs.dispatcher.js"],"names":["toggleBreadcrumbs","updateBreadcrumbs","BreadcrumbsDispatcher","breadcrumbs","dispatch","category","_getCategoryBreadcrumbs","product","prevCategoryId","_getProductBreadcrumbs","title","url","name","breadcrumbsList","sort","a","b","category_level","forEach","crumb","category_url","category_name","category_is_active","push","pathname","state","reverse","categories","categoryId","find","id","reduce","acc","longestBreadcrumbsLength","breadcrumbsLength","length","breadcrumbsCategory","findCategoryById","findLongestBreadcrumbs","Object","defineProperty","_BreadcrumbsDispatcher","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport { toggleBreadcrumbs, updateBreadcrumbs } from 'Store/Breadcrumbs/Breadcrumbs.action';\n\n/**\n * Breadcrumbs Dispatcher\n * @class BreadcrumbsDispatcher\n * @namespace Store/Breadcrumbs/Dispatcher\n */\nexport class BreadcrumbsDispatcher {\n    /**\n     * Set breadcrumbs\n     * @param {Array<Object>} breadcrumbs Breadcrumbs array\n     * @param {Function} dispatch\n     * @memberof BreadcrumbsDispatcher\n     */\n    update(breadcrumbs, dispatch) {\n        dispatch(toggleBreadcrumbs(true));\n        dispatch(updateBreadcrumbs(breadcrumbs));\n    }\n\n    /**\n     * Set breadcrumbs for category\n     * @param {Array<Object>} category Category breadcumbs items\n     * @param {Function} dispatch\n     * @memberof BreadcrumbsDispatcher\n     */\n    updateWithCategory(category, dispatch) {\n        const breadcrumbs = this._getCategoryBreadcrumbs(category);\n        dispatch(toggleBreadcrumbs(true));\n        dispatch(updateBreadcrumbs(breadcrumbs));\n    }\n\n    /**\n     * Set breadcrumbs for category\n     * @param product\n     * @param prevCategoryId\n     * @param {Function} dispatch\n     * @memberof BreadcrumbsDispatcher\n     */\n    updateWithProduct(product, prevCategoryId, dispatch) {\n        const breadcrumbs = this._getProductBreadcrumbs(product, prevCategoryId);\n        dispatch(toggleBreadcrumbs(true));\n        dispatch(updateBreadcrumbs(breadcrumbs));\n    }\n\n    /**\n     * Set breadcrumbs for category\n     * @param {Array<Object>} category Category breadcumbs items\n     * @param {Function} dispatch\n     * @memberof BreadcrumbsDispatcher\n     */\n    updateWithCmsPage({ title }, dispatch) {\n        const breadcrumbs = title\n            ? [\n                {\n                    url: '',\n                    name: title\n                }\n            ]\n            : [];\n\n        dispatch(updateBreadcrumbs(breadcrumbs));\n    }\n\n    /**\n     * Get breadcrumbs for category\n     * @param {Object} category Category breadcumbs items\n     * @return {Array<Object>} Breadcrumbs array\n     * @memberof BreadcrumbsDispatcher\n     */\n    _getCategoryBreadcrumbs(category) {\n        const { url, name, breadcrumbs } = category;\n        const breadcrumbsList = [];\n\n        if (breadcrumbs) {\n            breadcrumbs\n                .sort((a, b) => a.category_level - b.category_level)\n                .forEach((crumb) => {\n                    const { category_url, category_name, category_is_active } = crumb;\n\n                    // do not add link to inactive categories\n                    if (category_is_active) {\n                        breadcrumbsList.push({\n                            name: category_name,\n                            url: {\n                                pathname: category_url,\n                                state: { category: true }\n                            }\n                        });\n                    } else {\n                        breadcrumbsList.push({\n                            url: '',\n                            name: category_name\n                        });\n                    }\n                });\n        }\n\n        return [\n            { url, name },\n            ...breadcrumbsList.reverse()\n        ];\n    }\n\n    findCategoryById(categories, categoryId) {\n        return categories.find(({ id }) => id === categoryId);\n    }\n\n    findLongestBreadcrumbs(categories) {\n        const { breadcrumbsCategory = {} } = categories.reduce((acc, category) => {\n            const { longestBreadcrumbsLength } = acc;\n            const { breadcrumbs } = category;\n            const breadcrumbsLength = (breadcrumbs || []).length;\n\n            if (!breadcrumbsLength && longestBreadcrumbsLength !== 0) {\n                return acc;\n            }\n\n            if (longestBreadcrumbsLength === 0) {\n                return { ...acc, breadcrumbsCategory: category };\n            }\n\n            if (breadcrumbsLength <= longestBreadcrumbsLength) {\n                return acc;\n            }\n\n            return {\n                breadcrumbsCategory: category,\n                longestBreadcrumbsLength: breadcrumbsLength\n            };\n        }, {\n            breadcrumbsCategory: {},\n            longestBreadcrumbsLength: 0\n        });\n\n        return breadcrumbsCategory;\n    }\n\n    /**\n     * Get breadcrumbs for product\n     *\n     * @param {Object} product Product breadcumbs items\n     * @param prevCategoryId\n     * @return {Array<Object>} Breadcrumbs array\n     * @memberof BreadcrumbsDispatcher\n     */\n    _getProductBreadcrumbs(product, prevCategoryId = null) {\n        const { categories, url, name } = product;\n\n        if (!categories || !categories.length) {\n            return [];\n        }\n\n        return [\n            { url, name },\n            ...this._getCategoryBreadcrumbs(\n                this.findCategoryById(categories, prevCategoryId)\n                || this.findLongestBreadcrumbs(categories)\n            )\n        ];\n    }\n}\n\nexport default new BreadcrumbsDispatcher();\n"]},"metadata":{},"sourceType":"module"}