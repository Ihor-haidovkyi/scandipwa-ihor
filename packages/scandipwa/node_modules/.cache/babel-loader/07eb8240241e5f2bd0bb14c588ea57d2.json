{"ast":null,"code":"import _toConsumableArray from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */ /* eslint-disable no-param-reassign */export var TYPE_CUSTOM_URL=0;export var TYPE_CMS_PAGE=1;export var TYPE_CATEGORY=2;/**\n * Given an array of menu items, returns a copy of the array, sorted by their parent ID, then by their sort order (position)\n *\n * @param unsortedItems an array of items to be sorted\n * @returns {array} the sorted array\n * @namespace Util/Menu/getSortedItems\n */export var getSortedItems=middleware(function(unsortedItems){return Array.from(unsortedItems).sort(function(_ref,_ref2){var PID=_ref.parent_id,P=_ref.position;var prevPID=_ref2.parent_id,prevP=_ref2.position;return PID-prevPID||P-prevP;});},\"Util/Menu/getSortedItems\\n\");/** @namespace Util/Menu */ // eslint-disable-next-line @scandipwa/scandipwa-guidelines/derived-class-names\nexport var _Menu=/*#__PURE__*/function(_Extensible){_inherits(_Menu,_Extensible);var _super=_createSuper(_Menu);function _Menu(){_classCallCheck(this,_Menu);return _super.apply(this,arguments);}_createClass(_Menu,[{key:\"getMenuUrl\",value:function getMenuUrl(_ref3){var url=_ref3.url,url_type=_ref3.url_type,category_id=_ref3.category_id;switch(url_type){case TYPE_CATEGORY:return{pathname:url,search:'',state:{category:category_id}};case TYPE_CMS_PAGE:return{pathname:url,search:'',state:{page:true}};default:return url;}}},{key:\"getMenuData\",value:function getMenuData(_ref4){var cms_page_identifier=_ref4.cms_page_identifier,url=_ref4.url,url_type=_ref4.url_type,category_id=_ref4.category_id,item=_objectWithoutProperties(_ref4,[\"cms_page_identifier\",\"url\",\"url_type\",\"category_id\"]);return _objectSpread(_objectSpread({},item),{},{url:this.getMenuUrl({url:url,url_type:url_type,category_id:category_id}),children:{}});}},{key:\"setToValue\",value:function setToValue(obj,path,value){// eslint-disable-next-line fp/no-let\nvar i;path=path.split('.');// eslint-disable-next-line fp/no-loops\nfor(i=0;i<path.length-1;i++){obj=obj[path[i]];}obj[path[i]]=value;}},{key:\"createItem\",value:function createItem(data){var parent_id=data.parent_id,item_id=data.item_id;if(parent_id===0){this.menuPositionReference[item_id]=[];this.menu[item_id]=this.getMenuData(data);}else if(this.menuPositionReference[parent_id]!==undefined){this.menuPositionReference[item_id]=[].concat(_toConsumableArray(this.menuPositionReference[parent_id]),[parent_id]);this.setToValue(this.menu,\"\".concat(this.menuPositionReference[item_id].join('.children.'),\".children.\").concat(item_id),this.getMenuData(data));}}},{key:\"reduce\",value:function reduce(_ref5){var _this=this;var unsortedItems=_ref5.items;this.menu={};this.menuPositionReference={};getSortedItems(unsortedItems).forEach(function(realMenuItem){_this.createItem(realMenuItem);});return this.menu;}}]);return _Menu;}(Extensible());Object.defineProperty(_Menu,'name',{value:'Menu'});export var Menu=middleware(_Menu,\"Util/Menu\");export default new Menu();","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/util/Menu/Menu.js"],"names":["TYPE_CUSTOM_URL","TYPE_CMS_PAGE","TYPE_CATEGORY","getSortedItems","unsortedItems","Array","from","sort","PID","parent_id","P","position","prevPID","prevP","Menu","url","url_type","category_id","pathname","search","state","category","page","cms_page_identifier","item","getMenuUrl","children","obj","path","value","i","split","length","data","item_id","menuPositionReference","menu","getMenuData","undefined","setToValue","join","items","forEach","realMenuItem","createItem","Object","defineProperty","_Menu"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\n/* eslint-disable no-param-reassign */\n\nexport const TYPE_CUSTOM_URL = 0;\nexport const TYPE_CMS_PAGE = 1;\nexport const TYPE_CATEGORY = 2;\n\n/**\n * Given an array of menu items, returns a copy of the array, sorted by their parent ID, then by their sort order (position)\n *\n * @param unsortedItems an array of items to be sorted\n * @returns {array} the sorted array\n * @namespace Util/Menu/getSortedItems\n */\nexport const getSortedItems = (unsortedItems) => Array.from(unsortedItems).sort((\n    { parent_id: PID, position: P },\n    { parent_id: prevPID, position: prevP }\n) => (PID - prevPID) || (P - prevP));\n\n/** @namespace Util/Menu */\n// eslint-disable-next-line @scandipwa/scandipwa-guidelines/derived-class-names\nexport class Menu {\n    getMenuUrl({ url, url_type, category_id }) {\n        switch (url_type) {\n        case TYPE_CATEGORY:\n            return {\n                pathname: url,\n                search: '',\n                state: { category: category_id }\n            };\n        case TYPE_CMS_PAGE:\n            return {\n                pathname: url,\n                search: '',\n                state: { page: true }\n            };\n        default:\n            return url;\n        }\n    }\n\n    getMenuData({\n        cms_page_identifier,\n        url,\n        url_type,\n        category_id,\n        ...item\n    }) {\n        return {\n            ...item,\n            url: this.getMenuUrl({ url, url_type, category_id }),\n            children: {}\n        };\n    }\n\n    setToValue(obj, path, value) {\n        // eslint-disable-next-line fp/no-let\n        let i;\n        path = path.split('.');\n        // eslint-disable-next-line fp/no-loops\n        for (i = 0; i < path.length - 1; i++) {\n            obj = obj[path[i]];\n        }\n        obj[path[i]] = value;\n    }\n\n    createItem(data) {\n        const { parent_id, item_id } = data;\n\n        if (parent_id === 0) {\n            this.menuPositionReference[item_id] = [];\n            this.menu[item_id] = this.getMenuData(data);\n        } else if (this.menuPositionReference[parent_id] !== undefined) {\n            this.menuPositionReference[item_id] = [\n                ...this.menuPositionReference[parent_id],\n                parent_id\n            ];\n\n            this.setToValue(\n                this.menu,\n                `${this.menuPositionReference[item_id].join('.children.')}.children.${item_id}`,\n                this.getMenuData(data)\n            );\n        }\n    }\n\n    reduce({ items: unsortedItems }) {\n        this.menu = {};\n        this.menuPositionReference = {};\n\n        getSortedItems(unsortedItems).forEach((realMenuItem) => {\n            this.createItem(realMenuItem);\n        });\n\n        return this.menu;\n    }\n}\n\nexport default new Menu();\n"]},"metadata":{},"sourceType":"module"}