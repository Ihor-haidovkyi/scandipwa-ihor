{"ast":null,"code":"import _objectSpread from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _slicedToArray from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import PropTypes from'prop-types';import ExpandableContent from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ExpandableContent\";import ExpandableContentShowMore from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ExpandableContentShowMore\";import ProductAttributeValue from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ProductAttributeValue/ProductAttributeValue.component\";// eslint-disable-next-line max-len\nimport ProductConfigurableAttributes from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ProductConfigurableAttributes/ProductConfigurableAttributes.component\";import{CategoryFragment}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Category\";import{formatPrice}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Price\";import{sortBySortOrder}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Product\";/** @namespace Component/CategoryConfigurableAttributes/Component */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _CategoryConfigurableAttributes=/*#__PURE__*/function(_Extensible){_inherits(_CategoryConfigurableAttributes,_Extensible);var _super=_createSuper(_CategoryConfigurableAttributes);function _CategoryConfigurableAttributes(){var _this;_classCallCheck(this,_CategoryConfigurableAttributes);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.renderConfigurableOption=function(option){var attribute_code=option.attribute_code;switch(attribute_code){case'price':return _this.renderPriceSwatch(option);case'category_id':return _this.renderSubCategories(option);default:return _this.renderDropdownOrSwatch(option);}};return _this;}_createClass(_CategoryConfigurableAttributes,[{key:\"renderSubCategories\",value:function renderSubCategories(option){var getSubCategories=this.props.getSubCategories;var optionWithSubcategories=getSubCategories(option);var _optionWithSubcategor=optionWithSubcategories.attribute_values,attribute_values=_optionWithSubcategor===void 0?[]:_optionWithSubcategor;if(!attribute_values.length){return null;}return this.renderDropdownOrSwatch(optionWithSubcategories);}},{key:\"getPriceLabel\",value:function getPriceLabel(option){var currency_code=this.props.currency_code;var label=option.label;var _label$split=label.split('~'),_label$split2=_slicedToArray(_label$split,2),from=_label$split2[0],to=_label$split2[1];var priceFrom=formatPrice(from,currency_code);var priceTo=formatPrice(to,currency_code);if(from==='*'){return __('Up to %s',priceTo);}if(to==='*'){return __('From %s',priceFrom);}return __('From %s, to %s',priceFrom,priceTo);}},{key:\"renderPriceSwatch\",value:function renderPriceSwatch(option){var _this2=this;var attribute_options=option.attribute_options,priceOption=_objectWithoutProperties(option,[\"attribute_options\"]);if(attribute_options){// do not render price filter if it includes \"*_*\" aggregation\nif(attribute_options['*_*']){return null;}priceOption.attribute_options=Object.entries(attribute_options).reduce(function(acc,_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],option=_ref2[1];acc[key]=_objectSpread(_objectSpread({},option),{},{label:_this2.getPriceLabel(option)});return acc;},{});}return this.renderDropdownOrSwatch(priceOption);}},{key:\"renderDropdownOrSwatch\",value:function renderDropdownOrSwatch(option){var _this$props=this.props,isContentExpanded=_this$props.isContentExpanded,getSubHeading=_this$props.getSubHeading;var attribute_label=option.attribute_label,attribute_code=option.attribute_code,attribute_options=option.attribute_options;var _ref3=attribute_options?Object.values(attribute_options):[{}],_ref4=_slicedToArray(_ref3,1),swatch_data=_ref4[0].swatch_data;var isSwatch=!!swatch_data;return/*#__PURE__*/_checkBEM(React,ExpandableContent,{key:attribute_code,heading:attribute_label,subHeading:getSubHeading(option),mix:{block:'ProductConfigurableAttributes',elem:'Expandable'},isContentExpanded:isContentExpanded},isSwatch?this.renderSwatch(option):this.renderDropdown(option));}},{key:\"renderConfigurableAttributeValue\",value:function renderConfigurableAttributeValue(attribute){var _this$props2=this.props,getIsConfigurableAttributeAvailable=_this$props2.getIsConfigurableAttributeAvailable,handleOptionClick=_this$props2.handleOptionClick,getLink=_this$props2.getLink,isSelected=_this$props2.isSelected,show_product_count=_this$props2.show_product_count;var attribute_value=attribute.attribute_value;return/*#__PURE__*/_checkBEM(React,ProductAttributeValue,{key:attribute_value,attribute:attribute,isSelected:isSelected(attribute),isAvailable:getIsConfigurableAttributeAvailable(attribute),onClick:handleOptionClick,getLink:getLink,isProductCountVisible:show_product_count});}},{key:\"renderConfigurableAttributes\",value:function renderConfigurableAttributes(){var configurable_options=this.props.configurable_options;return sortBySortOrder(Object.values(configurable_options),'attribute_position').map(this.renderConfigurableOption);}},{key:\"renderDropdown\",value:function renderDropdown(option){var _this3=this;var attribute_values=option.attribute_values;return/*#__PURE__*/_checkBEM(React,\"div\",{block:\"ProductConfigurableAttributes\",elem:\"DropDownList\"},/*#__PURE__*/_checkBEM(React,ExpandableContentShowMore,null,attribute_values.map(function(attribute_value){return _this3.renderConfigurableAttributeValue(_objectSpread(_objectSpread({},option),{},{attribute_value:attribute_value}));})));}}]);return _CategoryConfigurableAttributes;}(Extensible(ProductConfigurableAttributes));_CategoryConfigurableAttributes.propTypes=_objectSpread(_objectSpread({},ProductConfigurableAttributes.propTypes),{},{currency_code:PropTypes.string.isRequired,show_product_count:PropTypes.bool.isRequired,childrenCategories:PropTypes.arrayOf(PropTypes.shape(CategoryFragment)).isRequired,getSubCategories:PropTypes.func.isRequired});Object.defineProperty(_CategoryConfigurableAttributes,'name',{value:'CategoryConfigurableAttributes'});export var CategoryConfigurableAttributes=middleware(_CategoryConfigurableAttributes,\"Component/CategoryConfigurableAttributes/Component\");export default CategoryConfigurableAttributes;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/CategoryConfigurableAttributes/CategoryConfigurableAttributes.component.js"],"names":["PropTypes","ExpandableContent","ExpandableContentShowMore","ProductAttributeValue","ProductConfigurableAttributes","CategoryFragment","formatPrice","sortBySortOrder","CategoryConfigurableAttributes","renderConfigurableOption","option","attribute_code","renderPriceSwatch","renderSubCategories","renderDropdownOrSwatch","getSubCategories","props","optionWithSubcategories","attribute_values","length","currency_code","label","split","from","to","priceFrom","priceTo","__","attribute_options","priceOption","Object","entries","reduce","acc","key","getPriceLabel","isContentExpanded","getSubHeading","attribute_label","values","swatch_data","isSwatch","block","elem","renderSwatch","renderDropdown","attribute","getIsConfigurableAttributeAvailable","handleOptionClick","getLink","isSelected","show_product_count","attribute_value","configurable_options","map","renderConfigurableAttributeValue","propTypes","string","isRequired","bool","childrenCategories","arrayOf","shape","func","defineProperty","_CategoryConfigurableAttributes","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\n\nimport ExpandableContent from 'Component/ExpandableContent';\nimport ExpandableContentShowMore from 'Component/ExpandableContentShowMore';\nimport ProductAttributeValue from 'Component/ProductAttributeValue/ProductAttributeValue.component';\n// eslint-disable-next-line max-len\nimport ProductConfigurableAttributes from 'Component/ProductConfigurableAttributes/ProductConfigurableAttributes.component';\nimport { CategoryFragment } from 'Type/Category';\nimport { formatPrice } from 'Util/Price';\nimport { sortBySortOrder } from 'Util/Product';\n\n/** @namespace Component/CategoryConfigurableAttributes/Component */\nexport class CategoryConfigurableAttributes extends ProductConfigurableAttributes {\n    static propTypes = {\n        ...ProductConfigurableAttributes.propTypes,\n        currency_code: PropTypes.string.isRequired,\n        show_product_count: PropTypes.bool.isRequired,\n        childrenCategories: PropTypes.arrayOf(PropTypes.shape(CategoryFragment)).isRequired,\n        getSubCategories: PropTypes.func.isRequired\n    };\n\n    renderSubCategories(option) {\n        const { getSubCategories } = this.props;\n\n        const optionWithSubcategories = getSubCategories(option);\n        const { attribute_values = [] } = optionWithSubcategories;\n\n        if (!attribute_values.length) {\n            return null;\n        }\n\n        return this.renderDropdownOrSwatch(optionWithSubcategories);\n    }\n\n    getPriceLabel(option) {\n        const { currency_code } = this.props;\n        const { label } = option;\n        const [from, to] = label.split('~');\n        const priceFrom = formatPrice(from, currency_code);\n        const priceTo = formatPrice(to, currency_code);\n\n        if (from === '*') {\n            return __('Up to %s', priceTo);\n        }\n\n        if (to === '*') {\n            return __('From %s', priceFrom);\n        }\n\n        return __('From %s, to %s', priceFrom, priceTo);\n    }\n\n    renderPriceSwatch(option) {\n        const { attribute_options, ...priceOption } = option;\n\n        if (attribute_options) {\n            // do not render price filter if it includes \"*_*\" aggregation\n            if (attribute_options['*_*']) {\n                return null;\n            }\n\n            priceOption.attribute_options = Object.entries(attribute_options).reduce((acc, [key, option]) => {\n                acc[key] = {\n                    ...option,\n                    label: this.getPriceLabel(option)\n                };\n\n                return acc;\n            }, {});\n        }\n\n        return this.renderDropdownOrSwatch(priceOption);\n    }\n\n    renderDropdownOrSwatch(option) {\n        const {\n            isContentExpanded,\n            getSubHeading\n        } = this.props;\n\n        const {\n            attribute_label,\n            attribute_code,\n            attribute_options\n        } = option;\n\n        const [{ swatch_data }] = attribute_options ? Object.values(attribute_options) : [{}];\n        const isSwatch = !!swatch_data;\n\n        return (\n            <ExpandableContent\n              key={ attribute_code }\n              heading={ attribute_label }\n              subHeading={ getSubHeading(option) }\n              mix={ {\n                  block: 'ProductConfigurableAttributes',\n                  elem: 'Expandable'\n              } }\n              isContentExpanded={ isContentExpanded }\n            >\n                { isSwatch ? this.renderSwatch(option) : this.renderDropdown(option) }\n            </ExpandableContent>\n        );\n    }\n\n    renderConfigurableAttributeValue(attribute) {\n        const {\n            getIsConfigurableAttributeAvailable,\n            handleOptionClick,\n            getLink,\n            isSelected,\n            show_product_count\n        } = this.props;\n\n        const { attribute_value } = attribute;\n\n        return (\n            <ProductAttributeValue\n              key={ attribute_value }\n              attribute={ attribute }\n              isSelected={ isSelected(attribute) }\n              isAvailable={ getIsConfigurableAttributeAvailable(attribute) }\n              onClick={ handleOptionClick }\n              getLink={ getLink }\n              isProductCountVisible={ show_product_count }\n            />\n        );\n    }\n\n    renderConfigurableOption = (option) => {\n        const { attribute_code } = option;\n\n        switch (attribute_code) {\n        case 'price':\n            return this.renderPriceSwatch(option);\n        case 'category_id':\n            return this.renderSubCategories(option);\n        default:\n            return this.renderDropdownOrSwatch(option);\n        }\n    };\n\n    renderConfigurableAttributes() {\n        const { configurable_options } = this.props;\n\n        return sortBySortOrder(Object.values(configurable_options), 'attribute_position')\n            .map(this.renderConfigurableOption);\n    }\n\n    renderDropdown(option) {\n        const { attribute_values } = option;\n\n        return (\n            <div\n              block=\"ProductConfigurableAttributes\"\n              elem=\"DropDownList\"\n            >\n                <ExpandableContentShowMore>\n                    { attribute_values.map((attribute_value) => (\n                        this.renderConfigurableAttributeValue({ ...option, attribute_value })\n                    )) }\n                </ExpandableContentShowMore>\n            </div>\n        );\n    }\n}\n\nexport default CategoryConfigurableAttributes;\n"]},"metadata":{},"sourceType":"module"}