{"ast":null,"code":"import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _get from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";import _getPrototypeOf from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{createRef,PureComponent}from'react';import{ChildrenType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Common\";import\"./ExpandableContentShowMore.style\";/** @namespace Component/ExpandableContentShowMore/Component */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _ExpandableContentShowMore=/*#__PURE__*/function(_Extensible){_inherits(_ExpandableContentShowMore,_Extensible);var _super=_createSuper(_ExpandableContentShowMore);function _ExpandableContentShowMore(){var _this;_classCallCheck(this,_ExpandableContentShowMore);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.handleShowAllButtonClick=function(){var isExpanding=_this.state.isExpanding;if(!isExpanding){_this.setState(function(_ref){var isOpen=_ref.isOpen;return{isOpen:!isOpen,isExpanding:true};});}};return _this;}_createClass(_ExpandableContentShowMore,[{key:\"__construct\",value:function __construct(props){_get(_getPrototypeOf(_ExpandableContentShowMore.prototype),\"__construct\",this).call(this,props);this.ref=/*#__PURE__*/createRef();var _this$props=this.props,showElemCount=_this$props.showElemCount,length=_this$props.children.length;this.expandableRef=/*#__PURE__*/createRef();this.state={isOpen:length>showElemCount,isExpanding:false};}},{key:\"componentDidMount\",value:function componentDidMount(){var isOpen=this.state.isOpen;if(isOpen){this.setState({isOpen:false});}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var _this2=this;var isExpanding=this.state.isExpanding;if(isExpanding){var ONE_SECOND_IN_MS=1000;var transitionDurationCSStoMS=window.getComputedStyle(this.expandableRef.current).getPropertyValue('transition-duration').slice(0,-1)*ONE_SECOND_IN_MS;setTimeout(function(){return _this2.setState({isExpanding:false});},transitionDurationCSStoMS);}var length=this.props.children.length;var prevLength=prevProps.children.length;if(length!==prevLength){this.getExpandableContentHeight();}}},{key:\"getExpandableContentHeight\",value:function getExpandableContentHeight(){var _this3=this;var isOpen=this.state.isOpen;var _this$props2=this.props,showElemCount=_this$props2.showElemCount,length=_this$props2.children.length;if(isOpen&&length<=showElemCount){this.setState({isOpen:false});return;}this.setState({isOpen:true},function(){_this3.setState({isOpen:false});});}},{key:\"renderShowAllButton\",value:function renderShowAllButton(){var _this$props3=this.props,showElemCount=_this$props3.showElemCount,length=_this$props3.children.length;if(length<=showElemCount){return null;}var isOpen=this.state.isOpen;var mods=isOpen?{state:'isOpen'}:{};return/*#__PURE__*/_checkBEM(React,\"button\",{onClick:this.handleShowAllButtonClick,mix:{block:'Button',mods:{likeLink:true}},block:\"ExpandableContentShowMore\",elem:\"ShowAllButton\",mods:mods},isOpen?__('Show less'):__('Show more'));}},{key:\"renderExpandableChildren\",value:function renderExpandableChildren(){var _this$state=this.state,isOpen=_this$state.isOpen,isExpanding=_this$state.isExpanding;var _this$props4=this.props,children=_this$props4.children,showElemCount=_this$props4.showElemCount;var child=isOpen||isExpanding?children.slice(showElemCount):null;return/*#__PURE__*/_checkBEM(React,\"div\",{ref:this.expandableRef,block:\"ExpandableContentShowMore\",elem:\"ExpandableChildren\"},child);}},{key:\"renderContent\",value:function renderContent(){var _this$props5=this.props,children=_this$props5.children,showElemCount=_this$props5.showElemCount;var child=children.slice(0,showElemCount);return/*#__PURE__*/_checkBEM(React,React.Fragment,null,child,this.renderExpandableChildren(),this.renderShowAllButton());}},{key:\"render\",value:function render(){var _this$props6=this.props,children=_this$props6.children,isMobile=_this$props6.isMobile;if(isMobile){return children;}return/*#__PURE__*/_checkBEM(React,\"div\",{block:\"ExpandableContentShowMore\",ref:this.ref},this.renderContent());}}]);return _ExpandableContentShowMore;}(Extensible(PureComponent));_ExpandableContentShowMore.defaultProps={showElemCount:3};Object.defineProperty(_ExpandableContentShowMore,'name',{value:'ExpandableContentShowMore'});export var ExpandableContentShowMore=middleware(_ExpandableContentShowMore,\"Component/ExpandableContentShowMore/Component\");export default ExpandableContentShowMore;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/ExpandableContentShowMore/ExpandableContentShowMore.component.js"],"names":["createRef","PureComponent","ChildrenType","ExpandableContentShowMore","handleShowAllButtonClick","isExpanding","state","setState","isOpen","props","ref","showElemCount","length","children","expandableRef","prevProps","ONE_SECOND_IN_MS","transitionDurationCSStoMS","window","getComputedStyle","current","getPropertyValue","slice","setTimeout","prevLength","getExpandableContentHeight","mods","block","likeLink","__","child","renderExpandableChildren","renderShowAllButton","isMobile","renderContent","defaultProps","Object","defineProperty","_ExpandableContentShowMore","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { createRef, PureComponent } from 'react';\n\nimport { ChildrenType } from 'Type/Common';\n\nimport './ExpandableContentShowMore.style';\n\n/** @namespace Component/ExpandableContentShowMore/Component */\nexport class ExpandableContentShowMore extends PureComponent {\n    static propTypes = {\n        showElemCount: PropTypes.number,\n        children: ChildrenType.isRequired,\n        isMobile: PropTypes.bool.isRequired\n    };\n\n    static defaultProps = {\n        showElemCount: 3\n    };\n\n    __construct(props) {\n        super.__construct(props);\n\n        this.ref = createRef();\n\n        const { showElemCount, children: { length } } = this.props;\n\n        this.expandableRef = createRef();\n\n        this.state = {\n            isOpen: length > showElemCount,\n            isExpanding: false\n        };\n    }\n\n    componentDidMount() {\n        const { isOpen } = this.state;\n\n        if (isOpen) {\n            this.setState({ isOpen: false });\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        const { isExpanding } = this.state;\n\n        if (isExpanding) {\n            const ONE_SECOND_IN_MS = 1000;\n            const transitionDurationCSStoMS = window\n                .getComputedStyle(this.expandableRef.current)\n                .getPropertyValue('transition-duration')\n                .slice(0, -1) * ONE_SECOND_IN_MS;\n\n            setTimeout(() => this.setState({ isExpanding: false }),\n                transitionDurationCSStoMS);\n        }\n\n        const { children: { length } } = this.props;\n        const { children: { length: prevLength } } = prevProps;\n\n        if (length !== prevLength) {\n            this.getExpandableContentHeight();\n        }\n    }\n\n    getExpandableContentHeight() {\n        const { isOpen } = this.state;\n        const { showElemCount, children: { length } } = this.props;\n\n        if (isOpen && length <= showElemCount) {\n            this.setState({ isOpen: false });\n            return;\n        }\n\n        this.setState({ isOpen: true }, () => {\n            this.setState({ isOpen: false });\n        });\n    }\n\n    handleShowAllButtonClick = () => {\n        const { isExpanding } = this.state;\n\n        if (!isExpanding) {\n            this.setState(({ isOpen }) => ({ isOpen: !isOpen, isExpanding: true }));\n        }\n    };\n\n    renderShowAllButton() {\n        const { showElemCount, children: { length } } = this.props;\n\n        if (length <= showElemCount) {\n            return null;\n        }\n\n        const { isOpen } = this.state;\n\n        const mods = isOpen ? { state: 'isOpen' } : {};\n\n        return (\n            <button\n              onClick={ this.handleShowAllButtonClick }\n              mix={ { block: 'Button', mods: { likeLink: true } } }\n              block=\"ExpandableContentShowMore\"\n              elem=\"ShowAllButton\"\n              mods={ mods }\n            >\n                { isOpen ? __('Show less') : __('Show more') }\n            </button>\n        );\n    }\n\n    renderExpandableChildren() {\n        const { isOpen, isExpanding } = this.state;\n        const { children, showElemCount } = this.props;\n\n        const child = (isOpen || isExpanding) ? children.slice(showElemCount) : null;\n\n        return (\n            <div\n              ref={ this.expandableRef }\n              block=\"ExpandableContentShowMore\"\n              elem=\"ExpandableChildren\"\n            >\n                { child }\n            </div>\n        );\n    }\n\n    renderContent() {\n        const { children, showElemCount } = this.props;\n\n        const child = children.slice(0, showElemCount);\n\n        return (\n            <>\n                { child }\n                { this.renderExpandableChildren() }\n                { this.renderShowAllButton() }\n            </>\n        );\n    }\n\n    render() {\n        const { children, isMobile } = this.props;\n\n        if (isMobile) {\n            return children;\n        }\n\n        return (\n            <div block=\"ExpandableContentShowMore\" ref={ this.ref }>\n                { this.renderContent() }\n            </div>\n        );\n    }\n}\nexport default ExpandableContentShowMore;\n"]},"metadata":{},"sourceType":"module"}