{"ast":null,"code":"import _toConsumableArray from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import{connect}from'react-redux';import ProductDownloadableLinks from\"./ProductDownloadableLinks.component\";/** @namespace Component/ProductDownloadableLinks/Container/mapStateToProps */export var mapStateToProps=middleware(function(state){return{isOpenInNewTab:state.ConfigReducer.downloadable_links_target_new_window};},\"Component/ProductDownloadableLinks/Container/mapStateToProps\");/** @namespace Component/ProductDownloadableLinks/Container/mapDispatchToProps */ // eslint-disable-next-line no-unused-vars\nexport var mapDispatchToProps=middleware(function(dispatch){return{};},\"Component/ProductDownloadableLinks/Container/mapDispatchToProps\");/** @namespace Component/ProductDownloadableLinks/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _ProductDownloadableLinksContainer=/*#__PURE__*/function(_Extensible){_inherits(_ProductDownloadableLinksContainer,_Extensible);var _super=_createSuper(_ProductDownloadableLinksContainer);function _ProductDownloadableLinksContainer(){var _this;_classCallCheck(this,_ProductDownloadableLinksContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={isLoading:true,selectedLinks:[]};_this.containerFunctions={setSelectedCheckboxValues:_this.setSelectedCheckboxValues.bind(_assertThisInitialized(_this))};return _this;}_createClass(_ProductDownloadableLinksContainer,[{key:\"componentDidMount\",value:function componentDidMount(){var links=this.props.links;if(links){this.stopLoading();}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(_,prevState){var links=this.props.links;var _this$state=this.state,selectedLinks=_this$state.selectedLinks,isLoading=_this$state.isLoading;var prevSelectedLinks=prevState.selectedLinks;if(links&&isLoading){this.stopLoading();}if(selectedLinks!==prevSelectedLinks){this.updateSelectedOptionsArray();}}},{key:\"stopLoading\",value:function stopLoading(){this.setState({isLoading:false});}},{key:\"updateSelectedOptionsArray\",value:function updateSelectedOptionsArray(){var _this$props=this.props,setLinkedDownloadables=_this$props.setLinkedDownloadables,setLinkedDownloadablesPrice=_this$props.setLinkedDownloadablesPrice;var selectedLinks=this.state.selectedLinks;setLinkedDownloadables(selectedLinks);var price=this.getTotalPrice();setLinkedDownloadablesPrice(price);}},{key:\"getTotalPrice\",value:function getTotalPrice(){var selectedLinks=this.state.selectedLinks;var links=this.props.links;return selectedLinks.reduce(function(base,_ref){var link_id=_ref.link_id;var link=links.find(function(_ref2){var id=_ref2.id;return id===link_id;});return base+link.price;},0);}},{key:\"setSelectedCheckboxValues\",value:function setSelectedCheckboxValues(option_id,option_value){var selectedLinks=this.state.selectedLinks;var optionIdInt=parseInt(option_id,10);if(option_value){if(selectedLinks.some(function(_ref3){var id=_ref3.link_id;return optionIdInt===id;})){return;}this.setState({selectedLinks:[].concat(_toConsumableArray(selectedLinks),[{link_id:optionIdInt}])});return;}if(selectedLinks.some(function(_ref4){var id=_ref4.link_id;return optionIdInt===id;})){this.setState({selectedLinks:selectedLinks.filter(function(link){return link.link_id!==optionIdInt;})});}}},{key:\"render\",value:function render(){return/*#__PURE__*/_checkBEM(React,ProductDownloadableLinks,Object.assign({},this.props,this.state,this.containerFunctions));}}]);return _ProductDownloadableLinksContainer;}(Extensible(PureComponent));_ProductDownloadableLinksContainer.defaultProps={title:'',links:[],isRequired:false};Object.defineProperty(_ProductDownloadableLinksContainer,'name',{value:'ProductDownloadableLinksContainer'});export var ProductDownloadableLinksContainer=middleware(_ProductDownloadableLinksContainer,\"Component/ProductDownloadableLinks/Container\");export default connect(mapStateToProps,mapDispatchToProps)(ProductDownloadableLinksContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/ProductDownloadableLinks/ProductDownloadableLinks.container.js"],"names":["PureComponent","connect","ProductDownloadableLinks","mapStateToProps","state","isOpenInNewTab","ConfigReducer","downloadable_links_target_new_window","mapDispatchToProps","dispatch","ProductDownloadableLinksContainer","isLoading","selectedLinks","containerFunctions","setSelectedCheckboxValues","bind","links","props","stopLoading","_","prevState","prevSelectedLinks","updateSelectedOptionsArray","setState","setLinkedDownloadables","setLinkedDownloadablesPrice","price","getTotalPrice","reduce","base","link_id","link","find","id","option_id","option_value","optionIdInt","parseInt","some","filter","defaultProps","title","isRequired","Object","defineProperty","_ProductDownloadableLinksContainer","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport ProductDownloadableLinks from './ProductDownloadableLinks.component';\n\n/** @namespace Component/ProductDownloadableLinks/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    isOpenInNewTab: state.ConfigReducer.downloadable_links_target_new_window\n});\n\n/** @namespace Component/ProductDownloadableLinks/Container/mapDispatchToProps */\n// eslint-disable-next-line no-unused-vars\nexport const mapDispatchToProps = (dispatch) => ({});\n\n/** @namespace Component/ProductDownloadableLinks/Container */\nexport class ProductDownloadableLinksContainer extends PureComponent {\n    static propTypes = {\n        title: PropTypes.string,\n        isRequired: PropTypes.bool,\n        links: PropTypes.array,\n        setLinkedDownloadables: PropTypes.func.isRequired,\n        setLinkedDownloadablesPrice: PropTypes.func.isRequired\n    };\n\n    static defaultProps = {\n        title: '',\n        links: [],\n        isRequired: false\n    };\n\n    state = {\n        isLoading: true,\n        selectedLinks: []\n    };\n\n    containerFunctions = {\n        setSelectedCheckboxValues: this.setSelectedCheckboxValues.bind(this)\n    };\n\n    componentDidMount() {\n        const { links } = this.props;\n\n        if (links) {\n            this.stopLoading();\n        }\n    }\n\n    componentDidUpdate(_, prevState) {\n        const { links } = this.props;\n        const {\n            selectedLinks,\n            isLoading\n        } = this.state;\n\n        const {\n            selectedLinks: prevSelectedLinks\n        } = prevState;\n\n        if (links && isLoading) {\n            this.stopLoading();\n        }\n\n        if (selectedLinks !== prevSelectedLinks) {\n            this.updateSelectedOptionsArray();\n        }\n    }\n\n    stopLoading() {\n        this.setState({ isLoading: false });\n    }\n\n    updateSelectedOptionsArray() {\n        const { setLinkedDownloadables, setLinkedDownloadablesPrice } = this.props;\n        const { selectedLinks } = this.state;\n\n        setLinkedDownloadables(selectedLinks);\n\n        const price = this.getTotalPrice();\n        setLinkedDownloadablesPrice(price);\n    }\n\n    getTotalPrice() {\n        const { selectedLinks } = this.state;\n        const { links } = this.props;\n\n        return selectedLinks.reduce(\n            (base, { link_id }) => {\n                const link = links.find(({ id }) => id === link_id);\n                return base + link.price;\n            },\n            0\n        );\n    }\n\n    setSelectedCheckboxValues(option_id, option_value) {\n        const { selectedLinks } = this.state;\n\n        const optionIdInt = parseInt(option_id, 10);\n\n        if (option_value) {\n            if (selectedLinks.some(({ link_id: id }) => optionIdInt === id)) {\n                return;\n            }\n            this.setState({\n                selectedLinks: [...selectedLinks, { link_id: optionIdInt }]\n            });\n\n            return;\n        }\n\n        if (selectedLinks.some(({ link_id: id }) => optionIdInt === id)) {\n            this.setState({\n                selectedLinks: selectedLinks.filter(\n                    (link) => link.link_id !== optionIdInt\n                )\n            });\n        }\n    }\n\n    render() {\n        return (\n            <ProductDownloadableLinks\n              { ...this.props }\n              { ...this.state }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProductDownloadableLinksContainer);\n"]},"metadata":{},"sourceType":"module"}