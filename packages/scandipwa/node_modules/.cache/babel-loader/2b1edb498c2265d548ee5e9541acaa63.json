{"ast":null,"code":"import _objectSpread from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/* eslint-disable react/no-unused-prop-types */ /**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{createRef,PureComponent}from'react';import{createPortal}from'react-dom';import{ChildrenType,MixType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Common\";import{DeviceType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Device\";import{toggleScroll}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Browser\";import\"./Overlay.style\";/** @namespace Component/Overlay/Component */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _Overlay=/*#__PURE__*/function(_Extensible){_inherits(_Overlay,_Extensible);var _super=_createSuper(_Overlay);function _Overlay(){var _this;_classCallCheck(this,_Overlay);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.overlayRef=/*#__PURE__*/createRef();return _this;}_createClass(_Overlay,[{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var prevWasVisible=this.getIsVisible(prevProps);var isVisible=this.getIsVisible();if(isVisible&&!prevWasVisible){this.onVisible();}if(!isVisible&&prevWasVisible){this.onHide();}}},{key:\"onVisible\",value:function onVisible(){var _this$props=this.props,onVisible=_this$props.onVisible,isStatic=_this$props.isStatic,device=_this$props.device;if(isStatic){return;}if(device.isMobile){this.freezeScroll();}this.overlayRef.current.focus();onVisible();}},{key:\"onHide\",value:function onHide(){var _this$props2=this.props,onHide=_this$props2.onHide,isStatic=_this$props2.isStatic,device=_this$props2.device;if(isStatic){return;}if(device.isMobile){this.unfreezeScroll();}onHide();}},{key:\"getIsVisible\",value:function getIsVisible(){var props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.props;var id=props.id,activeOverlay=props.activeOverlay,isStatic=props.isStatic;return isStatic||id===activeOverlay;}},{key:\"freezeScroll\",value:function freezeScroll(){this.YoffsetWhenScrollDisabled=window.pageYOffset||document.body.scrollTop;toggleScroll(false);document.body.style.marginTop=\"\".concat(-this.YoffsetWhenScrollDisabled,\"px\");}},{key:\"unfreezeScroll\",value:function unfreezeScroll(){toggleScroll(true);document.body.style.marginTop=0;window.scrollTo(0,this.YoffsetWhenScrollDisabled);}},{key:\"renderInMobilePortal\",value:function renderInMobilePortal(content){var _this$props3=this.props,isStatic=_this$props3.isStatic,isRenderInPortal=_this$props3.isRenderInPortal,device=_this$props3.device;if(!isStatic&&device.isMobile&&isRenderInPortal){return/*#__PURE__*/createPortal(content,document.body);}return content;}},{key:\"render\",value:function render(){var _this$props4=this.props,children=_this$props4.children,mix=_this$props4.mix,areOtherOverlaysOpen=_this$props4.areOtherOverlaysOpen,isStatic=_this$props4.isStatic;var isVisible=this.getIsVisible();return this.renderInMobilePortal(/*#__PURE__*/_checkBEM(React,\"div\",{block:\"Overlay\",ref:this.overlayRef,mods:{isVisible:isVisible,isStatic:isStatic,isInstant:areOtherOverlaysOpen},mix:_objectSpread(_objectSpread({},mix),{},{mods:_objectSpread(_objectSpread({},mix.mods),{},{isVisible:isVisible})})},children&&children));}}]);return _Overlay;}(Extensible(PureComponent));_Overlay.defaultProps={mix:{},children:[],onVisible:function onVisible(){},isStatic:false,onHide:function onHide(){},isRenderInPortal:true};Object.defineProperty(_Overlay,'name',{value:'Overlay'});export var Overlay=middleware(_Overlay,\"Component/Overlay/Component\");export default Overlay;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/Overlay/Overlay.component.js"],"names":["createRef","PureComponent","createPortal","ChildrenType","MixType","DeviceType","toggleScroll","Overlay","overlayRef","prevProps","prevWasVisible","getIsVisible","isVisible","onVisible","onHide","props","isStatic","device","isMobile","freezeScroll","current","focus","unfreezeScroll","id","activeOverlay","YoffsetWhenScrollDisabled","window","pageYOffset","document","body","scrollTop","style","marginTop","scrollTo","content","isRenderInPortal","children","mix","areOtherOverlaysOpen","renderInMobilePortal","isInstant","mods","defaultProps","Object","defineProperty","_Overlay","value"],"mappings":"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","sourcesContent":["/* eslint-disable react/no-unused-prop-types */\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { createRef, PureComponent } from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { ChildrenType, MixType } from 'Type/Common';\nimport { DeviceType } from 'Type/Device';\nimport { toggleScroll } from 'Util/Browser';\n\nimport './Overlay.style';\n\n/** @namespace Component/Overlay/Component */\nexport class Overlay extends PureComponent {\n    static propTypes = {\n        mix: MixType,\n        id: PropTypes.string.isRequired,\n        onVisible: PropTypes.func,\n        onHide: PropTypes.func,\n        activeOverlay: PropTypes.string.isRequired,\n        areOtherOverlaysOpen: PropTypes.bool.isRequired,\n        isStatic: PropTypes.bool,\n        isRenderInPortal: PropTypes.bool,\n        children: ChildrenType,\n        device: DeviceType.isRequired\n    };\n\n    static defaultProps = {\n        mix: {},\n        children: [],\n        onVisible: () => {},\n        isStatic: false,\n        onHide: () => {},\n        isRenderInPortal: true\n    };\n\n    overlayRef = createRef();\n\n    componentDidUpdate(prevProps) {\n        const prevWasVisible = this.getIsVisible(prevProps);\n        const isVisible = this.getIsVisible();\n        if (isVisible && !prevWasVisible) {\n            this.onVisible();\n        }\n        if (!isVisible && prevWasVisible) {\n            this.onHide();\n        }\n    }\n\n    onVisible() {\n        const { onVisible, isStatic, device } = this.props;\n        if (isStatic) {\n            return;\n        }\n        if (device.isMobile) {\n            this.freezeScroll();\n        }\n        this.overlayRef.current.focus();\n        onVisible();\n    }\n\n    onHide() {\n        const { onHide, isStatic, device } = this.props;\n        if (isStatic) {\n            return;\n        }\n        if (device.isMobile) {\n            this.unfreezeScroll();\n        }\n        onHide();\n    }\n\n    getIsVisible(props = this.props) {\n        const { id, activeOverlay, isStatic } = props;\n        return isStatic || id === activeOverlay;\n    }\n\n    freezeScroll() {\n        this.YoffsetWhenScrollDisabled = window.pageYOffset || document.body.scrollTop;\n        toggleScroll(false);\n        document.body.style.marginTop = `${-this.YoffsetWhenScrollDisabled}px`;\n    }\n\n    unfreezeScroll() {\n        toggleScroll(true);\n        document.body.style.marginTop = 0;\n        window.scrollTo(0, this.YoffsetWhenScrollDisabled);\n    }\n\n    renderInMobilePortal(content) {\n        const { isStatic, isRenderInPortal, device } = this.props;\n\n        if (!isStatic && device.isMobile && isRenderInPortal) {\n            return createPortal(content, document.body);\n        }\n\n        return content;\n    }\n\n    render() {\n        const {\n            children,\n            mix,\n            areOtherOverlaysOpen,\n            isStatic\n        } = this.props;\n\n        const isVisible = this.getIsVisible();\n\n        return this.renderInMobilePortal(\n            <div\n              block=\"Overlay\"\n              ref={ this.overlayRef }\n              mods={ { isVisible, isStatic, isInstant: areOtherOverlaysOpen } }\n              mix={ { ...mix, mods: { ...mix.mods, isVisible } } }\n            >\n                { children && children }\n            </div>\n        );\n    }\n}\n\nexport default Overlay;\n"]},"metadata":{},"sourceType":"module"}