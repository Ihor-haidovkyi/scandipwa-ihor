{"ast":null,"code":"import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import{connect}from'react-redux';import SwipeToDelete from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/SwipeToDelete\";import{changeNavigationState}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.action\";import{TOP_NAVIGATION_TYPE}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.reducer\";import{showNotification as _showNotification}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Notification/Notification.action\";import{ProductType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/ProductList\";import{isSignedIn}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Auth\";import history from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/History\";import{debounce}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Request\";import{appendWithStoreCode}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Url\";import WishlistItem from\"./WishlistItem.component\";import{UPDATE_WISHLIST_FREQUENCY}from\"./WishlistItem.config\";export var CartDispatcher=import(/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Cart/Cart.dispatcher\");export var WishlistDispatcher=import(/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Wishlist/Wishlist.dispatcher\");/** @namespace Component/WishlistItem/Container/mapStateToProps */ // eslint-disable-next-line no-unused-vars\nexport var mapStateToProps=middleware(function(state){return{isMobile:state.ConfigReducer.device.isMobile};},\"Component/WishlistItem/Container/mapStateToProps\");/** @namespace Component/WishlistItem/Container/mapDispatchToProps */export var mapDispatchToProps=middleware(function(dispatch){return{showNotification:function showNotification(type,message){return dispatch(_showNotification(type,message));},addProductToCart:function addProductToCart(options){return CartDispatcher.then(function(_ref){var dispatcher=_ref.default;return dispatcher.addProductToCart(dispatch,options);});},updateWishlistItem:function updateWishlistItem(options){return WishlistDispatcher.then(function(_ref2){var dispatcher=_ref2.default;return dispatcher.updateWishlistItem(dispatch,options);});},removeFromWishlist:function removeFromWishlist(options){return WishlistDispatcher.then(function(_ref3){var dispatcher=_ref3.default;return dispatcher.removeItemFromWishlist(dispatch,options);});},changeHeaderState:function changeHeaderState(state){return dispatch(changeNavigationState(TOP_NAVIGATION_TYPE,state));}};},\"Component/WishlistItem/Container/mapDispatchToProps\");/** @namespace Component/WishlistItem/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _WishlistItemContainer=/*#__PURE__*/function(_Extensible){_inherits(_WishlistItemContainer,_Extensible);var _super=_createSuper(_WishlistItemContainer);function _WishlistItemContainer(){var _this;_classCallCheck(this,_WishlistItemContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.containerFunctions={addToCart:_this.addItemToCart.bind(_assertThisInitialized(_this)),removeItem:_this.removeItem.bind(_assertThisInitialized(_this),false,true)};_this.state={isLoading:false};_this.removeItemOnSwipe=_this.removeItem.bind(_assertThisInitialized(_this),false,true);_this.changeQuantity=debounce(function(quantity){var _this$props=_this.props,item_id=_this$props.product.wishlist.id,updateWishlistItem=_this$props.updateWishlistItem;updateWishlistItem({item_id:item_id,quantity:quantity});},UPDATE_WISHLIST_FREQUENCY);_this.changeDescription=debounce(function(description){var _this$props2=_this.props,item_id=_this$props2.product.wishlist.id,updateWishlistItem=_this$props2.updateWishlistItem;updateWishlistItem({item_id:item_id,description:description});},UPDATE_WISHLIST_FREQUENCY);_this.containerProps=function(){var isLoading=_this.state.isLoading;return{changeQuantity:_this.changeQuantity,changeDescription:_this.changeDescription,attributes:_this.getAttributes(),isLoading:isLoading};};_this.getConfigurableVariantIndex=function(sku,variants){return Object.keys(variants).find(function(i){return variants[i].sku===sku;});};_this.getAttributes=function(){var _this$props$product=_this.props.product,variants=_this$props$product.variants,configurable_options=_this$props$product.configurable_options,wishlistSku=_this$props$product.wishlist.sku;var _ref4=variants.find(function(_ref5){var sku=_ref5.sku;return sku===wishlistSku;})||{},_ref4$attributes=_ref4.attributes,attributes=_ref4$attributes===void 0?[]:_ref4$attributes;return attributes?Object.values(attributes).reduce(function(acc,_ref6){var attribute_code=_ref6.attribute_code,attribute_value=_ref6.attribute_value;var _ref7=configurable_options[attribute_code]||{},_ref7$attribute_optio=_ref7.attribute_options;_ref7$attribute_optio=_ref7$attribute_optio===void 0?{}:_ref7$attribute_optio;var _ref7$attribute_optio2=_ref7$attribute_optio[attribute_value];_ref7$attribute_optio2=_ref7$attribute_optio2===void 0?{}:_ref7$attribute_optio2;var value=_ref7$attribute_optio2.value,label=_ref7$attribute_optio2.label;if(value===attribute_value){acc.push(label);return acc;}return acc;},[]):[];};_this.renderRightSideContent=function(){return/*#__PURE__*/_checkBEM(React,\"button\",{block:\"WishlistItem\",elem:\"SwipeToDeleteRightSide\",onClick:_this.removeItemOnSwipe,\"aria-label\":__('Remove')},__('Delete'));};return _this;}_createClass(_WishlistItemContainer,[{key:\"addItemToCart\",value:function addItemToCart(){var _this2=this;var _this$props3=this.props,item=_this$props3.product,addProductToCart=_this$props3.addProductToCart,showNotification=_this$props3.showNotification;var type_id=item.type_id,variants=item.variants,_item$wishlist=item.wishlist,id=_item$wishlist.id,sku=_item$wishlist.sku,quantity=_item$wishlist.quantity,buy_request=_item$wishlist.buy_request;if(!isSignedIn()){return null;}if(type_id==='configurable'){var configurableVariantIndex=this.getConfigurableVariantIndex(sku,variants);if(!configurableVariantIndex){history.push({pathname:appendWithStoreCode(item.url)});showNotification('info',__('Please select product options!'));return Promise.resolve();}item.configurableVariantIndex=configurableVariantIndex;}this.setState({isLoading:true});return addProductToCart({product:item,quantity:quantity,buyRequest:buy_request}).then(/** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartThen */middleware(function(){return _this2.removeItem(id);},\"Component/WishlistItem/Container/addItemToCartAddProductToCartThen\"),/** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartCatch */middleware(function(){return _this2.showNotification('error',__('Error Adding Product To Cart'));},\"Component/WishlistItem/Container/addItemToCartAddProductToCartCatch\")).then(/** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartThenThen */middleware(function(){return showNotification('success',__('Product Added To Cart'));},\"Component/WishlistItem/Container/addItemToCartAddProductToCartThenThen\")).catch(/** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartThenThenCatch */middleware(function(){return _this2.showNotification('error',__('Error cleaning wishlist'));},\"Component/WishlistItem/Container/addItemToCartAddProductToCartThenThenCatch\"));}},{key:\"showNotification\",value:function showNotification(){var showNotification=this.props.showNotification;this.setState({isLoading:false});showNotification.apply(void 0,arguments);}},{key:\"removeItem\",value:function removeItem(){var noMessages=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var isRemoveOnly=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var _this$props4=this.props,item_id=_this$props4.product.wishlist.id,removeFromWishlist=_this$props4.removeFromWishlist,handleSelectIdChange=_this$props4.handleSelectIdChange;this.setState({isLoading:true});handleSelectIdChange(item_id,isRemoveOnly);return removeFromWishlist({item_id:item_id,noMessages:noMessages});}},{key:\"render\",value:function render(){var isLoading=this.state.isLoading;return/*#__PURE__*/_checkBEM(React,SwipeToDelete,{renderRightSideContent:this.renderRightSideContent,topElemMix:{block:'WishlistItem'},onAheadOfDragItemRemoveThreshold:this.containerFunctions.removeItem,isLoading:isLoading},/*#__PURE__*/_checkBEM(React,WishlistItem,Object.assign({},this.props,this.containerProps(),this.containerFunctions,this.state)));}}]);return _WishlistItemContainer;}(Extensible(PureComponent));Object.defineProperty(_WishlistItemContainer,'name',{value:'WishlistItemContainer'});export var WishlistItemContainer=middleware(_WishlistItemContainer,\"Component/WishlistItem/Container\");export default connect(mapStateToProps,mapDispatchToProps)(WishlistItemContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/WishlistItem/WishlistItem.container.js"],"names":["PureComponent","connect","SwipeToDelete","changeNavigationState","TOP_NAVIGATION_TYPE","showNotification","ProductType","isSignedIn","history","debounce","appendWithStoreCode","WishlistItem","UPDATE_WISHLIST_FREQUENCY","CartDispatcher","WishlistDispatcher","mapStateToProps","state","isMobile","ConfigReducer","device","mapDispatchToProps","dispatch","type","message","addProductToCart","options","then","dispatcher","default","updateWishlistItem","removeFromWishlist","removeItemFromWishlist","changeHeaderState","WishlistItemContainer","containerFunctions","addToCart","addItemToCart","bind","removeItem","isLoading","removeItemOnSwipe","changeQuantity","quantity","props","item_id","product","wishlist","id","changeDescription","description","containerProps","attributes","getAttributes","getConfigurableVariantIndex","sku","variants","Object","keys","find","i","configurable_options","wishlistSku","values","reduce","acc","attribute_code","attribute_value","attribute_options","value","label","push","renderRightSideContent","__","item","type_id","buy_request","configurableVariantIndex","pathname","url","Promise","resolve","setState","buyRequest","catch","noMessages","isRemoveOnly","handleSelectIdChange","block","defineProperty","_WishlistItemContainer"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport SwipeToDelete from 'Component/SwipeToDelete';\nimport { changeNavigationState } from 'Store/Navigation/Navigation.action';\nimport { TOP_NAVIGATION_TYPE } from 'Store/Navigation/Navigation.reducer';\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport { ProductType } from 'Type/ProductList';\nimport { isSignedIn } from 'Util/Auth';\nimport history from 'Util/History';\nimport { debounce } from 'Util/Request';\nimport { appendWithStoreCode } from 'Util/Url';\n\nimport WishlistItem from './WishlistItem.component';\nimport { UPDATE_WISHLIST_FREQUENCY } from './WishlistItem.config';\n\nexport const CartDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/Cart/Cart.dispatcher'\n);\nexport const WishlistDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/Wishlist/Wishlist.dispatcher'\n);\n\n/** @namespace Component/WishlistItem/Container/mapStateToProps */\n// eslint-disable-next-line no-unused-vars\nexport const mapStateToProps = (state) => ({\n    isMobile: state.ConfigReducer.device.isMobile\n});\n\n/** @namespace Component/WishlistItem/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    showNotification: (type, message) => dispatch(showNotification(type, message)),\n    addProductToCart: (options) => CartDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.addProductToCart(dispatch, options)\n    ),\n    updateWishlistItem: (options) => WishlistDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.updateWishlistItem(dispatch, options)\n    ),\n    removeFromWishlist: (options) => WishlistDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.removeItemFromWishlist(dispatch, options)\n    ),\n    changeHeaderState: (state) => dispatch(changeNavigationState(TOP_NAVIGATION_TYPE, state))\n});\n\n/** @namespace Component/WishlistItem/Container */\nexport class WishlistItemContainer extends PureComponent {\n    static propTypes = {\n        product: ProductType.isRequired,\n        addProductToCart: PropTypes.func.isRequired,\n        showNotification: PropTypes.func.isRequired,\n        updateWishlistItem: PropTypes.func.isRequired,\n        removeFromWishlist: PropTypes.func.isRequired,\n        handleSelectIdChange: PropTypes.func.isRequired\n    };\n\n    containerFunctions = {\n        addToCart: this.addItemToCart.bind(this),\n        removeItem: this.removeItem.bind(this, false, true)\n    };\n\n    state = {\n        isLoading: false\n    };\n\n    removeItemOnSwipe = this.removeItem.bind(this, false, true);\n\n    changeQuantity = debounce((quantity) => {\n        const { product: { wishlist: { id: item_id } }, updateWishlistItem } = this.props;\n        updateWishlistItem({ item_id, quantity });\n    }, UPDATE_WISHLIST_FREQUENCY);\n\n    changeDescription = debounce((description) => {\n        const { product: { wishlist: { id: item_id } }, updateWishlistItem } = this.props;\n        updateWishlistItem({ item_id, description });\n    }, UPDATE_WISHLIST_FREQUENCY);\n\n    containerProps = () => {\n        const { isLoading } = this.state;\n\n        return {\n            changeQuantity: this.changeQuantity,\n            changeDescription: this.changeDescription,\n            attributes: this.getAttributes(),\n            isLoading\n        };\n    };\n\n    getConfigurableVariantIndex = (sku, variants) => Object.keys(variants).find((i) => variants[i].sku === sku);\n\n    getAttributes = () => {\n        const { product: { variants, configurable_options, wishlist: { sku: wishlistSku } } } = this.props;\n\n        const { attributes = [] } = variants.find(({ sku }) => sku === wishlistSku) || {};\n\n        return attributes ? Object.values(attributes).reduce((acc, { attribute_code, attribute_value }) => {\n            const {\n                attribute_options: {\n                    [attribute_value]: {\n                        value,\n                        label\n                    } = {}\n                } = {}\n            } = configurable_options[attribute_code] || {};\n\n            if (value === attribute_value) {\n                acc.push(label);\n\n                return acc;\n            }\n\n            return acc;\n        }, []) : [];\n    };\n\n    addItemToCart() {\n        const { product: item, addProductToCart, showNotification } = this.props;\n        const {\n            type_id,\n            variants,\n            wishlist: {\n                id, sku, quantity, buy_request\n            }\n        } = item;\n\n        if (!isSignedIn()) {\n            return null;\n        }\n\n        if (type_id === 'configurable') {\n            const configurableVariantIndex = this.getConfigurableVariantIndex(sku, variants);\n\n            if (!configurableVariantIndex) {\n                history.push({ pathname: appendWithStoreCode(item.url) });\n                showNotification('info', __('Please select product options!'));\n                return Promise.resolve();\n            }\n\n            item.configurableVariantIndex = configurableVariantIndex;\n        }\n\n        this.setState({ isLoading: true });\n\n        return addProductToCart({ product: item, quantity, buyRequest: buy_request })\n            .then(\n                /** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartThen */\n                () => this.removeItem(id),\n                /** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartCatch */\n                () => this.showNotification('error', __('Error Adding Product To Cart'))\n            )\n            .then(\n                /** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartThenThen */\n                () => showNotification('success', __('Product Added To Cart'))\n            )\n            .catch(\n                /** @namespace Component/WishlistItem/Container/addItemToCartAddProductToCartThenThenCatch */\n                () => this.showNotification('error', __('Error cleaning wishlist'))\n            );\n    }\n\n    showNotification(...args) {\n        const { showNotification } = this.props;\n        this.setState({ isLoading: false });\n        showNotification(...args);\n    }\n\n    removeItem(noMessages = true, isRemoveOnly = false) {\n        const { product: { wishlist: { id: item_id } }, removeFromWishlist, handleSelectIdChange } = this.props;\n        this.setState({ isLoading: true });\n\n        handleSelectIdChange(item_id, isRemoveOnly);\n\n        return removeFromWishlist({ item_id, noMessages });\n    }\n\n    renderRightSideContent = () => (\n        <button\n          block=\"WishlistItem\"\n          elem=\"SwipeToDeleteRightSide\"\n          onClick={ this.removeItemOnSwipe }\n          aria-label={ __('Remove') }\n        >\n            { __('Delete') }\n        </button>\n    );\n\n    render() {\n        const { isLoading } = this.state;\n\n        return (\n            <SwipeToDelete\n              renderRightSideContent={ this.renderRightSideContent }\n              topElemMix={ { block: 'WishlistItem' } }\n              onAheadOfDragItemRemoveThreshold={ this.containerFunctions.removeItem }\n              isLoading={ isLoading }\n            >\n                <WishlistItem\n                  { ...this.props }\n                  { ...this.containerProps() }\n                  { ...this.containerFunctions }\n                  { ...this.state }\n                />\n            </SwipeToDelete>\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(WishlistItemContainer);\n"]},"metadata":{},"sourceType":"module"}