{"ast":null,"code":"import _slicedToArray from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _get from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";import _getPrototypeOf from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import{connect}from'react-redux';import{KlarnaContainer}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/Klarna/Klarna.container\";import{BILLING_STEP}from\"/home/marketihor/scandipwa/packages/scandipwa/src/route/Checkout/Checkout.config\";import{showNotification}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Notification/Notification.action\";import{paymentMethodsType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Checkout\";import{TotalsType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/MiniCart\";import CheckoutPayments from\"./CheckoutPayments.component\";import{KLARNA}from\"./CheckoutPayments.config\";/** @namespace Component/CheckoutPayments/Container/mapDispatchToProps */export var mapDispatchToProps=middleware(function(dispatch){return{showError:function showError(message){return dispatch(showNotification('error',message));}};},\"Component/CheckoutPayments/Container/mapDispatchToProps\");/** @namespace Component/CheckoutPayments/Container/mapStateToProps */export var mapStateToProps=middleware(function(state){return{totals:state.CartReducer.cartTotals,email:state.CheckoutReducer.email,address:state.CheckoutReducer.shippingFields};},\"Component/CheckoutPayments/Container/mapStateToProps\");/** @namespace Component/CheckoutPayments/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _CheckoutPaymentsContainer=/*#__PURE__*/function(_Extensible){_inherits(_CheckoutPaymentsContainer,_Extensible);var _super=_createSuper(_CheckoutPaymentsContainer);function _CheckoutPaymentsContainer(){var _this;_classCallCheck(this,_CheckoutPaymentsContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.containerFunctions={selectPaymentMethod:_this.selectPaymentMethod.bind(_assertThisInitialized(_this))};_this.dataMap=_defineProperty({},KLARNA,_this.getKlarnaData.bind(_assertThisInitialized(_this)));_this.collectAdditionalData=function(){var selectedPaymentCode=_this.state.selectedPaymentCode;var additionalDataGetter=_this.dataMap[selectedPaymentCode];if(!additionalDataGetter){return{};}return additionalDataGetter();};return _this;}_createClass(_CheckoutPaymentsContainer,[{key:\"__construct\",value:function __construct(props){_get(_getPrototypeOf(_CheckoutPaymentsContainer.prototype),\"__construct\",this).call(this,props);var paymentMethods=props.paymentMethods;var _paymentMethods=_slicedToArray(paymentMethods,1),_paymentMethods$=_paymentMethods[0];_paymentMethods$=_paymentMethods$===void 0?{}:_paymentMethods$;var code=_paymentMethods$.code;this.state={selectedPaymentCode:code};}},{key:\"componentDidMount\",value:function componentDidMount(){if(window.formPortalCollector){window.formPortalCollector.subscribe(BILLING_STEP,this.collectAdditionalData,'CheckoutPaymentsContainer');}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(window.formPortalCollector){window.formPortalCollector.unsubscribe(BILLING_STEP,'CheckoutPaymentsContainer');}}},{key:\"getKlarnaData\",value:function getKlarnaData(){return{asyncData:KlarnaContainer.authorize()};}},{key:\"selectPaymentMethod\",value:function selectPaymentMethod(_ref){var code=_ref.code;var _this$props=this.props,onPaymentMethodSelect=_this$props.onPaymentMethodSelect,setOrderButtonEnableStatus=_this$props.setOrderButtonEnableStatus;this.setState({selectedPaymentCode:code});onPaymentMethodSelect(code);setOrderButtonEnableStatus(true);}},{key:\"render\",value:function render(){return/*#__PURE__*/_checkBEM(React,CheckoutPayments,Object.assign({},this.props,this.containerFunctions,this.state));}}]);return _CheckoutPaymentsContainer;}(Extensible(PureComponent));Object.defineProperty(_CheckoutPaymentsContainer,'name',{value:'CheckoutPaymentsContainer'});export var CheckoutPaymentsContainer=middleware(_CheckoutPaymentsContainer,\"Component/CheckoutPayments/Container\");export default connect(mapStateToProps,mapDispatchToProps)(CheckoutPaymentsContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/CheckoutPayments/CheckoutPayments.container.js"],"names":["PureComponent","connect","KlarnaContainer","BILLING_STEP","showNotification","paymentMethodsType","TotalsType","CheckoutPayments","KLARNA","mapDispatchToProps","dispatch","showError","message","mapStateToProps","state","totals","CartReducer","cartTotals","email","CheckoutReducer","address","shippingFields","CheckoutPaymentsContainer","containerFunctions","selectPaymentMethod","bind","dataMap","getKlarnaData","collectAdditionalData","selectedPaymentCode","additionalDataGetter","props","paymentMethods","code","window","formPortalCollector","subscribe","unsubscribe","asyncData","authorize","onPaymentMethodSelect","setOrderButtonEnableStatus","setState","Object","defineProperty","_CheckoutPaymentsContainer","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { KlarnaContainer } from 'Component/Klarna/Klarna.container';\nimport { BILLING_STEP } from 'Route/Checkout/Checkout.config';\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport { paymentMethodsType } from 'Type/Checkout';\nimport { TotalsType } from 'Type/MiniCart';\n\nimport CheckoutPayments from './CheckoutPayments.component';\nimport { KLARNA } from './CheckoutPayments.config';\n\n/** @namespace Component/CheckoutPayments/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    showError: (message) => dispatch(showNotification('error', message))\n});\n\n/** @namespace Component/CheckoutPayments/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    totals: state.CartReducer.cartTotals,\n    email: state.CheckoutReducer.email,\n    address: state.CheckoutReducer.shippingFields\n});\n\n/** @namespace Component/CheckoutPayments/Container */\nexport class CheckoutPaymentsContainer extends PureComponent {\n    static propTypes = {\n        onPaymentMethodSelect: PropTypes.func.isRequired,\n        setOrderButtonEnableStatus: PropTypes.func.isRequired,\n        paymentMethods: paymentMethodsType.isRequired,\n        totals: TotalsType.isRequired,\n        email: PropTypes.string.isRequired,\n        address: PropTypes.object.isRequired\n    };\n\n    containerFunctions = {\n        selectPaymentMethod: this.selectPaymentMethod.bind(this)\n    };\n\n    dataMap = {\n        [KLARNA]: this.getKlarnaData.bind(this)\n    };\n\n    __construct(props) {\n        super.__construct(props);\n\n        const { paymentMethods } = props;\n        const [{ code } = {}] = paymentMethods;\n        this.state = {\n            selectedPaymentCode: code\n        };\n    }\n\n    componentDidMount() {\n        if (window.formPortalCollector) {\n            window.formPortalCollector.subscribe(BILLING_STEP, this.collectAdditionalData, 'CheckoutPaymentsContainer');\n        }\n    }\n\n    componentWillUnmount() {\n        if (window.formPortalCollector) {\n            window.formPortalCollector.unsubscribe(BILLING_STEP, 'CheckoutPaymentsContainer');\n        }\n    }\n\n    getKlarnaData() {\n        return { asyncData: KlarnaContainer.authorize() };\n    }\n\n    collectAdditionalData = () => {\n        const { selectedPaymentCode } = this.state;\n        const additionalDataGetter = this.dataMap[selectedPaymentCode];\n        if (!additionalDataGetter) {\n            return {};\n        }\n\n        return additionalDataGetter();\n    };\n\n    selectPaymentMethod({ code }) {\n        const {\n            onPaymentMethodSelect,\n            setOrderButtonEnableStatus\n        } = this.props;\n\n        this.setState({\n            selectedPaymentCode: code\n        });\n\n        onPaymentMethodSelect(code);\n        setOrderButtonEnableStatus(true);\n    }\n\n    render() {\n        return (\n            <CheckoutPayments\n              { ...this.props }\n              { ...this.containerFunctions }\n              { ...this.state }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CheckoutPaymentsContainer);\n"]},"metadata":{},"sourceType":"module"}