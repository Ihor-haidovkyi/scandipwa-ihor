{"ast":null,"code":"import _objectSpread from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/* eslint-disable react/no-unused-state */ /**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import{ChildrenType,MixType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Common\";import\"./Draggable.style\";/** @namespace Component/Draggable/Component */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _Draggable=/*#__PURE__*/function(_Extensible){_inherits(_Draggable,_Extensible);var _super=_createSuper(_Draggable);function _Draggable(){var _this;_classCallCheck(this,_Draggable);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={isDragging:false,originalX:0,translateX:0,lastTranslateX:0,originalY:0,translateY:0,lastTranslateY:0};_this.handleTouchStart=function(_ref){var touches=_ref.touches;window.addEventListener('touchmove',_this.handleTouchMove);window.addEventListener('touchend',_this.handleTouchEnd);if(touches.length===1){_this._handleDragStart(touches[0]);}};_this.handleMouseDown=function(event){window.addEventListener('mousemove',_this.handleMouseMove);window.addEventListener('mouseup',_this.handleMouseUp);event.preventDefault();_this._handleDragStart(event);};_this.handleTouchMove=function(_ref2){var touches=_ref2.touches;if(touches.length===1){_this.handleMouseMove(touches[0]);}};_this.handleMouseMove=function(_ref3){var clientX=_ref3.clientX,clientY=_ref3.clientY;var isDragging=_this.state.isDragging;var _this$props=_this.props,shiftX=_this$props.shiftX,shiftY=_this$props.shiftY;if(!isDragging){return;}_this.setState(function(_ref4){var originalX=_ref4.originalX,originalY=_ref4.originalY;return{translateX:clientX-originalX+shiftX,translateY:clientY-originalY+shiftY};},function(){var onDrag=_this.props.onDrag;if(onDrag){onDrag(_objectSpread(_objectSpread({},_this.state),{},{clientX:clientX,clientY:clientY}));}});};_this.handleTouchEnd=function(){window.removeEventListener('touchmove',_this.handleTouchMove);window.removeEventListener('touchend',_this.handleTouchEnd);_this._handleDragEnd();};_this.handleMouseUp=function(){window.removeEventListener('mousemove',_this.handleMouseMove);window.removeEventListener('mouseup',_this.handleMouseUp);_this._handleDragEnd();};_this.handleClick=function(e){var onClick=_this.props.onClick;if(onClick){onClick(_this.state,function(newState){return _this.setState(_objectSpread(_objectSpread({},newState),{},{isDragging:false,translateX:0,translateY:0}));},e);}};return _this;}_createClass(_Draggable,[{key:\"componentWillUnmount\",value:function componentWillUnmount(){window.removeEventListener('mousemove',this.handleMouseMove);window.removeEventListener('mouseup',this.handleMouseUp);window.removeEventListener('touchmove',this.handleTouchMove);window.removeEventListener('touchend',this.handleTouchEnd);}},{key:\"_handleDragStart\",value:function _handleDragStart(_ref5){var clientX=_ref5.clientX,clientY=_ref5.clientY;var onDragStart=this.props.onDragStart;if(onDragStart){onDragStart();}this.setState({originalX:clientX,originalY:clientY,isDragging:true});}},{key:\"_handleDragEnd\",value:function _handleDragEnd(){var _this2=this;var onDragEnd=this.props.onDragEnd;onDragEnd(this.state,function(newState){return _this2.setState(_objectSpread(_objectSpread({},newState),{},{isDragging:false,translateX:0,translateY:0}));});// TO STAY WHERE RELEASED\n// originalX: 0,\n// lastTranslateX: translateX,\n// originalY: 0,\n// lastTranslateY: translateY,\n// TO RETURN INTO INITIAL\n// originalX: 0,\n// lastTranslateX: 0\n// originalY: 0,\n// lastTranslateY: 0\n}},{key:\"render\",value:function render(){var _this$props2=this.props,children=_this$props2.children,handleFocus=_this$props2.handleFocus,handleKey=_this$props2.handleKey,draggableRef=_this$props2.draggableRef,mix=_this$props2.mix;return/*#__PURE__*/_checkBEM(React,\"div\",{block:\"Draggable\",mix:mix,ref:draggableRef,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onClick:this.handleClick,onContextMenu:this.handleClick,onKeyDown:handleKey,onFocus:handleFocus,tabIndex:0,role:\"button\",\"aria-label\":\"Draggable area\"},children);}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){var shiftX=props.shiftX,shiftY=props.shiftY;var lastTranslateX=state.lastTranslateX,lastTranslateY=state.lastTranslateY;if(shiftX!==lastTranslateX||shiftY!==lastTranslateY){return{lastTranslateX:shiftX,lastTranslateY:shiftY};}return null;}}]);return _Draggable;}(Extensible(PureComponent));_Draggable.defaultProps={shiftX:0,shiftY:0,onDragStart:function onDragStart(){},onDragEnd:function onDragEnd(state,callback){var translateX=state.translateX,translateY=state.translateY;callback({originalX:0,originalY:0,shiftX:translateX,shiftY:translateY});},onClick:function onClick(){},onDrag:function onDrag(){},handleFocus:function handleFocus(){},handleKey:function handleKey(){},draggableRef:function draggableRef(){},mix:{}};Object.defineProperty(_Draggable,'name',{value:'Draggable'});export var Draggable=middleware(_Draggable,\"Component/Draggable/Component\");export default Draggable;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/Draggable/Draggable.component.js"],"names":["PureComponent","ChildrenType","MixType","Draggable","state","isDragging","originalX","translateX","lastTranslateX","originalY","translateY","lastTranslateY","handleTouchStart","touches","window","addEventListener","handleTouchMove","handleTouchEnd","length","_handleDragStart","handleMouseDown","event","handleMouseMove","handleMouseUp","preventDefault","clientX","clientY","props","shiftX","shiftY","setState","onDrag","removeEventListener","_handleDragEnd","handleClick","e","onClick","newState","onDragStart","onDragEnd","children","handleFocus","handleKey","draggableRef","mix","defaultProps","callback","Object","defineProperty","_Draggable","value"],"mappings":"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","sourcesContent":["/* eslint-disable react/no-unused-state */\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport { ChildrenType, MixType } from 'Type/Common';\n\nimport './Draggable.style';\n\n/** @namespace Component/Draggable/Component */\nexport class Draggable extends PureComponent {\n    static propTypes = {\n        shiftX: PropTypes.number,\n        shiftY: PropTypes.number,\n        onDragStart: PropTypes.func,\n        onClick: PropTypes.func,\n        onDragEnd: PropTypes.func,\n        handleFocus: PropTypes.func,\n        handleKey: PropTypes.func,\n        onDrag: PropTypes.func,\n        children: ChildrenType.isRequired,\n        mix: MixType,\n        draggableRef: PropTypes.oneOfType([\n            PropTypes.func,\n            PropTypes.shape({ current: PropTypes.instanceOf(Element) })\n        ])\n    };\n\n    static defaultProps = {\n        shiftX: 0,\n        shiftY: 0,\n        onDragStart: () => {},\n        onDragEnd: (state, callback) => {\n            const { translateX, translateY } = state;\n\n            callback({\n                originalX: 0,\n                originalY: 0,\n                shiftX: translateX,\n                shiftY: translateY\n            });\n        },\n        onClick: () => {},\n        onDrag: () => {},\n        handleFocus: () => {},\n        handleKey: () => {},\n        draggableRef: () => {},\n        mix: {}\n    };\n\n    state = {\n        isDragging: false,\n        originalX: 0,\n        translateX: 0,\n        lastTranslateX: 0,\n        originalY: 0,\n        translateY: 0,\n        lastTranslateY: 0\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        const { shiftX, shiftY } = props;\n        const { lastTranslateX, lastTranslateY } = state;\n        if (shiftX !== lastTranslateX || shiftY !== lastTranslateY) {\n            return {\n                lastTranslateX: shiftX,\n                lastTranslateY: shiftY\n            };\n        }\n\n        return null;\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('mousemove', this.handleMouseMove);\n        window.removeEventListener('mouseup', this.handleMouseUp);\n        window.removeEventListener('touchmove', this.handleTouchMove);\n        window.removeEventListener('touchend', this.handleTouchEnd);\n    }\n\n    handleTouchStart = ({ touches }) => {\n        window.addEventListener('touchmove', this.handleTouchMove);\n        window.addEventListener('touchend', this.handleTouchEnd);\n\n        if (touches.length === 1) {\n            this._handleDragStart(touches[0]);\n        }\n    };\n\n    handleMouseDown = (event) => {\n        window.addEventListener('mousemove', this.handleMouseMove);\n        window.addEventListener('mouseup', this.handleMouseUp);\n\n        event.preventDefault();\n        this._handleDragStart(event);\n    };\n\n    handleTouchMove = ({ touches }) => {\n        if (touches.length === 1) {\n            this.handleMouseMove(touches[0]);\n        }\n    };\n\n    handleMouseMove = ({ clientX, clientY }) => {\n        const { isDragging } = this.state;\n        const { shiftX, shiftY } = this.props;\n\n        if (!isDragging) {\n            return;\n        }\n\n        this.setState(({\n            originalX,\n            originalY\n        }) => ({\n            translateX: clientX - originalX + shiftX,\n            translateY: clientY - originalY + shiftY\n        }), () => {\n            const { onDrag } = this.props;\n            if (onDrag) {\n                onDrag({ ...this.state, clientX, clientY });\n            }\n        });\n    };\n\n    handleTouchEnd = () => {\n        window.removeEventListener('touchmove', this.handleTouchMove);\n        window.removeEventListener('touchend', this.handleTouchEnd);\n\n        this._handleDragEnd();\n    };\n\n    handleMouseUp = () => {\n        window.removeEventListener('mousemove', this.handleMouseMove);\n        window.removeEventListener('mouseup', this.handleMouseUp);\n\n        this._handleDragEnd();\n    };\n\n    handleClick = (e) => {\n        const { onClick } = this.props;\n\n        if (onClick) {\n            onClick(\n                this.state,\n                (newState) => this.setState({\n                    ...newState,\n                    isDragging: false,\n                    translateX: 0,\n                    translateY: 0\n                }),\n                e\n            );\n        }\n    };\n\n    _handleDragStart({\n        clientX,\n        clientY\n    }) {\n        const { onDragStart } = this.props;\n\n        if (onDragStart) {\n            onDragStart();\n        }\n\n        this.setState({\n            originalX: clientX,\n            originalY: clientY,\n            isDragging: true\n        });\n    }\n\n    _handleDragEnd() {\n        const { onDragEnd } = this.props;\n\n        onDragEnd(this.state, (newState) => this.setState({\n            ...newState,\n            isDragging: false,\n            translateX: 0,\n            translateY: 0\n        }));\n\n        // TO STAY WHERE RELEASED\n        // originalX: 0,\n        // lastTranslateX: translateX,\n        // originalY: 0,\n        // lastTranslateY: translateY,\n\n        // TO RETURN INTO INITIAL\n        // originalX: 0,\n        // lastTranslateX: 0\n        // originalY: 0,\n        // lastTranslateY: 0\n    }\n\n    render() {\n        const {\n            children,\n            handleFocus,\n            handleKey,\n            draggableRef,\n            mix\n        } = this.props;\n\n        return (\n            <div\n              block=\"Draggable\"\n              mix={ mix }\n              ref={ draggableRef }\n              onMouseDown={ this.handleMouseDown }\n              onTouchStart={ this.handleTouchStart }\n              onClick={ this.handleClick }\n              onContextMenu={ this.handleClick }\n              onKeyDown={ handleKey }\n              onFocus={ handleFocus }\n              tabIndex={ 0 }\n              role=\"button\"\n              aria-label=\"Draggable area\"\n            >\n                { children }\n            </div>\n        );\n    }\n}\n\nexport default Draggable;\n"]},"metadata":{},"sourceType":"module"}