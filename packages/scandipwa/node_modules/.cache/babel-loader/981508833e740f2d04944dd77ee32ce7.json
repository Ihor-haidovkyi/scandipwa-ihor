{"ast":null,"code":"import _slicedToArray from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/* eslint-disable react/no-unused-state */ /**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import Popup from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/Popup\";import{MediaItemType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/ProductList\";import{makeCancelable}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Promise\";import{VIDEO_POPUP_ID,VIMEO_FORMAT,YOUTUBE_FORMAT}from\"./VideoPopup.config\";import\"./VideoPopup.style\";/**\n * A popup capable of displaying a video\n * @class VideoPopup\n * @namespace Component/VideoPopup/Component\n */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _VideoPopup=/*#__PURE__*/function(_Extensible){_inherits(_VideoPopup,_Extensible);var _super=_createSuper(_VideoPopup);function _VideoPopup(){_classCallCheck(this,_VideoPopup);return _super.apply(this,arguments);}_createClass(_VideoPopup,[{key:\"componentDidMount\",value:function componentDidMount(){var _this=this;this.loadVimeoLibrary();this.loadYouTubeLibrary();Promise.all([this.vimeoPromise,this.youTubePromise]).then(/** @namespace Component/VideoPopup/Component/videoLibrariesThen */middleware(function(){return _this.forceUpdate();},\"Component/VideoPopup/Component/videoLibrariesThen\"));}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(this.youTubePromise){this.youTubePromise.cancel();}if(this.vimeoPromise){this.vimeoPromise.cancel();}}/**\n     * Renders a video provided by Vimeo\n     * @param videoId\n     * @returns {*}\n     * @private\n     */},{key:\"_renderVimeoVideo\",value:function _renderVimeoVideo(videoId){var Vimeo=this.vimeoComponent;if(!Vimeo){return null;}return/*#__PURE__*/_checkBEM(React,Vimeo,{videoId:videoId,autoplay:true});}/**\n     * Renders a video provided by Youtube\n     * @param videoId\n     * @returns {*}\n     * @private\n     */},{key:\"_renderYoutubeVideo\",value:function _renderYoutubeVideo(videoId){var YouTube=this.youTubeComponent;if(!YouTube){return null;}return/*#__PURE__*/_checkBEM(React,YouTube,{videoId:videoId,containerClassName:\"VideoPopup-YouTubeContainer\"// eslint-disable-next-line react/forbid-component-props\n,className:\"VideoPopup-YouTube\",opts:{playerVars:{autoplay:1}}});}},{key:\"loadVimeoLibrary\",value:function loadVimeoLibrary(){var _this2=this;this.vimeoPromise=makeCancelable(import('react-vimeo'));this.vimeoPromise.promise.then(/** @namespace Component/VideoPopup/Component/vimeoPromisePromiseThen */middleware(function(_ref){var vimeo=_ref.default;_this2.vimeoComponent=vimeo;},\"Component/VideoPopup/Component/vimeoPromisePromiseThen\"));}},{key:\"loadYouTubeLibrary\",value:function loadYouTubeLibrary(){var _this3=this;this.youTubePromise=makeCancelable(import('react-youtube'));this.youTubePromise.promise.then(/** @namespace Component/VideoPopup/Component/youTubePromisePromiseThen */middleware(function(_ref2){var youTube=_ref2.default;_this3.youTubeComponent=youTube;},\"Component/VideoPopup/Component/youTubePromisePromiseThen\"));}/**\n     * Parses the video URL and renders the video accordingly\n     * @returns {null|*}\n     * @private\n     */},{key:\"_renderVideoContent\",value:function _renderVideoContent(){var _this$props$payload$m=this.props.payload.media;_this$props$payload$m=_this$props$payload$m===void 0?{}:_this$props$payload$m;var _this$props$payload$m2=_this$props$payload$m.video_content;_this$props$payload$m2=_this$props$payload$m2===void 0?{}:_this$props$payload$m2;var video_url=_this$props$payload$m2.video_url;if(!video_url){return null;}var _ref3=VIMEO_FORMAT.exec(video_url)||[],_ref4=_slicedToArray(_ref3,2),vimeoId=_ref4[1];if(vimeoId){return this._renderVimeoVideo(vimeoId);}var _YOUTUBE_FORMAT$exec=YOUTUBE_FORMAT.exec(video_url),_YOUTUBE_FORMAT$exec2=_slicedToArray(_YOUTUBE_FORMAT$exec,2),youtubeId=_YOUTUBE_FORMAT$exec2[1];if(youtubeId){return this._renderYoutubeVideo(youtubeId);}return null;}},{key:\"render\",value:function render(){return/*#__PURE__*/_checkBEM(React,Popup,{id:VIDEO_POPUP_ID,mix:{block:'VideoPopup'}},/*#__PURE__*/_checkBEM(React,\"div\",{block:\"VideoPopup\",elem:\"VideoPlayer\"},/*#__PURE__*/_checkBEM(React,\"div\",{block:\"VideoPopup\",elem:\"PlayerContent\"},this._renderVideoContent())));}}]);return _VideoPopup;}(Extensible(PureComponent));Object.defineProperty(_VideoPopup,'name',{value:'VideoPopup'});export var VideoPopup=middleware(_VideoPopup,\"Component/VideoPopup/Component\");export default VideoPopup;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/VideoPopup/VideoPopup.component.js"],"names":["PureComponent","Popup","MediaItemType","makeCancelable","VIDEO_POPUP_ID","VIMEO_FORMAT","YOUTUBE_FORMAT","VideoPopup","loadVimeoLibrary","loadYouTubeLibrary","Promise","all","vimeoPromise","youTubePromise","then","forceUpdate","cancel","videoId","Vimeo","vimeoComponent","YouTube","youTubeComponent","playerVars","autoplay","promise","vimeo","default","youTube","props","payload","media","video_content","video_url","exec","vimeoId","_renderVimeoVideo","youtubeId","_renderYoutubeVideo","block","_renderVideoContent","Object","defineProperty","_VideoPopup","value"],"mappings":"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","sourcesContent":["/* eslint-disable react/no-unused-state */\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport { PureComponent } from 'react';\n\nimport Popup from 'Component/Popup';\nimport { MediaItemType } from 'Type/ProductList';\nimport { makeCancelable } from 'Util/Promise';\n\nimport { VIDEO_POPUP_ID, VIMEO_FORMAT, YOUTUBE_FORMAT } from './VideoPopup.config';\n\nimport './VideoPopup.style';\n\n/**\n * A popup capable of displaying a video\n * @class VideoPopup\n * @namespace Component/VideoPopup/Component\n */\nexport class VideoPopup extends PureComponent {\n    static propTypes = {\n        payload: MediaItemType.isRequired\n    };\n\n    componentDidMount() {\n        this.loadVimeoLibrary();\n        this.loadYouTubeLibrary();\n\n        Promise.all([\n            this.vimeoPromise,\n            this.youTubePromise\n        ]).then(\n            /** @namespace Component/VideoPopup/Component/videoLibrariesThen */\n            () => this.forceUpdate()\n        );\n    }\n\n    componentWillUnmount() {\n        if (this.youTubePromise) {\n            this.youTubePromise.cancel();\n        }\n\n        if (this.vimeoPromise) {\n            this.vimeoPromise.cancel();\n        }\n    }\n\n    /**\n     * Renders a video provided by Vimeo\n     * @param videoId\n     * @returns {*}\n     * @private\n     */\n    _renderVimeoVideo(videoId) {\n        const Vimeo = this.vimeoComponent;\n\n        if (!Vimeo) {\n            return null;\n        }\n\n        return (\n            <Vimeo\n              videoId={ videoId }\n              autoplay\n            />\n        );\n    }\n\n    /**\n     * Renders a video provided by Youtube\n     * @param videoId\n     * @returns {*}\n     * @private\n     */\n    _renderYoutubeVideo(videoId) {\n        const YouTube = this.youTubeComponent;\n\n        if (!YouTube) {\n            return null;\n        }\n\n        return (\n            <YouTube\n              videoId={ videoId }\n              containerClassName=\"VideoPopup-YouTubeContainer\"\n              // eslint-disable-next-line react/forbid-component-props\n              className=\"VideoPopup-YouTube\"\n              opts={ { playerVars: { autoplay: 1 } } }\n            />\n        );\n    }\n\n    loadVimeoLibrary() {\n        this.vimeoPromise = makeCancelable(import('react-vimeo'));\n\n        this.vimeoPromise.promise.then(\n            /** @namespace Component/VideoPopup/Component/vimeoPromisePromiseThen */\n            ({ default: vimeo }) => {\n                this.vimeoComponent = vimeo;\n            }\n        );\n    }\n\n    loadYouTubeLibrary() {\n        this.youTubePromise = makeCancelable(import('react-youtube'));\n\n        this.youTubePromise.promise.then(\n            /** @namespace Component/VideoPopup/Component/youTubePromisePromiseThen */\n            ({ default: youTube }) => {\n                this.youTubeComponent = youTube;\n            }\n        );\n    }\n\n    /**\n     * Parses the video URL and renders the video accordingly\n     * @returns {null|*}\n     * @private\n     */\n    _renderVideoContent() {\n        const {\n            payload: {\n                media: {\n                    video_content: { video_url } = {}\n                } = {}\n            }\n        } = this.props;\n\n        if (!video_url) {\n            return null;\n        }\n\n        const [, vimeoId] = VIMEO_FORMAT.exec(video_url) || [];\n        if (vimeoId) {\n            return this._renderVimeoVideo(vimeoId);\n        }\n\n        const [, youtubeId] = YOUTUBE_FORMAT.exec(video_url);\n        if (youtubeId) {\n            return this._renderYoutubeVideo(youtubeId);\n        }\n\n        return null;\n    }\n\n    render() {\n        return (\n            <Popup id={ VIDEO_POPUP_ID } mix={ { block: 'VideoPopup' } }>\n                <div block=\"VideoPopup\" elem=\"VideoPlayer\">\n                    <div block=\"VideoPopup\" elem=\"PlayerContent\">\n                        { this._renderVideoContent() }\n                    </div>\n                </div>\n            </Popup>\n        );\n    }\n}\n\nexport default VideoPopup;\n"]},"metadata":{},"sourceType":"module"}