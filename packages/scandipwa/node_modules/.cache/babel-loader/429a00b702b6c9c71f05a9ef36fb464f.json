{"ast":null,"code":"import _defineProperty from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import CartCoupon from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CartCoupon\";import CheckoutBilling from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CheckoutBilling\";import CheckoutGuestForm from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CheckoutGuestForm\";import CheckoutOrderSummary from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CheckoutOrderSummary\";import CheckoutShipping from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CheckoutShipping\";import CheckoutSuccess from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CheckoutSuccess\";import CmsBlock from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/CmsBlock\";import ContentWrapper from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ContentWrapper\";import ExpandableContent from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ExpandableContent\";import{CHECKOUT,CHECKOUT_SUCCESS}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/Header/Header.config\";import Loader from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/Loader\";import{addressType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Account\";import{paymentMethodsType,shippingMethodsType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Checkout\";import{HistoryType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Common\";import{TotalsType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/MiniCart\";import{appendWithStoreCode}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Url\";import{BILLING_STEP,CHECKOUT_URL,DETAILS_STEP,SHIPPING_STEP}from\"./Checkout.config\";import\"./Checkout.style\";/** @namespace Route/Checkout/Component */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _Checkout=/*#__PURE__*/function(_Extensible){_inherits(_Checkout,_Extensible);var _super=_createSuper(_Checkout);function _Checkout(){var _this$stepMap;var _this;_classCallCheck(this,_Checkout);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.stepMap=(_this$stepMap={},_defineProperty(_this$stepMap,SHIPPING_STEP,{title:__('Shipping step'),url:'/shipping',render:_this.renderShippingStep.bind(_assertThisInitialized(_this)),areTotalsVisible:true,renderCartCoupon:_this.renderCartCoupon.bind(_assertThisInitialized(_this))}),_defineProperty(_this$stepMap,BILLING_STEP,{title:__('Billing step'),url:'/billing',render:_this.renderBillingStep.bind(_assertThisInitialized(_this)),areTotalsVisible:true,renderCartCoupon:_this.renderCartCoupon.bind(_assertThisInitialized(_this))}),_defineProperty(_this$stepMap,DETAILS_STEP,{title:__('Thank you for your purchase!'),url:'/success',render:_this.renderDetailsStep.bind(_assertThisInitialized(_this)),areTotalsVisible:false}),_this$stepMap);return _this;}_createClass(_Checkout,[{key:\"componentDidMount\",value:function componentDidMount(){var _this$props=this.props,checkoutStep=_this$props.checkoutStep,history=_this$props.history;var url=this.stepMap[checkoutStep].url;this.updateHeader();history.replace(appendWithStoreCode(\"\".concat(CHECKOUT_URL).concat(url)));}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var checkoutStep=this.props.checkoutStep;var prevCheckoutStep=prevProps.checkoutStep;if(checkoutStep!==prevCheckoutStep){this.updateHeader();this.updateStep();}}},{key:\"updateHeader\",value:function updateHeader(){var _this$props2=this.props,setHeaderState=_this$props2.setHeaderState,checkoutStep=_this$props2.checkoutStep,goBack=_this$props2.goBack;var _this$stepMap$checkou=this.stepMap[checkoutStep].title,title=_this$stepMap$checkou===void 0?'':_this$stepMap$checkou;setHeaderState({name:checkoutStep===DETAILS_STEP?CHECKOUT_SUCCESS:CHECKOUT,title:title,onBackClick:function onBackClick(){return goBack();}});}},{key:\"updateStep\",value:function updateStep(){var _this$props3=this.props,checkoutStep=_this$props3.checkoutStep,history=_this$props3.history;var url=this.stepMap[checkoutStep].url;history.push(appendWithStoreCode(\"\".concat(CHECKOUT_URL).concat(url)));}},{key:\"renderTitle\",value:function renderTitle(){var checkoutStep=this.props.checkoutStep;var _this$stepMap$checkou2=this.stepMap[checkoutStep].title,title=_this$stepMap$checkou2===void 0?'':_this$stepMap$checkou2;return/*#__PURE__*/_checkBEM(React,\"h2\",{block:\"Checkout\",elem:\"Title\"},title);}},{key:\"renderGuestForm\",value:function renderGuestForm(){var _this$props4=this.props,checkoutStep=_this$props4.checkoutStep,isCreateUser=_this$props4.isCreateUser,onEmailChange=_this$props4.onEmailChange,onCreateUserChange=_this$props4.onCreateUserChange,onPasswordChange=_this$props4.onPasswordChange,isGuestEmailSaved=_this$props4.isGuestEmailSaved;var isBilling=checkoutStep===BILLING_STEP;return/*#__PURE__*/_checkBEM(React,CheckoutGuestForm,{isBilling:isBilling,isCreateUser:isCreateUser,onEmailChange:onEmailChange,onCreateUserChange:onCreateUserChange,onPasswordChange:onPasswordChange,isGuestEmailSaved:isGuestEmailSaved});}},{key:\"renderShippingStep\",value:function renderShippingStep(){var _this$props5=this.props,shippingMethods=_this$props5.shippingMethods,onShippingEstimationFieldsChange=_this$props5.onShippingEstimationFieldsChange,saveAddressInformation=_this$props5.saveAddressInformation,isDeliveryOptionsLoading=_this$props5.isDeliveryOptionsLoading,onPasswordChange=_this$props5.onPasswordChange,onCreateUserChange=_this$props5.onCreateUserChange,onEmailChange=_this$props5.onEmailChange,isCreateUser=_this$props5.isCreateUser,estimateAddress=_this$props5.estimateAddress;return/*#__PURE__*/_checkBEM(React,CheckoutShipping,{isLoading:isDeliveryOptionsLoading,shippingMethods:shippingMethods,saveAddressInformation:saveAddressInformation,onShippingEstimationFieldsChange:onShippingEstimationFieldsChange,onPasswordChange:onPasswordChange,onCreateUserChange:onCreateUserChange,onEmailChange:onEmailChange,isCreateUser:isCreateUser,estimateAddress:estimateAddress});}},{key:\"renderBillingStep\",value:function renderBillingStep(){var _this$props6=this.props,setLoading=_this$props6.setLoading,setDetailsStep=_this$props6.setDetailsStep,shippingAddress=_this$props6.shippingAddress,_this$props6$paymentM=_this$props6.paymentMethods,paymentMethods=_this$props6$paymentM===void 0?[]:_this$props6$paymentM,savePaymentInformation=_this$props6.savePaymentInformation,selectedShippingMethod=_this$props6.selectedShippingMethod;return/*#__PURE__*/_checkBEM(React,CheckoutBilling,{setLoading:setLoading,paymentMethods:paymentMethods,setDetailsStep:setDetailsStep,shippingAddress:shippingAddress,savePaymentInformation:savePaymentInformation,selectedShippingMethod:selectedShippingMethod});}},{key:\"renderDetailsStep\",value:function renderDetailsStep(){var _this$props7=this.props,orderID=_this$props7.orderID,isEmailAvailable=_this$props7.isEmailAvailable,email=_this$props7.email,_this$props7$billingA=_this$props7.billingAddress,firstname=_this$props7$billingA.firstname,lastname=_this$props7$billingA.lastname;return/*#__PURE__*/_checkBEM(React,CheckoutSuccess,{email:email,firstName:firstname,lastName:lastname,isEmailAvailable:isEmailAvailable,orderID:orderID});}},{key:\"renderStep\",value:function renderStep(){var checkoutStep=this.props.checkoutStep;var render=this.stepMap[checkoutStep].render;if(render){return render();}return null;}},{key:\"renderLoader\",value:function renderLoader(){var isLoading=this.props.isLoading;return/*#__PURE__*/_checkBEM(React,Loader,{isLoading:isLoading});}},{key:\"renderSummary\",value:function renderSummary(){var _this2=this;var showOnMobile=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var _this$props8=this.props,checkoutTotals=_this$props8.checkoutTotals,checkoutStep=_this$props8.checkoutStep,paymentTotals=_this$props8.paymentTotals,isMobile=_this$props8.isMobile,coupon_code=_this$props8.totals.coupon_code,onCouponCodeUpdate=_this$props8.onCouponCodeUpdate;var areTotalsVisible=this.stepMap[checkoutStep].areTotalsVisible;if(!areTotalsVisible||showOnMobile&&!isMobile||!showOnMobile&&isMobile){return null;}return/*#__PURE__*/_checkBEM(React,CheckoutOrderSummary,{checkoutStep:checkoutStep,totals:checkoutTotals,paymentTotals:paymentTotals,isExpandable:isMobile,couponCode:coupon_code// eslint-disable-next-line react/jsx-no-bind\n,renderCmsBlock:function renderCmsBlock(){return _this2.renderPromo(true);},onCouponCodeUpdate:onCouponCodeUpdate});}},{key:\"renderCoupon\",value:function renderCoupon(){var checkoutStep=this.props.checkoutStep;var renderCartCoupon=this.stepMap[checkoutStep].renderCartCoupon;if(renderCartCoupon){return renderCartCoupon();}return null;}},{key:\"renderCartCoupon\",value:function renderCartCoupon(){var _this$props9=this.props,coupon_code=_this$props9.totals.coupon_code,isMobile=_this$props9.isMobile,onCouponCodeUpdate=_this$props9.onCouponCodeUpdate,checkoutStep=_this$props9.checkoutStep;if(isMobile||checkoutStep===SHIPPING_STEP){return null;}return/*#__PURE__*/_checkBEM(React,ExpandableContent,{heading:__('Have a discount code?'),mix:{block:'Checkout',elem:'Coupon'}},/*#__PURE__*/_checkBEM(React,CartCoupon,{couponCode:coupon_code,onCouponCodeUpdate:onCouponCodeUpdate}));}},{key:\"renderPromo\",value:function renderPromo(){var showOnMobile=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var _this$props10=this.props,checkoutStep=_this$props10.checkoutStep,isMobile=_this$props10.isMobile;var isBilling=checkoutStep===BILLING_STEP;if(!showOnMobile&&isMobile){return null;}var _window$contentConfig=window.contentConfiguration.checkout_content;_window$contentConfig=_window$contentConfig===void 0?{}:_window$contentConfig;var promo=_window$contentConfig[isBilling?'checkout_billing_cms':'checkout_shipping_cms'];if(!promo){return null;}return/*#__PURE__*/_checkBEM(React,CmsBlock,{identifier:promo});}},{key:\"render\",value:function render(){return/*#__PURE__*/_checkBEM(React,\"main\",{block:\"Checkout\"},/*#__PURE__*/_checkBEM(React,ContentWrapper,{wrapperMix:{block:'Checkout',elem:'Wrapper'},label:__('Checkout page')},this.renderSummary(true),/*#__PURE__*/_checkBEM(React,\"div\",{block:\"Checkout\",elem:\"Step\"},this.renderTitle(),this.renderGuestForm(),this.renderStep(),this.renderLoader()),/*#__PURE__*/_checkBEM(React,\"div\",null,this.renderSummary(),this.renderPromo(),this.renderCoupon())));}}]);return _Checkout;}(Extensible(PureComponent));_Checkout.defaultProps={paymentTotals:{}};Object.defineProperty(_Checkout,'name',{value:'Checkout'});export var Checkout=middleware(_Checkout,\"Route/Checkout/Component\");export default Checkout;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/route/Checkout/Checkout.component.js"],"names":["PureComponent","CartCoupon","CheckoutBilling","CheckoutGuestForm","CheckoutOrderSummary","CheckoutShipping","CheckoutSuccess","CmsBlock","ContentWrapper","ExpandableContent","CHECKOUT","CHECKOUT_SUCCESS","Loader","addressType","paymentMethodsType","shippingMethodsType","HistoryType","TotalsType","appendWithStoreCode","BILLING_STEP","CHECKOUT_URL","DETAILS_STEP","SHIPPING_STEP","Checkout","stepMap","title","__","url","render","renderShippingStep","bind","areTotalsVisible","renderCartCoupon","renderBillingStep","renderDetailsStep","props","checkoutStep","history","updateHeader","replace","prevProps","prevCheckoutStep","updateStep","setHeaderState","goBack","name","onBackClick","push","isCreateUser","onEmailChange","onCreateUserChange","onPasswordChange","isGuestEmailSaved","isBilling","shippingMethods","onShippingEstimationFieldsChange","saveAddressInformation","isDeliveryOptionsLoading","estimateAddress","setLoading","setDetailsStep","shippingAddress","paymentMethods","savePaymentInformation","selectedShippingMethod","orderID","isEmailAvailable","email","billingAddress","firstname","lastname","isLoading","showOnMobile","checkoutTotals","paymentTotals","isMobile","coupon_code","totals","onCouponCodeUpdate","renderPromo","block","elem","window","contentConfiguration","checkout_content","promo","renderSummary","renderTitle","renderGuestForm","renderStep","renderLoader","renderCoupon","defaultProps","Object","defineProperty","_Checkout","value"],"mappings":"w2BAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAGA,OAASA,aAAT,KAA8B,OAA9B,CAEA,MAAOC,CAAAA,UAAP,8EACA,MAAOC,CAAAA,eAAP,mFACA,MAAOC,CAAAA,iBAAP,qFACA,MAAOC,CAAAA,oBAAP,wFACA,MAAOC,CAAAA,gBAAP,oFACA,MAAOC,CAAAA,eAAP,mFACA,MAAOC,CAAAA,QAAP,4EACA,MAAOC,CAAAA,cAAP,kFACA,MAAOC,CAAAA,iBAAP,qFACA,OAASC,QAAT,CAAmBC,gBAAnB,wFACA,MAAOC,CAAAA,MAAP,0EACA,OAASC,WAAT,sEACA,OAASC,kBAAT,CAA6BC,mBAA7B,uEACA,OAASC,WAAT,qEACA,OAASC,UAAT,uEACA,OAASC,mBAAT,kEAEA,OACIC,YADJ,CAEIC,YAFJ,CAGIC,YAHJ,CAIIC,aAJJ,yBAOA,yBAEA,0C,wEACA,UAAaC,CAAAA,SAAb,2VA0CIC,OA1CJ,iDA2CSF,aA3CT,CA2CyB,CACbG,KAAK,CAAEC,EAAE,CAAC,eAAD,CADI,CAEbC,GAAG,CAAE,WAFQ,CAGbC,MAAM,CAAE,MAAKC,kBAAL,CAAwBC,IAAxB,+BAHK,CAIbC,gBAAgB,CAAE,IAJL,CAKbC,gBAAgB,CAAE,MAAKA,gBAAL,CAAsBF,IAAtB,+BALL,CA3CzB,gCAkDSX,YAlDT,CAkDwB,CACZM,KAAK,CAAEC,EAAE,CAAC,cAAD,CADG,CAEZC,GAAG,CAAE,UAFO,CAGZC,MAAM,CAAE,MAAKK,iBAAL,CAAuBH,IAAvB,+BAHI,CAIZC,gBAAgB,CAAE,IAJN,CAKZC,gBAAgB,CAAE,MAAKA,gBAAL,CAAsBF,IAAtB,+BALN,CAlDxB,gCAyDST,YAzDT,CAyDwB,CACZI,KAAK,CAAEC,EAAE,CAAC,8BAAD,CADG,CAEZC,GAAG,CAAE,UAFO,CAGZC,MAAM,CAAE,MAAKM,iBAAL,CAAuBJ,IAAvB,+BAHI,CAIZC,gBAAgB,CAAE,KAJN,CAzDxB,sFAiEI,4BAAoB,iBACkB,KAAKI,KADvB,CACRC,YADQ,aACRA,YADQ,CACMC,OADN,aACMA,OADN,IAERV,CAAAA,GAFQ,CAEA,KAAKH,OAAL,CAAaY,YAAb,CAFA,CAERT,GAFQ,CAIhB,KAAKW,YAAL,GAEAD,OAAO,CAACE,OAAR,CAAgBrB,mBAAmB,WAAKE,YAAL,SAAsBO,GAAtB,EAAnC,EACH,CAxEL,kCA0EI,4BAAmBa,SAAnB,CAA8B,IAClBJ,CAAAA,YADkB,CACD,KAAKD,KADJ,CAClBC,YADkB,IAEJK,CAAAA,gBAFI,CAEiBD,SAFjB,CAElBJ,YAFkB,CAI1B,GAAIA,YAAY,GAAKK,gBAArB,CAAuC,CACnC,KAAKH,YAAL,GACA,KAAKI,UAAL,GACH,CACJ,CAlFL,4BAoFI,uBAAe,kBACsC,KAAKP,KAD3C,CACHQ,cADG,cACHA,cADG,CACaP,YADb,cACaA,YADb,CAC2BQ,MAD3B,cAC2BA,MAD3B,2BAEY,KAAKpB,OAAL,CAAaY,YAAb,CAFZ,CAEHX,KAFG,CAEHA,KAFG,gCAEK,EAFL,uBAIXkB,cAAc,CAAC,CACXE,IAAI,CAAET,YAAY,GAAKf,YAAjB,CAAgCV,gBAAhC,CAAmDD,QAD9C,CAEXe,KAAK,CAALA,KAFW,CAGXqB,WAAW,CAAE,6BAAMF,CAAAA,MAAM,EAAZ,EAHF,CAAD,CAAd,CAKH,CA7FL,0BA+FI,qBAAa,kBACyB,KAAKT,KAD9B,CACDC,YADC,cACDA,YADC,CACaC,OADb,cACaA,OADb,IAEDV,CAAAA,GAFC,CAEO,KAAKH,OAAL,CAAaY,YAAb,CAFP,CAEDT,GAFC,CAITU,OAAO,CAACU,IAAR,CAAa7B,mBAAmB,WAAKE,YAAL,SAAsBO,GAAtB,EAAhC,EACH,CApGL,2BAsGI,sBAAc,IACFS,CAAAA,YADE,CACe,KAAKD,KADpB,CACFC,YADE,4BAEa,KAAKZ,OAAL,CAAaY,YAAb,CAFb,CAEFX,KAFE,CAEFA,KAFE,iCAEM,EAFN,wBAIV,yCACQ,KAAK,CAAC,UADd,CACyB,IAAI,CAAC,OAD9B,EAEUA,KAFV,EAKH,CA/GL,+BAiHI,0BAAkB,kBAQV,KAAKU,KARK,CAEVC,YAFU,cAEVA,YAFU,CAGVY,YAHU,cAGVA,YAHU,CAIVC,aAJU,cAIVA,aAJU,CAKVC,kBALU,cAKVA,kBALU,CAMVC,gBANU,cAMVA,gBANU,CAOVC,iBAPU,cAOVA,iBAPU,CASd,GAAMC,CAAAA,SAAS,CAAGjB,YAAY,GAAKjB,YAAnC,CAEA,mCACK,iBADL,EAEM,SAAS,CAAGkC,SAFlB,CAGM,YAAY,CAAGL,YAHrB,CAIM,aAAa,CAAGC,aAJtB,CAKM,kBAAkB,CAAGC,kBAL3B,CAMM,gBAAgB,CAAGC,gBANzB,CAOM,iBAAiB,CAAGC,iBAP1B,GAUH,CAtIL,kCAwII,6BAAqB,kBAWb,KAAKjB,KAXQ,CAEbmB,eAFa,cAEbA,eAFa,CAGbC,gCAHa,cAGbA,gCAHa,CAIbC,sBAJa,cAIbA,sBAJa,CAKbC,wBALa,cAKbA,wBALa,CAMbN,gBANa,cAMbA,gBANa,CAObD,kBAPa,cAObA,kBAPa,CAQbD,aARa,cAQbA,aARa,CASbD,YATa,cASbA,YATa,CAUbU,eAVa,cAUbA,eAVa,CAajB,mCACK,gBADL,EAEM,SAAS,CAAGD,wBAFlB,CAGM,eAAe,CAAGH,eAHxB,CAIM,sBAAsB,CAAGE,sBAJ/B,CAKM,gCAAgC,CAAGD,gCALzC,CAMM,gBAAgB,CAAGJ,gBANzB,CAOM,kBAAkB,CAAGD,kBAP3B,CAQM,aAAa,CAAGD,aARtB,CASM,YAAY,CAAGD,YATrB,CAUM,eAAe,CAAGU,eAVxB,GAaH,CAlKL,iCAoKI,4BAAoB,kBAQZ,KAAKvB,KARO,CAEZwB,UAFY,cAEZA,UAFY,CAGZC,cAHY,cAGZA,cAHY,CAIZC,eAJY,cAIZA,eAJY,oCAKZC,cALY,CAKZA,cALY,gCAKK,EALL,uBAMZC,sBANY,cAMZA,sBANY,CAOZC,sBAPY,cAOZA,sBAPY,CAUhB,mCACK,eADL,EAEM,UAAU,CAAGL,UAFnB,CAGM,cAAc,CAAGG,cAHvB,CAIM,cAAc,CAAGF,cAJvB,CAKM,eAAe,CAAGC,eALxB,CAMM,sBAAsB,CAAGE,sBAN/B,CAOM,sBAAsB,CAAGC,sBAP/B,GAUH,CAxLL,iCA0LI,4BAAoB,kBASZ,KAAK7B,KATO,CAEZ8B,OAFY,cAEZA,OAFY,CAGZC,gBAHY,cAGZA,gBAHY,CAIZC,KAJY,cAIZA,KAJY,oCAKZC,cALY,CAMRC,SANQ,uBAMRA,SANQ,CAORC,QAPQ,uBAORA,QAPQ,CAWhB,mCACK,eADL,EAEM,KAAK,CAAGH,KAFd,CAGM,SAAS,CAAGE,SAHlB,CAIM,QAAQ,CAAGC,QAJjB,CAKM,gBAAgB,CAAGJ,gBALzB,CAMM,OAAO,CAAGD,OANhB,GASH,CA9ML,0BAgNI,qBAAa,IACD7B,CAAAA,YADC,CACgB,KAAKD,KADrB,CACDC,YADC,IAEDR,CAAAA,MAFC,CAEU,KAAKJ,OAAL,CAAaY,YAAb,CAFV,CAEDR,MAFC,CAGT,GAAIA,MAAJ,CAAY,CACR,MAAOA,CAAAA,MAAM,EAAb,CACH,CAED,MAAO,KAAP,CACH,CAxNL,4BA0NI,uBAAe,IACH2C,CAAAA,SADG,CACW,KAAKpC,KADhB,CACHoC,SADG,CAEX,mCAAQ,MAAR,EAAe,SAAS,CAAGA,SAA3B,GACH,CA7NL,6BA+NI,wBAAoC,oBAAtBC,CAAAA,YAAsB,2DAAP,KAAO,kBAQ5B,KAAKrC,KARuB,CAE5BsC,cAF4B,cAE5BA,cAF4B,CAG5BrC,YAH4B,cAG5BA,YAH4B,CAI5BsC,aAJ4B,cAI5BA,aAJ4B,CAK5BC,QAL4B,cAK5BA,QAL4B,CAMlBC,WANkB,cAM5BC,MAN4B,CAMlBD,WANkB,CAO5BE,kBAP4B,cAO5BA,kBAP4B,IASxB/C,CAAAA,gBATwB,CASH,KAAKP,OAAL,CAAaY,YAAb,CATG,CASxBL,gBATwB,CAWhC,GAAI,CAACA,gBAAD,EAAsByC,YAAY,EAAI,CAACG,QAAvC,EAAqD,CAACH,YAAD,EAAiBG,QAA1E,CAAqF,CACjF,MAAO,KAAP,CACH,CAED,mCACK,oBADL,EAEM,YAAY,CAAGvC,YAFrB,CAGM,MAAM,CAAGqC,cAHf,CAIM,aAAa,CAAGC,aAJtB,CAKM,YAAY,CAAGC,QALrB,CAMM,UAAU,CAAGC,WACb;AAPN,CAQM,cAAc,CAAG,gCAAM,CAAA,MAAI,CAACG,WAAL,CAAiB,IAAjB,CAAN,EARvB,CASM,kBAAkB,CAAGD,kBAT3B,GAYH,CA1PL,4BA4PI,uBAAe,IACH1C,CAAAA,YADG,CACc,KAAKD,KADnB,CACHC,YADG,IAEHJ,CAAAA,gBAFG,CAEkB,KAAKR,OAAL,CAAaY,YAAb,CAFlB,CAEHJ,gBAFG,CAIX,GAAIA,gBAAJ,CAAsB,CAClB,MAAOA,CAAAA,gBAAgB,EAAvB,CACH,CAED,MAAO,KAAP,CACH,CArQL,gCAuQI,2BAAmB,kBAMX,KAAKG,KANM,CAEDyC,WAFC,cAEXC,MAFW,CAEDD,WAFC,CAGXD,QAHW,cAGXA,QAHW,CAIXG,kBAJW,cAIXA,kBAJW,CAKX1C,YALW,cAKXA,YALW,CAQf,GAAIuC,QAAQ,EAAIvC,YAAY,GAAKd,aAAjC,CAAgD,CAC5C,MAAO,KAAP,CACH,CAED,mCACK,iBADL,EAEM,OAAO,CAAGI,EAAE,CAAC,uBAAD,CAFlB,CAGM,GAAG,CAAG,CAAEsD,KAAK,CAAE,UAAT,CAAqBC,IAAI,CAAE,QAA3B,CAHZ,+BAKS,UALT,EAMU,UAAU,CAAGL,WANvB,CAOU,kBAAkB,CAAGE,kBAP/B,IAWH,CA9RL,2BAgSI,sBAAkC,IAAtBN,CAAAA,YAAsB,2DAAP,KAAO,mBACK,KAAKrC,KADV,CACtBC,YADsB,eACtBA,YADsB,CACRuC,QADQ,eACRA,QADQ,CAE9B,GAAMtB,CAAAA,SAAS,CAAGjB,YAAY,GAAKjB,YAAnC,CAEA,GAAI,CAACqD,YAAD,EAAiBG,QAArB,CAA+B,CAC3B,MAAO,KAAP,CACH,CAN6B,0BAY1BO,MAAM,CAACC,oBAZmB,CAS1BC,gBAT0B,sDAWtB,EAXsB,0BAU0CC,CAAAA,KAV1C,uBAUrBhC,SAAS,CAAG,sBAAH,CAA4B,uBAVhB,EAc9B,GAAI,CAACgC,KAAL,CAAY,CACR,MAAO,KAAP,CACH,CAED,mCAAQ,QAAR,EAAiB,UAAU,CAAGA,KAA9B,GACH,CAnTL,sBAqTI,iBAAS,CACL,2CACU,KAAK,CAAC,UADhB,+BAES,cAFT,EAGU,UAAU,CAAG,CAAEL,KAAK,CAAE,UAAT,CAAqBC,IAAI,CAAE,SAA3B,CAHvB,CAIU,KAAK,CAAGvD,EAAE,CAAC,eAAD,CAJpB,EAMc,KAAK4D,aAAL,CAAmB,IAAnB,CANd,qCAOiB,KAAK,CAAC,UAPvB,CAOkC,IAAI,CAAC,MAPvC,EAQkB,KAAKC,WAAL,EARlB,CASkB,KAAKC,eAAL,EATlB,CAUkB,KAAKC,UAAL,EAVlB,CAWkB,KAAKC,YAAL,EAXlB,0CAckB,KAAKJ,aAAL,EAdlB,CAekB,KAAKP,WAAL,EAflB,CAgBkB,KAAKY,YAAL,EAhBlB,IAqBH,CA3UL,kDAAapE,S,CAsCFqE,Y,CAAe,CAClBlB,aAAa,CAAE,EADG,C,CA/E1BmB,MAAM,CAACC,cAAP,CAAsBC,SAAtB,CAAiC,MAAjC,CAAyC,CAAEC,KAAK,CAAE,UAAT,CAAzC,E,qEAuXA,cAAezE,CAAAA,QAAf","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\n\nimport CartCoupon from 'Component/CartCoupon';\nimport CheckoutBilling from 'Component/CheckoutBilling';\nimport CheckoutGuestForm from 'Component/CheckoutGuestForm';\nimport CheckoutOrderSummary from 'Component/CheckoutOrderSummary';\nimport CheckoutShipping from 'Component/CheckoutShipping';\nimport CheckoutSuccess from 'Component/CheckoutSuccess';\nimport CmsBlock from 'Component/CmsBlock';\nimport ContentWrapper from 'Component/ContentWrapper';\nimport ExpandableContent from 'Component/ExpandableContent';\nimport { CHECKOUT, CHECKOUT_SUCCESS } from 'Component/Header/Header.config';\nimport Loader from 'Component/Loader';\nimport { addressType } from 'Type/Account';\nimport { paymentMethodsType, shippingMethodsType } from 'Type/Checkout';\nimport { HistoryType } from 'Type/Common';\nimport { TotalsType } from 'Type/MiniCart';\nimport { appendWithStoreCode } from 'Util/Url';\n\nimport {\n    BILLING_STEP,\n    CHECKOUT_URL,\n    DETAILS_STEP,\n    SHIPPING_STEP\n} from './Checkout.config';\n\nimport './Checkout.style';\n\n/** @namespace Route/Checkout/Component */\nexport class Checkout extends PureComponent {\n    static propTypes = {\n        setLoading: PropTypes.func.isRequired,\n        setDetailsStep: PropTypes.func.isRequired,\n        shippingMethods: shippingMethodsType.isRequired,\n        onShippingEstimationFieldsChange: PropTypes.func.isRequired,\n        setHeaderState: PropTypes.func.isRequired,\n        paymentMethods: paymentMethodsType.isRequired,\n        saveAddressInformation: PropTypes.func.isRequired,\n        savePaymentInformation: PropTypes.func.isRequired,\n        isLoading: PropTypes.bool.isRequired,\n        isDeliveryOptionsLoading: PropTypes.bool.isRequired,\n        shippingAddress: addressType.isRequired,\n        billingAddress: addressType.isRequired,\n        estimateAddress: addressType.isRequired,\n        checkoutTotals: TotalsType.isRequired,\n        orderID: PropTypes.string.isRequired,\n        email: PropTypes.string.isRequired,\n        isEmailAvailable: PropTypes.bool.isRequired,\n        selectedShippingMethod: PropTypes.string.isRequired,\n        history: HistoryType.isRequired,\n        onEmailChange: PropTypes.func.isRequired,\n        paymentTotals: TotalsType,\n        checkoutStep: PropTypes.oneOf([\n            SHIPPING_STEP,\n            BILLING_STEP,\n            DETAILS_STEP\n        ]).isRequired,\n        isCreateUser: PropTypes.bool.isRequired,\n        onCreateUserChange: PropTypes.func.isRequired,\n        onPasswordChange: PropTypes.func.isRequired,\n        isGuestEmailSaved: PropTypes.bool.isRequired,\n        goBack: PropTypes.func.isRequired,\n        totals: TotalsType.isRequired,\n        isMobile: PropTypes.bool.isRequired,\n        onCouponCodeUpdate: PropTypes.func.isRequired\n    };\n\n    static defaultProps = {\n        paymentTotals: {}\n    };\n\n    stepMap = {\n        [SHIPPING_STEP]: {\n            title: __('Shipping step'),\n            url: '/shipping',\n            render: this.renderShippingStep.bind(this),\n            areTotalsVisible: true,\n            renderCartCoupon: this.renderCartCoupon.bind(this)\n        },\n        [BILLING_STEP]: {\n            title: __('Billing step'),\n            url: '/billing',\n            render: this.renderBillingStep.bind(this),\n            areTotalsVisible: true,\n            renderCartCoupon: this.renderCartCoupon.bind(this)\n        },\n        [DETAILS_STEP]: {\n            title: __('Thank you for your purchase!'),\n            url: '/success',\n            render: this.renderDetailsStep.bind(this),\n            areTotalsVisible: false\n        }\n    };\n\n    componentDidMount() {\n        const { checkoutStep, history } = this.props;\n        const { url } = this.stepMap[checkoutStep];\n\n        this.updateHeader();\n\n        history.replace(appendWithStoreCode(`${ CHECKOUT_URL }${ url }`));\n    }\n\n    componentDidUpdate(prevProps) {\n        const { checkoutStep } = this.props;\n        const { checkoutStep: prevCheckoutStep } = prevProps;\n\n        if (checkoutStep !== prevCheckoutStep) {\n            this.updateHeader();\n            this.updateStep();\n        }\n    }\n\n    updateHeader() {\n        const { setHeaderState, checkoutStep, goBack } = this.props;\n        const { title = '' } = this.stepMap[checkoutStep];\n\n        setHeaderState({\n            name: checkoutStep === DETAILS_STEP ? CHECKOUT_SUCCESS : CHECKOUT,\n            title,\n            onBackClick: () => goBack()\n        });\n    }\n\n    updateStep() {\n        const { checkoutStep, history } = this.props;\n        const { url } = this.stepMap[checkoutStep];\n\n        history.push(appendWithStoreCode(`${ CHECKOUT_URL }${ url }`));\n    }\n\n    renderTitle() {\n        const { checkoutStep } = this.props;\n        const { title = '' } = this.stepMap[checkoutStep];\n\n        return (\n            <h2 block=\"Checkout\" elem=\"Title\">\n                { title }\n            </h2>\n        );\n    }\n\n    renderGuestForm() {\n        const {\n            checkoutStep,\n            isCreateUser,\n            onEmailChange,\n            onCreateUserChange,\n            onPasswordChange,\n            isGuestEmailSaved\n        } = this.props;\n        const isBilling = checkoutStep === BILLING_STEP;\n\n        return (\n            <CheckoutGuestForm\n              isBilling={ isBilling }\n              isCreateUser={ isCreateUser }\n              onEmailChange={ onEmailChange }\n              onCreateUserChange={ onCreateUserChange }\n              onPasswordChange={ onPasswordChange }\n              isGuestEmailSaved={ isGuestEmailSaved }\n            />\n        );\n    }\n\n    renderShippingStep() {\n        const {\n            shippingMethods,\n            onShippingEstimationFieldsChange,\n            saveAddressInformation,\n            isDeliveryOptionsLoading,\n            onPasswordChange,\n            onCreateUserChange,\n            onEmailChange,\n            isCreateUser,\n            estimateAddress\n        } = this.props;\n\n        return (\n            <CheckoutShipping\n              isLoading={ isDeliveryOptionsLoading }\n              shippingMethods={ shippingMethods }\n              saveAddressInformation={ saveAddressInformation }\n              onShippingEstimationFieldsChange={ onShippingEstimationFieldsChange }\n              onPasswordChange={ onPasswordChange }\n              onCreateUserChange={ onCreateUserChange }\n              onEmailChange={ onEmailChange }\n              isCreateUser={ isCreateUser }\n              estimateAddress={ estimateAddress }\n            />\n        );\n    }\n\n    renderBillingStep() {\n        const {\n            setLoading,\n            setDetailsStep,\n            shippingAddress,\n            paymentMethods = [],\n            savePaymentInformation,\n            selectedShippingMethod\n        } = this.props;\n\n        return (\n            <CheckoutBilling\n              setLoading={ setLoading }\n              paymentMethods={ paymentMethods }\n              setDetailsStep={ setDetailsStep }\n              shippingAddress={ shippingAddress }\n              savePaymentInformation={ savePaymentInformation }\n              selectedShippingMethod={ selectedShippingMethod }\n            />\n        );\n    }\n\n    renderDetailsStep() {\n        const {\n            orderID,\n            isEmailAvailable,\n            email,\n            billingAddress: {\n                firstname,\n                lastname\n            }\n        } = this.props;\n\n        return (\n            <CheckoutSuccess\n              email={ email }\n              firstName={ firstname }\n              lastName={ lastname }\n              isEmailAvailable={ isEmailAvailable }\n              orderID={ orderID }\n            />\n        );\n    }\n\n    renderStep() {\n        const { checkoutStep } = this.props;\n        const { render } = this.stepMap[checkoutStep];\n        if (render) {\n            return render();\n        }\n\n        return null;\n    }\n\n    renderLoader() {\n        const { isLoading } = this.props;\n        return <Loader isLoading={ isLoading } />;\n    }\n\n    renderSummary(showOnMobile = false) {\n        const {\n            checkoutTotals,\n            checkoutStep,\n            paymentTotals,\n            isMobile,\n            totals: { coupon_code },\n            onCouponCodeUpdate\n        } = this.props;\n        const { areTotalsVisible } = this.stepMap[checkoutStep];\n\n        if (!areTotalsVisible || (showOnMobile && !isMobile) || (!showOnMobile && isMobile)) {\n            return null;\n        }\n\n        return (\n            <CheckoutOrderSummary\n              checkoutStep={ checkoutStep }\n              totals={ checkoutTotals }\n              paymentTotals={ paymentTotals }\n              isExpandable={ isMobile }\n              couponCode={ coupon_code }\n              // eslint-disable-next-line react/jsx-no-bind\n              renderCmsBlock={ () => this.renderPromo(true) }\n              onCouponCodeUpdate={ onCouponCodeUpdate }\n            />\n        );\n    }\n\n    renderCoupon() {\n        const { checkoutStep } = this.props;\n        const { renderCartCoupon } = this.stepMap[checkoutStep];\n\n        if (renderCartCoupon) {\n            return renderCartCoupon();\n        }\n\n        return null;\n    }\n\n    renderCartCoupon() {\n        const {\n            totals: { coupon_code },\n            isMobile,\n            onCouponCodeUpdate,\n            checkoutStep\n        } = this.props;\n\n        if (isMobile || checkoutStep === SHIPPING_STEP) {\n            return null;\n        }\n\n        return (\n            <ExpandableContent\n              heading={ __('Have a discount code?') }\n              mix={ { block: 'Checkout', elem: 'Coupon' } }\n            >\n                <CartCoupon\n                  couponCode={ coupon_code }\n                  onCouponCodeUpdate={ onCouponCodeUpdate }\n                />\n            </ExpandableContent>\n        );\n    }\n\n    renderPromo(showOnMobile = false) {\n        const { checkoutStep, isMobile } = this.props;\n        const isBilling = checkoutStep === BILLING_STEP;\n\n        if (!showOnMobile && isMobile) {\n            return null;\n        }\n\n        const {\n            checkout_content: {\n                [isBilling ? 'checkout_billing_cms' : 'checkout_shipping_cms']: promo\n            } = {}\n        } = window.contentConfiguration;\n\n        if (!promo) {\n            return null;\n        }\n\n        return <CmsBlock identifier={ promo } />;\n    }\n\n    render() {\n        return (\n            <main block=\"Checkout\">\n                <ContentWrapper\n                  wrapperMix={ { block: 'Checkout', elem: 'Wrapper' } }\n                  label={ __('Checkout page') }\n                >\n                    { this.renderSummary(true) }\n                    <div block=\"Checkout\" elem=\"Step\">\n                        { this.renderTitle() }\n                        { this.renderGuestForm() }\n                        { this.renderStep() }\n                        { this.renderLoader() }\n                    </div>\n                    <div>\n                        { this.renderSummary() }\n                        { this.renderPromo() }\n                        { this.renderCoupon() }\n                    </div>\n                </ContentWrapper>\n            </main>\n        );\n    }\n}\n\nexport default Checkout;\n"]},"metadata":{},"sourceType":"module"}