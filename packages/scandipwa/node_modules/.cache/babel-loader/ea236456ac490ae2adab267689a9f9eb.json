{"ast":null,"code":"import _objectSpread from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import{withRouter}from'react-router-dom';import ProductCard from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/ProductCard\";import{GRID_LAYOUT}from\"/home/marketihor/scandipwa/packages/scandipwa/src/route/CategoryPage/CategoryPage.config\";import{MixType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Common\";import{FilterType,ProductType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/ProductList\";import{DEFAULT_PLACEHOLDER_COUNT}from\"./ProductListPage.config\";import\"./ProductListPage.style\";/**\n * Placeholder for List of category product\n * @namespace Component/ProductListPage/Component\n * @class ProductListPage\n */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _ProductListPage=/*#__PURE__*/function(_Extensible){_inherits(_ProductListPage,_Extensible);var _super=_createSuper(_ProductListPage);function _ProductListPage(){var _this;_classCallCheck(this,_ProductListPage);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={siblingsHaveBrands:false,siblingsHavePriceBadge:false,siblingsHaveTierPrice:false,siblingsHaveConfigurableOptions:false};return _this;}_createClass(_ProductListPage,[{key:\"componentDidMount\",value:function componentDidMount(){this.startObserving();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.startObserving();}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.stopObserving();}},{key:\"containerProps\",value:function containerProps(){var _this2=this;var _this$state=this.state,siblingsHaveBrands=_this$state.siblingsHaveBrands,siblingsHavePriceBadge=_this$state.siblingsHavePriceBadge,siblingsHaveTierPrice=_this$state.siblingsHaveTierPrice,siblingsHaveConfigurableOptions=_this$state.siblingsHaveConfigurableOptions;return{productCardFunctions:{setSiblingsHaveBrands:function setSiblingsHaveBrands(){return _this2.setState({siblingsHaveBrands:true});},setSiblingsHavePriceBadge:function setSiblingsHavePriceBadge(){return _this2.setState({siblingsHavePriceBadge:true});},setSiblingsHaveTierPrice:function setSiblingsHaveTierPrice(){return _this2.setState({siblingsHaveTierPrice:true});},setSiblingsHaveConfigurableOptions:function setSiblingsHaveConfigurableOptions(){return _this2.setState({siblingsHaveConfigurableOptions:true});}},productCardProps:{siblingsHaveBrands:siblingsHaveBrands,siblingsHavePriceBadge:siblingsHavePriceBadge,siblingsHaveTierPrice:siblingsHaveTierPrice,siblingsHaveConfigurableOptions:siblingsHaveConfigurableOptions}};}},{key:\"startObserving\",value:function startObserving(){var _this3=this;var _this$props=this.props,items=_this$props.items,updatePages=_this$props.updatePages,isInfiniteLoaderEnabled=_this$props.isInfiniteLoaderEnabled;if(!isInfiniteLoaderEnabled||items.length){return;}if(this.node&&!this.observer&&'IntersectionObserver'in window){var options={rootMargin:'0px',threshold:0.1};this.observer=new IntersectionObserver(function(_ref){var _ref2=_slicedToArray(_ref,1),intersectionRatio=_ref2[0].intersectionRatio;var _this3$props=_this3.props,items=_this3$props.items,isLoading=_this3$props.isLoading;// must not be a product items list, and must not be loading\nif(intersectionRatio>0&&!items.length&&!isLoading){_this3.stopObserving();updatePages();}},options);this.observer.observe(this.node);}}},{key:\"stopObserving\",value:function stopObserving(){if(this.observer){if(this.observer.unobserve&&this.node){this.observer.unobserve(this.node);}if(this.observer.disconnect){this.observer.disconnect();}this.observer=null;}}},{key:\"renderPlaceholders\",value:function renderPlaceholders(){var numberOfPlaceholders=this.props.numberOfPlaceholders;return Array.from({length:numberOfPlaceholders},function(_,i){return/*#__PURE__*/_checkBEM(React,ProductCard,{key:i,product:{}});});}},{key:\"getPlaceholderRef\",value:function getPlaceholderRef(){var _this4=this;var isVisible=this.props.isVisible;if(!isVisible){return undefined;}return function(node){_this4.node=node;};}},{key:\"renderPageItems\",value:function renderPageItems(){var _this5=this;var _this$props2=this.props,items=_this$props2.items,selectedFilters=_this$props2.selectedFilters,_this$props2$mix$mods=_this$props2.mix.mods;_this$props2$mix$mods=_this$props2$mix$mods===void 0?{}:_this$props2$mix$mods;var _this$props2$mix$mods2=_this$props2$mix$mods.layout,layout=_this$props2$mix$mods2===void 0?GRID_LAYOUT:_this$props2$mix$mods2;return items.map(function(product,i){return/*#__PURE__*/_checkBEM(React,ProductCard,Object.assign({product:product// eslint-disable-next-line react/no-array-index-key\n,key:i,selectedFilters:selectedFilters,layout:layout},_this5.containerProps()));});}},{key:\"renderPlaceholderItems\",value:function renderPlaceholderItems(){return/*#__PURE__*/_checkBEM(React,React.Fragment,null,/*#__PURE__*/_checkBEM(React,\"li\",{block:\"ProductListPage\",elem:\"Offset\",ref:this.getPlaceholderRef()}),this.renderPlaceholders());}},{key:\"renderItems\",value:function renderItems(){var _this$props3=this.props,items=_this$props3.items,isLoading=_this$props3.isLoading;if(!items.length||isLoading){return this.renderPlaceholderItems();}return this.renderPageItems();}},{key:\"render\",value:function render(){var _this$props4=this.props,pageNumber=_this$props4.pageNumber,wrapperRef=_this$props4.wrapperRef,mix=_this$props4.mix;return/*#__PURE__*/_checkBEM(React,\"ul\",{block:\"ProductListPage\",mix:_objectSpread(_objectSpread({},mix),{},{elem:'Page'}),key:pageNumber,ref:wrapperRef},this.renderItems());}}]);return _ProductListPage;}(Extensible(PureComponent));_ProductListPage.defaultProps={numberOfPlaceholders:DEFAULT_PLACEHOLDER_COUNT,wrapperRef:function wrapperRef(){},selectedFilters:{},pageNumber:null,items:[],mix:{}};Object.defineProperty(_ProductListPage,'name',{value:'ProductListPage'});export var ProductListPage=middleware(_ProductListPage,\"Component/ProductListPage/Component\");export default withRouter(ProductListPage);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/ProductListPage/ProductListPage.component.js"],"names":["PureComponent","withRouter","ProductCard","GRID_LAYOUT","MixType","FilterType","ProductType","DEFAULT_PLACEHOLDER_COUNT","ProductListPage","state","siblingsHaveBrands","siblingsHavePriceBadge","siblingsHaveTierPrice","siblingsHaveConfigurableOptions","startObserving","stopObserving","productCardFunctions","setSiblingsHaveBrands","setState","setSiblingsHavePriceBadge","setSiblingsHaveTierPrice","setSiblingsHaveConfigurableOptions","productCardProps","props","items","updatePages","isInfiniteLoaderEnabled","length","node","observer","window","options","rootMargin","threshold","IntersectionObserver","intersectionRatio","isLoading","observe","unobserve","disconnect","numberOfPlaceholders","Array","from","_","i","isVisible","undefined","selectedFilters","mix","mods","layout","map","product","containerProps","getPlaceholderRef","renderPlaceholders","renderPlaceholderItems","renderPageItems","pageNumber","wrapperRef","elem","renderItems","defaultProps","Object","defineProperty","_ProductListPage","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { withRouter } from 'react-router-dom';\n\nimport ProductCard from 'Component/ProductCard';\nimport { GRID_LAYOUT } from 'Route/CategoryPage/CategoryPage.config';\nimport { MixType } from 'Type/Common';\nimport { FilterType, ProductType } from 'Type/ProductList';\n\nimport { DEFAULT_PLACEHOLDER_COUNT } from './ProductListPage.config';\n\nimport './ProductListPage.style';\n\n/**\n * Placeholder for List of category product\n * @namespace Component/ProductListPage/Component\n * @class ProductListPage\n */\nexport class ProductListPage extends PureComponent {\n    static propTypes = {\n        isInfiniteLoaderEnabled: PropTypes.bool.isRequired,\n        isLoading: PropTypes.bool.isRequired,\n        isVisible: PropTypes.bool.isRequired,\n        updatePages: PropTypes.func.isRequired,\n        numberOfPlaceholders: PropTypes.number,\n        selectedFilters: FilterType,\n        wrapperRef: PropTypes.func,\n        pageNumber: PropTypes.number,\n        items: PropTypes.arrayOf(ProductType),\n        mix: MixType\n    };\n\n    static defaultProps = {\n        numberOfPlaceholders: DEFAULT_PLACEHOLDER_COUNT,\n        wrapperRef: () => {},\n        selectedFilters: {},\n        pageNumber: null,\n        items: [],\n        mix: {}\n    };\n\n    state = {\n        siblingsHaveBrands: false,\n        siblingsHavePriceBadge: false,\n        siblingsHaveTierPrice: false,\n        siblingsHaveConfigurableOptions: false\n    };\n\n    componentDidMount() {\n        this.startObserving();\n    }\n\n    componentDidUpdate() {\n        this.startObserving();\n    }\n\n    componentWillUnmount() {\n        this.stopObserving();\n    }\n\n    containerProps() {\n        const {\n            siblingsHaveBrands,\n            siblingsHavePriceBadge,\n            siblingsHaveTierPrice,\n            siblingsHaveConfigurableOptions\n        } = this.state;\n\n        return {\n            productCardFunctions: {\n                setSiblingsHaveBrands: () => this.setState({ siblingsHaveBrands: true }),\n                setSiblingsHavePriceBadge: () => this.setState({ siblingsHavePriceBadge: true }),\n                setSiblingsHaveTierPrice: () => this.setState({ siblingsHaveTierPrice: true }),\n                setSiblingsHaveConfigurableOptions: () => this.setState({ siblingsHaveConfigurableOptions: true })\n            },\n            productCardProps: {\n                siblingsHaveBrands,\n                siblingsHavePriceBadge,\n                siblingsHaveTierPrice,\n                siblingsHaveConfigurableOptions\n            }\n        };\n    }\n\n    startObserving() {\n        const {\n            items,\n            updatePages,\n            isInfiniteLoaderEnabled\n        } = this.props;\n\n        if (!isInfiniteLoaderEnabled || items.length) {\n            return;\n        }\n\n        if (this.node && !this.observer && 'IntersectionObserver' in window) {\n            const options = {\n                rootMargin: '0px',\n                threshold: 0.1\n            };\n\n            this.observer = new IntersectionObserver(([{ intersectionRatio }]) => {\n                const { items, isLoading } = this.props;\n\n                // must not be a product items list, and must not be loading\n                if (intersectionRatio > 0 && !items.length && !isLoading) {\n                    this.stopObserving();\n                    updatePages();\n                }\n            }, options);\n\n            this.observer.observe(this.node);\n        }\n    }\n\n    stopObserving() {\n        if (this.observer) {\n            if (this.observer.unobserve && this.node) {\n                this.observer.unobserve(this.node);\n            }\n\n            if (this.observer.disconnect) {\n                this.observer.disconnect();\n            }\n\n            this.observer = null;\n        }\n    }\n\n    renderPlaceholders() {\n        const { numberOfPlaceholders } = this.props;\n\n        return Array.from(\n            { length: numberOfPlaceholders },\n            (_, i) => (\n                <ProductCard\n                  key={ i }\n                  product={ {} }\n                />\n            )\n        );\n    }\n\n    getPlaceholderRef() {\n        const { isVisible } = this.props;\n\n        if (!isVisible) {\n            return undefined;\n        }\n\n        return (node) => {\n            this.node = node;\n        };\n    }\n\n    renderPageItems() {\n        const {\n            items,\n            selectedFilters,\n            mix: {\n                mods: {\n                    layout = GRID_LAYOUT\n                } = {}\n            }\n        } = this.props;\n\n        return items.map((product, i) => (\n            <ProductCard\n              product={ product }\n              // eslint-disable-next-line react/no-array-index-key\n              key={ i }\n              selectedFilters={ selectedFilters }\n              layout={ layout }\n              { ...this.containerProps() }\n            />\n        ));\n    }\n\n    renderPlaceholderItems() {\n        return (\n            <>\n                <li\n                  block=\"ProductListPage\"\n                  elem=\"Offset\"\n                  ref={ this.getPlaceholderRef() }\n                />\n                { this.renderPlaceholders() }\n            </>\n        );\n    }\n\n    renderItems() {\n        const { items, isLoading } = this.props;\n\n        if (!items.length || isLoading) {\n            return this.renderPlaceholderItems();\n        }\n\n        return this.renderPageItems();\n    }\n\n    render() {\n        const {\n            pageNumber,\n            wrapperRef,\n            mix\n        } = this.props;\n\n        return (\n            <ul\n              block=\"ProductListPage\"\n              mix={ { ...mix, elem: 'Page' } }\n              key={ pageNumber }\n              ref={ wrapperRef }\n            >\n                { this.renderItems() }\n            </ul>\n        );\n    }\n}\n\nexport default withRouter(ProductListPage);\n"]},"metadata":{},"sourceType":"module"}