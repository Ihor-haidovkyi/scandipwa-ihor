{"ast":null,"code":"import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/* eslint-disable react/no-did-update-set-state */ /**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{createRef,PureComponent}from'react';import{MixType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Common\";import{IMAGE_LOADED,IMAGE_LOADING,IMAGE_NOT_FOUND,IMAGE_NOT_SPECIFIED}from\"./Image.config\";import\"./Image.style\";/**\n * Image component\n * Images are loaded only when they appear in a viewport\n * @class Image\n * @namespace Component/Image/Component\n */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _Image=/*#__PURE__*/function(_Extensible){_inherits(_Image,_Extensible);var _super=_createSuper(_Image);function _Image(){var _this;_classCallCheck(this,_Image);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.image=/*#__PURE__*/createRef();_this.state={imageStatus:IMAGE_LOADING};_this.onError=_this.onError.bind(_assertThisInitialized(_this));_this.onLoad=_this.onLoad.bind(_assertThisInitialized(_this));return _this;}_createClass(_Image,[{key:\"componentDidMount\",value:function componentDidMount(){this.onImageChange();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var prevSrc=prevProps.src;var src=this.props.src;if(src!==prevSrc){this.onImageChange();}}},{key:\"onImageChange\",value:function onImageChange(){var src=this.props.src;if(!src){return this.setState({imageStatus:IMAGE_NOT_SPECIFIED});}return this.setState({imageStatus:IMAGE_LOADING});}},{key:\"onError\",value:function onError(){this.setState({imageStatus:IMAGE_NOT_FOUND});}},{key:\"onLoad\",value:function onLoad(){this.setState({imageStatus:IMAGE_LOADED});}},{key:\"renderImageNotFound\",value:function renderImageNotFound(){if(navigator.onLine){return/*#__PURE__*/_checkBEM(React,\"span\",{block:\"Image\",elem:\"Content\"},__('Image not found'));}return/*#__PURE__*/_checkBEM(React,\"span\",{block:\"Image\",elem:\"Content\",mods:{isOffline:true}});}},{key:\"renderImage\",value:function renderImage(){var _this$props=this.props,alt=_this$props.alt,isPlaceholder=_this$props.isPlaceholder,src=_this$props.src,style=_this$props.style,title=_this$props.title;var imageStatus=this.state.imageStatus;if(isPlaceholder){return null;}switch(imageStatus){case IMAGE_NOT_FOUND:return this.renderImageNotFound();case IMAGE_NOT_SPECIFIED:return/*#__PURE__*/_checkBEM(React,\"span\",{block:\"Image\",elem:\"Content\"},__('Image not specified'));case IMAGE_LOADED:case IMAGE_LOADING:return/*#__PURE__*/_checkBEM(React,\"img\",{block:\"Image\",elem:\"Image\",src:src||'',alt:alt,mods:{isLoading:imageStatus===IMAGE_LOADING},style:style,title:title,onLoad:this.onLoad,onError:this.onError,loading:\"lazy\"});default:return null;}}},{key:\"render\",value:function render(){var _this$props2=this.props,ratio=_this$props2.ratio,mix=_this$props2.mix,isPlaceholder=_this$props2.isPlaceholder,wrapperSize=_this$props2.wrapperSize,src=_this$props2.src,imageRef=_this$props2.imageRef,className=_this$props2.className;var imageStatus=this.state.imageStatus;return/*#__PURE__*/_checkBEM(React,\"div\",{block:\"Image\",ref:imageRef,mods:{ratio:ratio,imageStatus:imageStatus,isPlaceholder:isPlaceholder,hasSrc:!!src},mix:mix,style:wrapperSize// eslint-disable-next-line react/forbid-dom-props\n,className:className},this.renderImage());}}]);return _Image;}(Extensible(PureComponent));_Image.defaultProps={className:'',src:'',alt:'',ratio:'square',mix:{},isPlaceholder:false,wrapperSize:{},style:{},title:null,imageRef:function imageRef(){}};Object.defineProperty(_Image,'name',{value:'Image'});export var Image=middleware(_Image,\"Component/Image/Component\");export default Image;","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/Image/Image.component.js"],"names":["createRef","PureComponent","MixType","IMAGE_LOADED","IMAGE_LOADING","IMAGE_NOT_FOUND","IMAGE_NOT_SPECIFIED","Image","image","state","imageStatus","onError","bind","onLoad","onImageChange","prevProps","prevSrc","src","props","setState","navigator","onLine","__","isOffline","alt","isPlaceholder","style","title","renderImageNotFound","isLoading","ratio","mix","wrapperSize","imageRef","className","hasSrc","renderImage","defaultProps","Object","defineProperty","_Image","value"],"mappings":"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","sourcesContent":["/* eslint-disable react/no-did-update-set-state */\n\n/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { createRef, PureComponent } from 'react';\n\nimport { MixType } from 'Type/Common';\n\nimport {\n    IMAGE_LOADED, IMAGE_LOADING, IMAGE_NOT_FOUND, IMAGE_NOT_SPECIFIED\n} from './Image.config';\n\nimport './Image.style';\n\n/**\n * Image component\n * Images are loaded only when they appear in a viewport\n * @class Image\n * @namespace Component/Image/Component\n */\nexport class Image extends PureComponent {\n    static propTypes = {\n        isPlaceholder: PropTypes.bool,\n        title: PropTypes.string,\n        src: PropTypes.oneOfType([\n            PropTypes.string,\n            PropTypes.bool\n        ]),\n        style: PropTypes.shape({\n            width: PropTypes.string,\n            height: PropTypes.string\n        }),\n        alt: PropTypes.string,\n        className: PropTypes.string,\n        ratio: PropTypes.oneOf([\n            '4x3',\n            '16x9',\n            'square',\n            'custom'\n        ]),\n        wrapperSize: PropTypes.shape({\n            height: PropTypes.string\n        }),\n        mix: MixType,\n        imageRef: PropTypes.oneOfType([\n            PropTypes.func,\n            PropTypes.shape({ current: PropTypes.instanceOf(Element) })\n        ])\n    };\n\n    static defaultProps = {\n        className: '',\n        src: '',\n        alt: '',\n        ratio: 'square',\n        mix: {},\n        isPlaceholder: false,\n        wrapperSize: {},\n        style: {},\n        title: null,\n        imageRef: () => {}\n    };\n\n    image = createRef();\n\n    state = { imageStatus: IMAGE_LOADING };\n\n    onError = this.onError.bind(this);\n\n    onLoad = this.onLoad.bind(this);\n\n    componentDidMount() {\n        this.onImageChange();\n    }\n\n    componentDidUpdate(prevProps) {\n        const { src: prevSrc } = prevProps;\n        const { src } = this.props;\n\n        if (src !== prevSrc) {\n            this.onImageChange();\n        }\n    }\n\n    onImageChange() {\n        const { src } = this.props;\n\n        if (!src) {\n            return this.setState({ imageStatus: IMAGE_NOT_SPECIFIED });\n        }\n\n        return this.setState({ imageStatus: IMAGE_LOADING });\n    }\n\n    onError() {\n        this.setState({ imageStatus: IMAGE_NOT_FOUND });\n    }\n\n    onLoad() {\n        this.setState({ imageStatus: IMAGE_LOADED });\n    }\n\n    renderImageNotFound() {\n        if (navigator.onLine) {\n            return (\n                <span block=\"Image\" elem=\"Content\">{ __('Image not found') }</span>\n            );\n        }\n\n        return <span block=\"Image\" elem=\"Content\" mods={ { isOffline: true } } />;\n    }\n\n    renderImage() {\n        const {\n            alt,\n            isPlaceholder,\n            src,\n            style,\n            title\n        } = this.props;\n        const { imageStatus } = this.state;\n\n        if (isPlaceholder) {\n            return null;\n        }\n\n        switch (imageStatus) {\n        case IMAGE_NOT_FOUND:\n            return this.renderImageNotFound();\n        case IMAGE_NOT_SPECIFIED:\n            return (\n                <span block=\"Image\" elem=\"Content\">{ __('Image not specified') }</span>\n            );\n        case IMAGE_LOADED:\n        case IMAGE_LOADING:\n            return (\n                <img\n                  block=\"Image\"\n                  elem=\"Image\"\n                  src={ src || '' }\n                  alt={ alt }\n                  mods={ { isLoading: imageStatus === IMAGE_LOADING } }\n                  style={ style }\n                  title={ title }\n                  onLoad={ this.onLoad }\n                  onError={ this.onError }\n                  loading=\"lazy\"\n                />\n            );\n        default:\n            return null;\n        }\n    }\n\n    render() {\n        const {\n            ratio,\n            mix,\n            isPlaceholder,\n            wrapperSize,\n            src,\n            imageRef,\n            className\n        } = this.props;\n\n        const { imageStatus } = this.state;\n\n        return (\n            <div\n              block=\"Image\"\n              ref={ imageRef }\n              mods={ {\n                  ratio,\n                  imageStatus,\n                  isPlaceholder,\n                  hasSrc: !!src\n              } }\n              mix={ mix }\n              style={ wrapperSize }\n              // eslint-disable-next-line react/forbid-dom-props\n              className={ className }\n            >\n                { this.renderImage() }\n            </div>\n        );\n    }\n}\n\nexport default Image;\n"]},"metadata":{},"sourceType":"module"}