{"ast":null,"code":"import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import{connect}from'react-redux';import OrderQuery from\"/home/marketihor/scandipwa/packages/scandipwa/src/query/Order.query\";import{showNotification}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Notification/Notification.action\";import{DeviceType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Device\";import{fetchQuery,getErrorMessage}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Request\";import MyAccountDownloadable from\"./MyAccountDownloadable.component\";export var OrderDispatcher=import(/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Order/Order.dispatcher\");/** @namespace Component/MyAccountDownloadable/Container/mapStateToProps */export var mapStateToProps=middleware(function(state){return{orderList:state.OrderReducer.orderList,device:state.ConfigReducer.device};},\"Component/MyAccountDownloadable/Container/mapStateToProps\");/** @namespace Component/MyAccountDownloadable/Container/mapDispatchToProps */export var mapDispatchToProps=middleware(function(dispatch){return{showErrorNotification:function showErrorNotification(message){return dispatch(showNotification('error',message));},showSuccessNotification:function showSuccessNotification(message){return dispatch(showNotification('success',message));},getOrderList:function getOrderList(){return OrderDispatcher.then(function(_ref){var dispatcher=_ref.default;return dispatcher.requestOrders(dispatch);});}};},\"Component/MyAccountDownloadable/Container/mapDispatchToProps\");/** @namespace Component/MyAccountDownloadable/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _MyAccountDownloadableContainer=/*#__PURE__*/function(_Extensible){_inherits(_MyAccountDownloadableContainer,_Extensible);var _super=_createSuper(_MyAccountDownloadableContainer);function _MyAccountDownloadableContainer(){var _this;_classCallCheck(this,_MyAccountDownloadableContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={items:[],isLoading:false};_this.containerProps=function(){var device=_this.props.device;var isLoading=_this.state.isLoading;return{device:device,isLoading:isLoading,items:_this._prepareDownloadableProps()};};return _this;}_createClass(_MyAccountDownloadableContainer,[{key:\"componentDidMount\",value:function componentDidMount(){var getOrderList=this.props.getOrderList;getOrderList();this.requestDownloadable();}},{key:\"_prepareDownloadableProps\",value:function _prepareDownloadableProps(){var items=this.state.items;if(!(items===null||items===void 0?void 0:items.length)){return[];}return items.reduce(function(acc,item,index){acc.push({id:index,order_id:item.order_increment_id,status_label:item.status,created_at:item.date,download_url:item.download_url,downloads:item.remaining_downloads,title:item.title,link_title:item.link_title});return acc;},[]);}},{key:\"requestDownloadable\",value:function requestDownloadable(){var _this2=this;var showErrorNotification=this.props.showErrorNotification;this.setState({isLoading:true});fetchQuery(OrderQuery.getDownloadableQuery()).then(/** @namespace Component/MyAccountDownloadable/Container/requestDownloadable/success */middleware(function(data){var _data$customerDownloa=data.customerDownloadableProducts;_data$customerDownloa=_data$customerDownloa===void 0?{}:_data$customerDownloa;var _data$customerDownloa2=_data$customerDownloa.items,items=_data$customerDownloa2===void 0?[]:_data$customerDownloa2;_this2.setState({items:items,isLoading:false});},\"Component/MyAccountDownloadable/Container/requestDownloadable/success\"),/** @namespace Component/MyAccountDownloadable/Container/requestDownloadable/error */middleware(function(err){showErrorNotification(getErrorMessage(err));_this2.setState({isLoading:false});},\"Component/MyAccountDownloadable/Container/requestDownloadable/error\"));}},{key:\"render\",value:function render(){return/*#__PURE__*/_checkBEM(React,MyAccountDownloadable,this.containerProps());}}]);return _MyAccountDownloadableContainer;}(Extensible(PureComponent));Object.defineProperty(_MyAccountDownloadableContainer,'name',{value:'MyAccountDownloadableContainer'});export var MyAccountDownloadableContainer=middleware(_MyAccountDownloadableContainer,\"Component/MyAccountDownloadable/Container\");export default connect(mapStateToProps,mapDispatchToProps)(MyAccountDownloadableContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/MyAccountDownloadable/MyAccountDownloadable.container.js"],"names":["PureComponent","connect","OrderQuery","showNotification","DeviceType","fetchQuery","getErrorMessage","MyAccountDownloadable","OrderDispatcher","mapStateToProps","state","orderList","OrderReducer","device","ConfigReducer","mapDispatchToProps","dispatch","showErrorNotification","message","showSuccessNotification","getOrderList","then","dispatcher","default","requestOrders","MyAccountDownloadableContainer","items","isLoading","containerProps","props","_prepareDownloadableProps","requestDownloadable","length","reduce","acc","item","index","push","id","order_id","order_increment_id","status_label","status","created_at","date","download_url","downloads","remaining_downloads","title","link_title","setState","getDownloadableQuery","data","customerDownloadableProducts","err","Object","defineProperty","_MyAccountDownloadableContainer","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport OrderQuery from 'Query/Order.query';\nimport { showNotification } from 'Store/Notification/Notification.action';\nimport { DeviceType } from 'Type/Device';\nimport { fetchQuery, getErrorMessage } from 'Util/Request';\n\nimport MyAccountDownloadable from './MyAccountDownloadable.component';\n\nexport const OrderDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/Order/Order.dispatcher'\n);\n\n/** @namespace Component/MyAccountDownloadable/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    orderList: state.OrderReducer.orderList,\n    device: state.ConfigReducer.device\n});\n\n/** @namespace Component/MyAccountDownloadable/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    showErrorNotification: (message) => dispatch(showNotification('error', message)),\n    showSuccessNotification: (message) => dispatch(showNotification('success', message)),\n    getOrderList: () => OrderDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.requestOrders(dispatch)\n    )\n});\n\n/** @namespace Component/MyAccountDownloadable/Container */\nexport class MyAccountDownloadableContainer extends PureComponent {\n    static propTypes = {\n        device: DeviceType.isRequired,\n        showErrorNotification: PropTypes.func.isRequired,\n        showSuccessNotification: PropTypes.func.isRequired,\n        getOrderList: PropTypes.func.isRequired\n    };\n\n    state = {\n        items: [],\n        isLoading: false\n    };\n\n    componentDidMount() {\n        const { getOrderList } = this.props;\n\n        getOrderList();\n        this.requestDownloadable();\n    }\n\n    containerProps = () => {\n        const { device } = this.props;\n        const { isLoading } = this.state;\n\n        return {\n            device,\n            isLoading,\n            items: this._prepareDownloadableProps()\n        };\n    };\n\n    _prepareDownloadableProps() {\n        const { items } = this.state;\n\n        if (!items?.length) {\n            return [];\n        }\n\n        return items.reduce((acc, item, index) => {\n            acc.push({\n                id: index,\n                order_id: item.order_increment_id,\n                status_label: item.status,\n                created_at: item.date,\n                download_url: item.download_url,\n                downloads: item.remaining_downloads,\n                title: item.title,\n                link_title: item.link_title\n            });\n\n            return acc;\n        }, []);\n    }\n\n    requestDownloadable() {\n        const { showErrorNotification } = this.props;\n\n        this.setState({ isLoading: true });\n\n        fetchQuery(\n            OrderQuery.getDownloadableQuery()\n        ).then(\n            /** @namespace Component/MyAccountDownloadable/Container/requestDownloadable/success */\n            ((data) => {\n                const { customerDownloadableProducts: { items = [] } = {} } = data;\n                this.setState({ items, isLoading: false });\n            }),\n            /** @namespace Component/MyAccountDownloadable/Container/requestDownloadable/error */\n            (err) => {\n                showErrorNotification(getErrorMessage(err));\n                this.setState({ isLoading: false });\n            }\n        );\n    }\n\n    render() {\n        return (\n            <MyAccountDownloadable\n              { ...this.containerProps() }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MyAccountDownloadableContainer);\n"]},"metadata":{},"sourceType":"module"}