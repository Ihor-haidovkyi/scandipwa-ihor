{"ast":null,"code":"import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _get from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";import _getPrototypeOf from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{connect}from'react-redux';import{CART,MY_ACCOUNT}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/Header/Header.config\";import{NavigationAbstractContainer}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/NavigationAbstract/NavigationAbstract.container\";import{ACCOUNT_LOGIN_URL}from\"/home/marketihor/scandipwa/packages/scandipwa/src/route/MyAccount/MyAccount.config\";import{changeNavigationState,goToPreviousNavigationState as _goToPreviousNavigationState}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.action\";import{BOTTOM_NAVIGATION_TYPE,TOP_NAVIGATION_TYPE}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Navigation/Navigation.reducer\";import{hideActiveOverlay as _hideActiveOverlay,toggleOverlayByKey}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Overlay/Overlay.action\";import{isSignedIn}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Auth\";import browserHistory from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/History\";import{debounce}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Request\";import{appendWithStoreCode}from\"/home/marketihor/scandipwa/packages/scandipwa/src/util/Url\";import NavigationTabs from\"./NavigationTabs.component\";import{ACCOUNT_TAB,CART_TAB,CHECKOUT_TAB,HOME_TAB,MENU_TAB}from\"./NavigationTabs.config\";/** @namespace Component/NavigationTabs/Container/mapStateToProps */export var mapStateToProps=middleware(function(state){return{navigationState:state.NavigationReducer[BOTTOM_NAVIGATION_TYPE].navigationState,headerState:state.NavigationReducer[TOP_NAVIGATION_TYPE].navigationState,device:state.ConfigReducer.device,cartTotals:state.CartReducer.cartTotals,noMatch:state.NoMatchReducer.noMatch};},\"Component/NavigationTabs/Container/mapStateToProps\");/** @namespace Component/NavigationTabs/Container/mapDispatchToProps */export var mapDispatchToProps=middleware(function(dispatch){return{showOverlay:function showOverlay(overlayKey){return dispatch(toggleOverlayByKey(overlayKey));},hideActiveOverlay:function hideActiveOverlay(){return dispatch(_hideActiveOverlay());},setNavigationState:function setNavigationState(stateName){return dispatch(changeNavigationState(BOTTOM_NAVIGATION_TYPE,stateName));},goToPreviousHeaderState:function goToPreviousHeaderState(){return dispatch(_goToPreviousNavigationState(TOP_NAVIGATION_TYPE));},goToPreviousNavigationState:function goToPreviousNavigationState(){return dispatch(_goToPreviousNavigationState(BOTTOM_NAVIGATION_TYPE));}};},\"Component/NavigationTabs/Container/mapDispatchToProps\");export var DEFAULT_NAVIGATION_TABS_STATE={name:MENU_TAB};/** @namespace Component/NavigationTabsContainer/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _NavigationTabsContainer=/*#__PURE__*/function(_Extensible){_inherits(_NavigationTabsContainer,_Extensible);var _super=_createSuper(_NavigationTabsContainer);function _NavigationTabsContainer(){var _this;_classCallCheck(this,_NavigationTabsContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.default_state=DEFAULT_NAVIGATION_TABS_STATE;_this.scrollPosition=0;_this.routeMap={'/account':{name:ACCOUNT_TAB},'/my-account':{name:ACCOUNT_TAB},'/checkout':{name:CHECKOUT_TAB,isHidden:true},'/cart':{name:CART_TAB},'/':{name:HOME_TAB}};_this.containerFunctions={onMenuButtonClick:_this.onMenuButtonClick.bind(_assertThisInitialized(_this)),onMyAccountButtonClick:_this.onMyAccountButtonClick.bind(_assertThisInitialized(_this)),onMinicartButtonClick:_this.onMinicartButtonClick.bind(_assertThisInitialized(_this)),onHomeButtonClick:_this.onHomeButtonClick.bind(_assertThisInitialized(_this))};_this.handleScroll=function(){var isVisibleOnScroll=_this.props.navigationState.isVisibleOnScroll;if(!isVisibleOnScroll){return;}var windowY=window.pageYOffset;_this.handleNavVisibilityOnScroll(windowY);_this.scrollPosition=windowY;};return _this;}_createClass(_NavigationTabsContainer,[{key:\"componentDidMount\",value:function componentDidMount(){this.handleNavVisibility();var SCROLL_DEBOUNCE_DELAY=10;var _this$getNavigationSt=this.getNavigationState(),name=_this$getNavigationSt.name;this.lastSeenMenu=name===MENU_TAB?0:-1;window.addEventListener('scroll',debounce(this.handleScroll,SCROLL_DEBOUNCE_DELAY));_get(_getPrototypeOf(_NavigationTabsContainer.prototype),\"componentDidMount\",this).call(this);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){this.handleNavVisibility();this.handleVisibleOnScrollChange(prevProps);}},{key:\"handleNavVisibility\",value:function handleNavVisibility(){var isHidden=this.props.navigationState.isHidden;if(isHidden){document.documentElement.classList.add('hiddenNavigationTabs');return;}document.documentElement.classList.remove('hiddenNavigationTabs');}},{key:\"handleVisibleOnScrollChange\",value:function handleVisibleOnScrollChange(prevProps){var isVisibleOnScroll=this.props.navigationState.isVisibleOnScroll;var prevIsVisible=prevProps.navigationState.isVisibleOnScroll;if(isVisibleOnScroll!==prevIsVisible){this.scrollPosition=window.pageYOffset;document.documentElement.classList.remove('hideOnScroll');}}},{key:\"handleNavVisibilityOnScroll\",value:function handleNavVisibilityOnScroll(windowY){var ERROR_TOP_OFFSET=10;var ERROR_BOTTOM_OFFSET=20;var TOP_MIN_OFFSET=100;var doc=document.body;var offset=window.innerHeight+window.pageYOffset;var height=doc.scrollHeight;if(windowY<TOP_MIN_OFFSET){// We are on top\ndocument.documentElement.classList.remove('hideOnScroll');return;}if(offset>=height-ERROR_BOTTOM_OFFSET){// We are on the bottom\ndocument.documentElement.classList.remove('hideOnScroll');return;}// Scroll is less then min offset\nif(Math.abs(windowY-this.scrollPosition)<ERROR_TOP_OFFSET){return;}if(windowY<this.scrollPosition){// Scrolling UP\ndocument.documentElement.classList.remove('hideOnScroll');}else{// Scrolling DOWN\ndocument.documentElement.classList.add('hideOnScroll');}}},{key:\"onMenuButtonClick\",value:function onMenuButtonClick(){var name=this.props.navigationState.name;// TODO: resolve issue when coming from CMS page\nif(name===MENU_TAB){// if we already are in menu\nbrowserHistory.push(appendWithStoreCode('/menu'));}else if(this.lastSeenMenu<=0){// if we have not yet seen menu\nbrowserHistory.push(appendWithStoreCode('/menu'));}else{// otherwise go to last remembered category\nbrowserHistory.go(-this.lastSeenMenu);}this.lastSeenMenu=0;}},{key:\"onMinicartButtonClick\",value:function onMinicartButtonClick(){var _location=location,pathname=_location.pathname;if(pathname!==appendWithStoreCode(\"/\".concat(CART))){browserHistory.push(appendWithStoreCode(\"/\".concat(CART)));}}},{key:\"onMyAccountButtonClick\",value:function onMyAccountButtonClick(){var _location2=location,pathname=_location2.pathname;var url=appendWithStoreCode(isSignedIn()?\"/\".concat(MY_ACCOUNT):ACCOUNT_LOGIN_URL);if(pathname!==url){browserHistory.push(url);}}},{key:\"preserveState\",value:function preserveState(name,newName){var noMatch=this.props.noMatch;if(noMatch){this.lastSeenMenu=-1;return;}if(this.lastSeenMenu===-1){return;}if(newName!==MENU_TAB){this.lastSeenMenu++;}if(newName===MENU_TAB&&name===MENU_TAB){this.lastSeenMenu=0;}}},{key:\"handleMobileRouteChange\",value:function handleMobileRouteChange(history){var _this$props=this.props,setNavigationState=_this$props.setNavigationState,name=_this$props.navigationState.name;var pathname=history.pathname;// Find the new state name\nvar newNavigationState=this.getNavigationState();var newName=newNavigationState.name;// Update the state if new name is set\nif(name!==newName){setNavigationState(newNavigationState);}this.preserveState(name,newName);return{prevPathname:pathname};}},{key:\"onHomeButtonClick\",value:function onHomeButtonClick(){var hideActiveOverlay=this.props.hideActiveOverlay;var _location3=location,pathname=_location3.pathname;browserHistory.push(appendWithStoreCode('/'));hideActiveOverlay();if(pathname===appendWithStoreCode('/')||pathname==='/'){window.scrollTo({top:0,behavior:'smooth'});}}},{key:\"render\",value:function render(){return/*#__PURE__*/_checkBEM(React,NavigationTabs,Object.assign({},this.props,this.containerFunctions));}}]);return _NavigationTabsContainer;}(Extensible(NavigationAbstractContainer));Object.defineProperty(_NavigationTabsContainer,'name',{value:'NavigationTabsContainer'});export var NavigationTabsContainer=middleware(_NavigationTabsContainer,\"Component/NavigationTabsContainer/Container\");export default connect(mapStateToProps,mapDispatchToProps)(NavigationTabsContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/NavigationTabs/NavigationTabs.container.js"],"names":["connect","CART","MY_ACCOUNT","NavigationAbstractContainer","ACCOUNT_LOGIN_URL","changeNavigationState","goToPreviousNavigationState","BOTTOM_NAVIGATION_TYPE","TOP_NAVIGATION_TYPE","hideActiveOverlay","toggleOverlayByKey","isSignedIn","browserHistory","debounce","appendWithStoreCode","NavigationTabs","ACCOUNT_TAB","CART_TAB","CHECKOUT_TAB","HOME_TAB","MENU_TAB","mapStateToProps","state","navigationState","NavigationReducer","headerState","device","ConfigReducer","cartTotals","CartReducer","noMatch","NoMatchReducer","mapDispatchToProps","dispatch","showOverlay","overlayKey","setNavigationState","stateName","goToPreviousHeaderState","DEFAULT_NAVIGATION_TABS_STATE","name","NavigationTabsContainer","default_state","scrollPosition","routeMap","isHidden","containerFunctions","onMenuButtonClick","bind","onMyAccountButtonClick","onMinicartButtonClick","onHomeButtonClick","handleScroll","isVisibleOnScroll","props","windowY","window","pageYOffset","handleNavVisibilityOnScroll","handleNavVisibility","SCROLL_DEBOUNCE_DELAY","getNavigationState","lastSeenMenu","addEventListener","prevProps","handleVisibleOnScrollChange","document","documentElement","classList","add","remove","prevIsVisible","ERROR_TOP_OFFSET","ERROR_BOTTOM_OFFSET","TOP_MIN_OFFSET","doc","body","offset","innerHeight","height","scrollHeight","Math","abs","push","go","location","pathname","url","newName","history","newNavigationState","preserveState","prevPathname","scrollTo","top","behavior","Object","defineProperty","_NavigationTabsContainer","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport { connect } from 'react-redux';\n\nimport { CART, MY_ACCOUNT } from 'Component/Header/Header.config';\nimport { NavigationAbstractContainer } from 'Component/NavigationAbstract/NavigationAbstract.container';\nimport {\n    ACCOUNT_LOGIN_URL\n} from 'Route/MyAccount/MyAccount.config';\nimport { changeNavigationState, goToPreviousNavigationState } from 'Store/Navigation/Navigation.action';\nimport { BOTTOM_NAVIGATION_TYPE, TOP_NAVIGATION_TYPE } from 'Store/Navigation/Navigation.reducer';\nimport { hideActiveOverlay, toggleOverlayByKey } from 'Store/Overlay/Overlay.action';\nimport { isSignedIn } from 'Util/Auth';\nimport browserHistory from 'Util/History';\nimport { debounce } from 'Util/Request';\nimport { appendWithStoreCode } from 'Util/Url';\n\nimport NavigationTabs from './NavigationTabs.component';\nimport {\n    ACCOUNT_TAB,\n    CART_TAB,\n    CHECKOUT_TAB, HOME_TAB,\n    MENU_TAB\n} from './NavigationTabs.config';\n\n/** @namespace Component/NavigationTabs/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    navigationState: state.NavigationReducer[BOTTOM_NAVIGATION_TYPE].navigationState,\n    headerState: state.NavigationReducer[TOP_NAVIGATION_TYPE].navigationState,\n    device: state.ConfigReducer.device,\n    cartTotals: state.CartReducer.cartTotals,\n    noMatch: state.NoMatchReducer.noMatch\n});\n\n/** @namespace Component/NavigationTabs/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    showOverlay: (overlayKey) => dispatch(toggleOverlayByKey(overlayKey)),\n    hideActiveOverlay: () => dispatch(hideActiveOverlay()),\n    setNavigationState: (stateName) => dispatch(changeNavigationState(BOTTOM_NAVIGATION_TYPE, stateName)),\n    goToPreviousHeaderState: () => dispatch(goToPreviousNavigationState(TOP_NAVIGATION_TYPE)),\n    goToPreviousNavigationState: () => dispatch(goToPreviousNavigationState(BOTTOM_NAVIGATION_TYPE))\n});\n\nexport const DEFAULT_NAVIGATION_TABS_STATE = { name: MENU_TAB };\n\n/** @namespace Component/NavigationTabsContainer/Container */\nexport class NavigationTabsContainer extends NavigationAbstractContainer {\n    default_state = DEFAULT_NAVIGATION_TABS_STATE;\n\n    scrollPosition = 0;\n\n    routeMap = {\n        '/account': { name: ACCOUNT_TAB },\n        '/my-account': { name: ACCOUNT_TAB },\n        '/checkout': { name: CHECKOUT_TAB, isHidden: true },\n        '/cart': { name: CART_TAB },\n        '/': { name: HOME_TAB }\n    };\n\n    containerFunctions = {\n        onMenuButtonClick: this.onMenuButtonClick.bind(this),\n        onMyAccountButtonClick: this.onMyAccountButtonClick.bind(this),\n        onMinicartButtonClick: this.onMinicartButtonClick.bind(this),\n        onHomeButtonClick: this.onHomeButtonClick.bind(this)\n    };\n\n    componentDidMount() {\n        this.handleNavVisibility();\n\n        const SCROLL_DEBOUNCE_DELAY = 10;\n        const { name } = this.getNavigationState();\n        this.lastSeenMenu = name === MENU_TAB ? 0 : -1;\n        window.addEventListener('scroll', debounce(this.handleScroll, SCROLL_DEBOUNCE_DELAY));\n\n        super.componentDidMount();\n    }\n\n    componentDidUpdate(prevProps) {\n        this.handleNavVisibility();\n        this.handleVisibleOnScrollChange(prevProps);\n    }\n\n    handleNavVisibility() {\n        const { navigationState: { isHidden } } = this.props;\n\n        if (isHidden) {\n            document.documentElement.classList.add('hiddenNavigationTabs');\n            return;\n        }\n\n        document.documentElement.classList.remove('hiddenNavigationTabs');\n    }\n\n    handleVisibleOnScrollChange(prevProps) {\n        const { navigationState: { isVisibleOnScroll } } = this.props;\n        const { navigationState: { isVisibleOnScroll: prevIsVisible } } = prevProps;\n\n        if (isVisibleOnScroll !== prevIsVisible) {\n            this.scrollPosition = window.pageYOffset;\n            document.documentElement.classList.remove('hideOnScroll');\n        }\n    }\n\n    handleNavVisibilityOnScroll(windowY) {\n        const ERROR_TOP_OFFSET = 10;\n        const ERROR_BOTTOM_OFFSET = 20;\n        const TOP_MIN_OFFSET = 100;\n\n        const doc = document.body;\n        const offset = window.innerHeight + window.pageYOffset;\n        const height = doc.scrollHeight;\n\n        if (windowY < TOP_MIN_OFFSET) {\n            // We are on top\n            document.documentElement.classList.remove('hideOnScroll');\n            return;\n        }\n\n        if (offset >= (height - ERROR_BOTTOM_OFFSET)) {\n            // We are on the bottom\n            document.documentElement.classList.remove('hideOnScroll');\n            return;\n        }\n\n        // Scroll is less then min offset\n        if (Math.abs(windowY - this.scrollPosition) < ERROR_TOP_OFFSET) {\n            return;\n        }\n\n        if (windowY < this.scrollPosition) {\n            // Scrolling UP\n            document.documentElement.classList.remove('hideOnScroll');\n        } else {\n            // Scrolling DOWN\n            document.documentElement.classList.add('hideOnScroll');\n        }\n    }\n\n    handleScroll = () => {\n        const { navigationState: { isVisibleOnScroll } } = this.props;\n        if (!isVisibleOnScroll) {\n            return;\n        }\n\n        const windowY = window.pageYOffset;\n        this.handleNavVisibilityOnScroll(windowY);\n        this.scrollPosition = windowY;\n    };\n\n    onMenuButtonClick() {\n        const { navigationState: { name } } = this.props;\n\n        // TODO: resolve issue when coming from CMS page\n\n        if (name === MENU_TAB) { // if we already are in menu\n            browserHistory.push(appendWithStoreCode('/menu'));\n        } else if (this.lastSeenMenu <= 0) { // if we have not yet seen menu\n            browserHistory.push(appendWithStoreCode('/menu'));\n        } else { // otherwise go to last remembered category\n            browserHistory.go(-this.lastSeenMenu);\n        }\n\n        this.lastSeenMenu = 0;\n    }\n\n    onMinicartButtonClick() {\n        const { pathname } = location;\n\n        if (pathname !== appendWithStoreCode(`/${ CART }`)) {\n            browserHistory.push(appendWithStoreCode(`/${ CART }`));\n        }\n    }\n\n    onMyAccountButtonClick() {\n        const { pathname } = location;\n        const url = appendWithStoreCode(isSignedIn() ? `/${ MY_ACCOUNT }` : ACCOUNT_LOGIN_URL);\n\n        if (pathname !== url) {\n            browserHistory.push(url);\n        }\n    }\n\n    preserveState(name, newName) {\n        const { noMatch } = this.props;\n\n        if (noMatch) {\n            this.lastSeenMenu = -1;\n            return;\n        }\n\n        if (this.lastSeenMenu === -1) {\n            return;\n        }\n\n        if (newName !== MENU_TAB) {\n            this.lastSeenMenu++;\n        }\n\n        if (newName === MENU_TAB && name === MENU_TAB) {\n            this.lastSeenMenu = 0;\n        }\n    }\n\n    handleMobileRouteChange(history) {\n        const {\n            // hideActiveOverlay,\n            setNavigationState,\n            navigationState: { name }\n        } = this.props;\n\n        const { pathname } = history;\n\n        // Find the new state name\n        const newNavigationState = this.getNavigationState();\n        const { name: newName } = newNavigationState;\n\n        // Update the state if new name is set\n        if (name !== newName) {\n            setNavigationState(newNavigationState);\n        }\n\n        this.preserveState(name, newName);\n\n        return { prevPathname: pathname };\n    }\n\n    onHomeButtonClick() {\n        const {\n            hideActiveOverlay\n        } = this.props;\n\n        const { pathname } = location;\n\n        browserHistory.push(appendWithStoreCode('/'));\n        hideActiveOverlay();\n\n        if (\n            pathname === appendWithStoreCode('/')\n            || pathname === '/'\n        ) {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n        }\n    }\n\n    render() {\n        return (\n            <NavigationTabs\n              { ...this.props }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NavigationTabsContainer);\n"]},"metadata":{},"sourceType":"module"}