{"ast":null,"code":"import _objectSpread from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _get from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";import _getPrototypeOf from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import{connect}from'react-redux';import{HistoryType,LocationType,MatchType}from\"/home/marketihor/scandipwa/packages/scandipwa/src/type/Common\";import UrlRewrites from\"./UrlRewrites.component\";import{TYPE_CATEGORY,TYPE_CMS_PAGE,TYPE_NOTFOUND,TYPE_PRODUCT}from\"./UrlRewrites.config\";export var UrlRewritesDispatcher=import(/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\"/home/marketihor/scandipwa/packages/scandipwa/src/store/UrlRewrites/UrlRewrites.dispatcher\");export var NoMatchDispatcher=import(/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\"/home/marketihor/scandipwa/packages/scandipwa/src/store/NoMatch/NoMatch.dispatcher\");/** @namespace Route/UrlRewrites/Container/mapStateToProps */export var mapStateToProps=middleware(function(state){return{urlRewrite:state.UrlRewritesReducer.urlRewrite,isLoading:state.UrlRewritesReducer.isLoading,requestedUrl:state.UrlRewritesReducer.requestedUrl};},\"Route/UrlRewrites/Container/mapStateToProps\");/** @namespace Route/UrlRewrites/Container/mapDispatchToProps */export var mapDispatchToProps=middleware(function(dispatch){return{requestUrlRewrite:function requestUrlRewrite(urlParam){UrlRewritesDispatcher.then(function(_ref){var dispatcher=_ref.default;return dispatcher.handleData(dispatch,{urlParam:urlParam});});}};},\"Route/UrlRewrites/Container/mapDispatchToProps\");/** @namespace Route/UrlRewrites/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _UrlRewritesContainer=/*#__PURE__*/function(_Extensible){_inherits(_UrlRewritesContainer,_Extensible);var _super=_createSuper(_UrlRewritesContainer);function _UrlRewritesContainer(){var _this;_classCallCheck(this,_UrlRewritesContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.containerProps=function(){return{type:_this.getType(),props:_this.getProps()};};return _this;}_createClass(_UrlRewritesContainer,[{key:\"__construct\",value:function __construct(props){_get(_getPrototypeOf(_UrlRewritesContainer.prototype),\"__construct\",this).call(this,props);this.requestUrlRewrite();}},{key:\"componentDidMount\",value:function componentDidMount(){this.initialUrl=location.pathname;}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){var isLoading=this.props.isLoading;/**\n         * If the latest requested URL rewrite is not related\n         * to the current location, and the URL rewrites are not loading\n         * request new URL rewrite.\n         */if(this.getIsLoading()&&!isLoading){this.requestUrlRewrite();}/**\n         * Make sure that PDP & PLP url don't have \"/\" in the end\n         */this.redirectToCorrectUrl();}},{key:\"redirectToCorrectUrl\",value:function redirectToCorrectUrl(){var _this$props=this.props,location=_this$props.location,history=_this$props.history;var type=this.getType();if([TYPE_CATEGORY,TYPE_PRODUCT].includes(type)){if(location.pathname.endsWith('/')){history.replace(location.pathname.slice(0,-1),history.state);}}}},{key:\"getTypeSpecificProps\",value:function getTypeSpecificProps(){var _this$props$urlRewrit=this.props.urlRewrite,id=_this$props$urlRewrit.id,sku=_this$props$urlRewrit.sku;var isLoading=this.getIsLoading();switch(this.getType()){case TYPE_PRODUCT:/**\n             * In case we are not yet sure what product ID it is:\n             * - check if there is a hint in browser history\n             * - fallback to none\n             */if(isLoading){var _history,_history$state,_history$state$state;var product=(_history=history)===null||_history===void 0?void 0:(_history$state=_history.state)===null||_history$state===void 0?void 0:(_history$state$state=_history$state.state)===null||_history$state$state===void 0?void 0:_history$state$state.product;if(product){var historySKU=product.sku,_id=product.id;return{productSKU:historySKU,id:_id};}return{};}return{productSKU:sku,id:id};case TYPE_CMS_PAGE:if(isLoading){return{isOnlyPlaceholder:true};}return{pageIds:id};case TYPE_CATEGORY:/**\n             * In case we are not yet sure what category ID it is:\n             * - check if there is a hint in browser history\n             * - fallback to none\n             */if(isLoading){var _history2,_history2$state,_history2$state$state;var category=(_history2=history)===null||_history2===void 0?void 0:(_history2$state=_history2.state)===null||_history2$state===void 0?void 0:(_history2$state$state=_history2$state.state)===null||_history2$state$state===void 0?void 0:_history2$state$state.category;if(category&&category!==true){return{categoryIds:category};}return{};}return{categoryIds:id};case TYPE_NOTFOUND:default:return{};}}},{key:\"getIsLoading\",value:function getIsLoading(){var requestedUrl=this.props.requestedUrl;return location.pathname!==requestedUrl;}},{key:\"getProps\",value:function getProps(){var _this$props2=this.props,location=_this$props2.location,match=_this$props2.match,history=_this$props2.history;return _objectSpread({location:location,match:match,history:history},this.getTypeSpecificProps());}},{key:\"getFallbackType\",value:function getFallbackType(){var _window=window,_window$actionName=_window.actionName;_window$actionName=_window$actionName===void 0?{}:_window$actionName;var _window$actionName$ty=_window$actionName.type,initialType=_window$actionName$ty===void 0?'':_window$actionName$ty;if(this.initialUrl===location.pathname){return initialType;}return'';}},{key:\"getType\",value:function getType(){var _this$props$urlRewrit2=this.props.urlRewrite,type=_this$props$urlRewrit2.type,notFound=_this$props$urlRewrit2.notFound;/**\n         * If the URL rewrite is loading, prefer state-defined URL type,\n         * else fallback to one defined in HTML document by PHP controller\n         * (which is only valid for 1st load).\n         */if(this.getIsLoading()){var _history3,_history3$state;var state=((_history3=history)===null||_history3===void 0?void 0:(_history3$state=_history3.state)===null||_history3$state===void 0?void 0:_history3$state.state)||{};var typeKey=Object.keys(state).find(function(key){return UrlRewritesContainer.stateMapping[key];});if(typeKey){return UrlRewritesContainer.stateMapping[typeKey];}/**\n             * Otherwise fallback to other guessed types - from window i.e.\n             */return this.getFallbackType();}if(notFound){return TYPE_NOTFOUND;}if(type){return type;}return'';}},{key:\"requestUrlRewrite\",value:function requestUrlRewrite(){var requestUrlRewrite=this.props.requestUrlRewrite;return requestUrlRewrite(location.pathname);}},{key:\"render\",value:function render(){return/*#__PURE__*/_checkBEM(React,UrlRewrites,this.containerProps());}}]);return _UrlRewritesContainer;}(Extensible(PureComponent));_UrlRewritesContainer.defaultProps={requestedUrl:''};_UrlRewritesContainer.stateMapping={category:TYPE_CATEGORY,product:TYPE_PRODUCT,page:TYPE_CMS_PAGE};Object.defineProperty(_UrlRewritesContainer,'name',{value:'UrlRewritesContainer'});export var UrlRewritesContainer=middleware(_UrlRewritesContainer,\"Route/UrlRewrites/Container\");export default connect(mapStateToProps,mapDispatchToProps)(UrlRewritesContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/route/UrlRewrites/UrlRewrites.container.js"],"names":["PureComponent","connect","HistoryType","LocationType","MatchType","UrlRewrites","TYPE_CATEGORY","TYPE_CMS_PAGE","TYPE_NOTFOUND","TYPE_PRODUCT","UrlRewritesDispatcher","NoMatchDispatcher","mapStateToProps","state","urlRewrite","UrlRewritesReducer","isLoading","requestedUrl","mapDispatchToProps","dispatch","requestUrlRewrite","urlParam","then","dispatcher","default","handleData","UrlRewritesContainer","containerProps","type","getType","props","getProps","initialUrl","location","pathname","getIsLoading","redirectToCorrectUrl","history","includes","endsWith","replace","slice","id","sku","product","historySKU","productSKU","isOnlyPlaceholder","pageIds","category","categoryIds","match","getTypeSpecificProps","window","actionName","initialType","notFound","typeKey","Object","keys","find","key","stateMapping","getFallbackType","defaultProps","page","defineProperty","_UrlRewritesContainer","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright Â© Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { HistoryType, LocationType, MatchType } from 'Type/Common';\n\nimport UrlRewrites from './UrlRewrites.component';\nimport {\n    TYPE_CATEGORY,\n    TYPE_CMS_PAGE,\n    TYPE_NOTFOUND,\n    TYPE_PRODUCT\n} from './UrlRewrites.config';\n\nexport const UrlRewritesDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/UrlRewrites/UrlRewrites.dispatcher'\n);\n\nexport const NoMatchDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/NoMatch/NoMatch.dispatcher'\n);\n\n/** @namespace Route/UrlRewrites/Container/mapStateToProps */\nexport const mapStateToProps = (state) => ({\n    urlRewrite: state.UrlRewritesReducer.urlRewrite,\n    isLoading: state.UrlRewritesReducer.isLoading,\n    requestedUrl: state.UrlRewritesReducer.requestedUrl\n});\n\n/** @namespace Route/UrlRewrites/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    requestUrlRewrite: (urlParam) => {\n        UrlRewritesDispatcher.then(\n            ({ default: dispatcher }) => dispatcher.handleData(dispatch, { urlParam })\n        );\n    }\n});\n\n/** @namespace Route/UrlRewrites/Container */\nexport class UrlRewritesContainer extends PureComponent {\n    static propTypes = {\n        location: LocationType.isRequired,\n        match: MatchType.isRequired,\n        history: HistoryType.isRequired,\n        isLoading: PropTypes.bool.isRequired,\n        requestedUrl: PropTypes.string,\n        requestUrlRewrite: PropTypes.func.isRequired,\n        urlRewrite: PropTypes.shape({\n            id: PropTypes.number,\n            type: PropTypes.string,\n            sku: PropTypes.string,\n            notFound: PropTypes.bool\n        }).isRequired\n    };\n\n    static defaultProps = {\n        requestedUrl: ''\n    };\n\n    static stateMapping = {\n        category: TYPE_CATEGORY,\n        product: TYPE_PRODUCT,\n        page: TYPE_CMS_PAGE\n    };\n\n    __construct(props) {\n        super.__construct(props);\n\n        this.requestUrlRewrite();\n    }\n\n    componentDidMount() {\n        this.initialUrl = location.pathname;\n    }\n\n    componentDidUpdate() {\n        const { isLoading } = this.props;\n\n        /**\n         * If the latest requested URL rewrite is not related\n         * to the current location, and the URL rewrites are not loading\n         * request new URL rewrite.\n         */\n        if (this.getIsLoading() && !isLoading) {\n            this.requestUrlRewrite();\n        }\n\n        /**\n         * Make sure that PDP & PLP url don't have \"/\" in the end\n         */\n        this.redirectToCorrectUrl();\n    }\n\n    redirectToCorrectUrl() {\n        const { location, history } = this.props;\n\n        const type = this.getType();\n        if ([TYPE_CATEGORY, TYPE_PRODUCT].includes(type)) {\n            if (location.pathname.endsWith('/')) {\n                history.replace(\n                    location.pathname.slice(0, -1),\n                    history.state\n                );\n            }\n        }\n    }\n\n    containerProps = () => ({\n        type: this.getType(),\n        props: this.getProps()\n    });\n\n    getTypeSpecificProps() {\n        const {\n            urlRewrite: {\n                id,\n                sku\n            }\n        } = this.props;\n\n        const isLoading = this.getIsLoading();\n\n        switch (this.getType()) {\n        case TYPE_PRODUCT:\n            /**\n             * In case we are not yet sure what product ID it is:\n             * - check if there is a hint in browser history\n             * - fallback to none\n             */\n            if (isLoading) {\n                const product = history?.state?.state?.product;\n\n                if (product) {\n                    const { sku: historySKU, id } = product;\n                    return { productSKU: historySKU, id };\n                }\n\n                return {};\n            }\n\n            return { productSKU: sku, id };\n        case TYPE_CMS_PAGE:\n            if (isLoading) {\n                return { isOnlyPlaceholder: true };\n            }\n\n            return { pageIds: id };\n        case TYPE_CATEGORY:\n            /**\n             * In case we are not yet sure what category ID it is:\n             * - check if there is a hint in browser history\n             * - fallback to none\n             */\n            if (isLoading) {\n                const category = history?.state?.state?.category;\n\n                if (category && category !== true) {\n                    return { categoryIds: category };\n                }\n\n                return {};\n            }\n\n            return { categoryIds: id };\n        case TYPE_NOTFOUND:\n        default:\n            return {};\n        }\n    }\n\n    getIsLoading() {\n        const { requestedUrl } = this.props;\n        return location.pathname !== requestedUrl;\n    }\n\n    getProps() {\n        const {\n            location,\n            match,\n            history\n        } = this.props;\n\n        return {\n            location,\n            match,\n            history,\n            ...this.getTypeSpecificProps()\n        };\n    }\n\n    getFallbackType() {\n        const {\n            actionName: { type: initialType = '' } = {}\n        } = window;\n\n        if (this.initialUrl === location.pathname) {\n            return initialType;\n        }\n\n        return '';\n    }\n\n    getType() {\n        const { urlRewrite: { type, notFound } } = this.props;\n\n        /**\n         * If the URL rewrite is loading, prefer state-defined URL type,\n         * else fallback to one defined in HTML document by PHP controller\n         * (which is only valid for 1st load).\n         */\n        if (this.getIsLoading()) {\n            const state = history?.state?.state || {};\n            const typeKey = Object.keys(state).find((key) => UrlRewritesContainer.stateMapping[key]);\n\n            if (typeKey) {\n                return UrlRewritesContainer.stateMapping[typeKey];\n            }\n\n            /**\n             * Otherwise fallback to other guessed types - from window i.e.\n             */\n            return this.getFallbackType();\n        }\n\n        if (notFound) {\n            return TYPE_NOTFOUND;\n        }\n\n        if (type) {\n            return type;\n        }\n\n        return '';\n    }\n\n    requestUrlRewrite() {\n        const { requestUrlRewrite } = this.props;\n        return requestUrlRewrite(location.pathname);\n    }\n\n    render() {\n        return (\n            <UrlRewrites\n              { ...this.containerProps() }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UrlRewritesContainer);\n"]},"metadata":{},"sourceType":"module"}