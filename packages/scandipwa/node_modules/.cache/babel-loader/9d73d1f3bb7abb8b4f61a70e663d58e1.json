{"ast":null,"code":"import _regeneratorRuntime from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/marketihor/scandipwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */import{PureComponent}from'react';import{connect}from'react-redux';import{STATE_CONFIRM_EMAIL}from\"/home/marketihor/scandipwa/packages/scandipwa/src/component/MyAccountOverlay/MyAccountOverlay.config\";import{showNotification as _showNotification}from\"/home/marketihor/scandipwa/packages/scandipwa/src/store/Notification/Notification.action\";import MyAccountCreateAccount from\"./MyAccountCreateAccount.component\";import{SHOW_VAT_NUMBER_REQUIRED}from\"./MyAccountCreateAccount.config\";export var MyAccountDispatcher=import(/* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\"/home/marketihor/scandipwa/packages/scandipwa/src/store/MyAccount/MyAccount.dispatcher\");/** @namespace Component/MyAccountCreateAccount/Container/mapStateToProps */ // eslint-disable-next-line no-unused-vars\nexport var mapStateToProps=middleware(function(state){return{isLoading:state.MyAccountReducer.isLoading,showTaxVatNumber:!!state.ConfigReducer.show_tax_vat_number,newsletterActive:state.ConfigReducer.newsletter_general_active};},\"Component/MyAccountCreateAccount/Container/mapStateToProps\");/** @namespace Component/MyAccountCreateAccount/Container/mapDispatchToProps */export var mapDispatchToProps=middleware(function(dispatch){return{createAccount:function createAccount(options){return MyAccountDispatcher.then(function(_ref){var dispatcher=_ref.default;return dispatcher.createAccount(options,dispatch);});},showNotification:function showNotification(type,message){return dispatch(_showNotification(type,message));}};},\"Component/MyAccountCreateAccount/Container/mapDispatchToProps\");/** @namespace Component/MyAccountCreateAccount/Container */var _checkBEM=require(\"babel-plugin-transform-rebem-jsx\").checkBEMProps;export var _MyAccountCreateAccountContainer=/*#__PURE__*/function(_Extensible){_inherits(_MyAccountCreateAccountContainer,_Extensible);var _super=_createSuper(_MyAccountCreateAccountContainer);function _MyAccountCreateAccountContainer(){var _this;_classCallCheck(this,_MyAccountCreateAccountContainer);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.containerProps={vatNumberValidation:_this.getVatNumberValidation()};_this.containerFunctions={onCreateAccountSuccess:_this.onCreateAccountSuccess.bind(_assertThisInitialized(_this)),onCreateAccountAttempt:_this.onCreateAccountAttempt.bind(_assertThisInitialized(_this))};return _this;}_createClass(_MyAccountCreateAccountContainer,[{key:\"getVatNumberValidation\",value:function getVatNumberValidation(){var showTaxVatNumber=this.props.showTaxVatNumber;if(showTaxVatNumber===SHOW_VAT_NUMBER_REQUIRED){return['notEmpty'];}return[];}},{key:\"onCreateAccountAttempt\",value:function onCreateAccountAttempt(_,invalidFields){var _this$props=this.props,showNotification=_this$props.showNotification,setLoadingState=_this$props.setLoadingState;if(invalidFields){showNotification('info',__('Incorrect data! Please resolve all field validation errors.'));}setLoadingState(!invalidFields);}},{key:\"onCreateAccountSuccess\",value:function(){var _onCreateAccountSuccess=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(fields){var _this$props2,createAccount,onSignIn,setSignInState,setLoadingState,isLoading,password,email,firstname,lastname,is_subscribed,taxvat,customerData,code;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props2=this.props,createAccount=_this$props2.createAccount,onSignIn=_this$props2.onSignIn,setSignInState=_this$props2.setSignInState,setLoadingState=_this$props2.setLoadingState,isLoading=_this$props2.isLoading;password=fields.password,email=fields.email,firstname=fields.firstname,lastname=fields.lastname,is_subscribed=fields.is_subscribed,taxvat=fields.taxvat;customerData={customer:{firstname:firstname,lastname:lastname,email:email,is_subscribed:is_subscribed,taxvat:taxvat},password:password};if(!isLoading){_context.next=5;break;}return _context.abrupt(\"return\");case 5:_context.prev=5;_context.next=8;return createAccount(customerData);case 8:code=_context.sent;// if user needs confirmation\nif(code===2){setSignInState(STATE_CONFIRM_EMAIL);}else{onSignIn();}case 10:_context.prev=10;setLoadingState(false);return _context.finish(10);case 13:case\"end\":return _context.stop();}}},_callee,this,[[5,,10,13]]);}));function onCreateAccountSuccess(_x){return _onCreateAccountSuccess.apply(this,arguments);}return onCreateAccountSuccess;}()},{key:\"render\",value:function render(){return/*#__PURE__*/_checkBEM(React,MyAccountCreateAccount,Object.assign({},this.props,this.containerProps,this.containerFunctions));}}]);return _MyAccountCreateAccountContainer;}(Extensible(PureComponent));Object.defineProperty(_MyAccountCreateAccountContainer,'name',{value:'MyAccountCreateAccountContainer'});export var MyAccountCreateAccountContainer=middleware(_MyAccountCreateAccountContainer,\"Component/MyAccountCreateAccount/Container\");export default connect(mapStateToProps,mapDispatchToProps)(MyAccountCreateAccountContainer);","map":{"version":3,"sources":["/home/marketihor/scandipwa/packages/scandipwa/src/component/MyAccountCreateAccount/MyAccountCreateAccount.container.js"],"names":["PureComponent","connect","STATE_CONFIRM_EMAIL","showNotification","MyAccountCreateAccount","SHOW_VAT_NUMBER_REQUIRED","MyAccountDispatcher","mapStateToProps","state","isLoading","MyAccountReducer","showTaxVatNumber","ConfigReducer","show_tax_vat_number","newsletterActive","newsletter_general_active","mapDispatchToProps","dispatch","createAccount","options","then","dispatcher","default","type","message","MyAccountCreateAccountContainer","containerProps","vatNumberValidation","getVatNumberValidation","containerFunctions","onCreateAccountSuccess","bind","onCreateAccountAttempt","props","_","invalidFields","setLoadingState","__","fields","onSignIn","setSignInState","password","email","firstname","lastname","is_subscribed","taxvat","customerData","customer","code","Object","defineProperty","_MyAccountCreateAccountContainer","value"],"mappings":"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","sourcesContent":["/**\n * ScandiPWA - Progressive Web App for Magento\n *\n * Copyright © Scandiweb, Inc. All rights reserved.\n * See LICENSE for license details.\n *\n * @license OSL-3.0 (Open Software License (\"OSL\") v. 3.0)\n * @package scandipwa/base-theme\n * @link https://github.com/scandipwa/base-theme\n */\n\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport { STATE_CONFIRM_EMAIL } from 'Component/MyAccountOverlay/MyAccountOverlay.config';\nimport { showNotification } from 'Store/Notification/Notification.action';\n\nimport MyAccountCreateAccount from './MyAccountCreateAccount.component';\nimport { SHOW_VAT_NUMBER_REQUIRED } from './MyAccountCreateAccount.config';\n\nexport const MyAccountDispatcher = import(\n    /* webpackMode: \"lazy\", webpackChunkName: \"dispatchers\" */\n    'Store/MyAccount/MyAccount.dispatcher'\n);\n\n/** @namespace Component/MyAccountCreateAccount/Container/mapStateToProps */\n// eslint-disable-next-line no-unused-vars\nexport const mapStateToProps = (state) => ({\n    isLoading: state.MyAccountReducer.isLoading,\n    showTaxVatNumber: !!state.ConfigReducer.show_tax_vat_number,\n    newsletterActive: state.ConfigReducer.newsletter_general_active\n});\n\n/** @namespace Component/MyAccountCreateAccount/Container/mapDispatchToProps */\nexport const mapDispatchToProps = (dispatch) => ({\n    createAccount: (options) => MyAccountDispatcher.then(\n        ({ default: dispatcher }) => dispatcher.createAccount(options, dispatch)\n    ),\n    showNotification: (type, message) => dispatch(showNotification(type, message))\n});\n\n/** @namespace Component/MyAccountCreateAccount/Container */\nexport class MyAccountCreateAccountContainer extends PureComponent {\n    static propTypes = {\n        createAccount: PropTypes.func.isRequired,\n        onSignIn: PropTypes.func.isRequired,\n        setSignInState: PropTypes.func.isRequired,\n        setLoadingState: PropTypes.func.isRequired,\n        showNotification: PropTypes.func.isRequired,\n        isLoading: PropTypes.bool.isRequired,\n        showTaxVatNumber: PropTypes.string.isRequired\n    };\n\n    containerProps = {\n        vatNumberValidation: this.getVatNumberValidation()\n    };\n\n    containerFunctions = {\n        onCreateAccountSuccess: this.onCreateAccountSuccess.bind(this),\n        onCreateAccountAttempt: this.onCreateAccountAttempt.bind(this)\n    };\n\n    getVatNumberValidation() {\n        const { showTaxVatNumber } = this.props;\n\n        if (showTaxVatNumber === SHOW_VAT_NUMBER_REQUIRED) {\n            return ['notEmpty'];\n        }\n\n        return [];\n    }\n\n    onCreateAccountAttempt(_, invalidFields) {\n        const { showNotification, setLoadingState } = this.props;\n\n        if (invalidFields) {\n            showNotification('info', __('Incorrect data! Please resolve all field validation errors.'));\n        }\n\n        setLoadingState(!invalidFields);\n    }\n\n    async onCreateAccountSuccess(fields) {\n        const {\n            createAccount,\n            onSignIn,\n            setSignInState,\n            setLoadingState,\n            isLoading\n        } = this.props;\n\n        const {\n            password,\n            email,\n            firstname,\n            lastname,\n            is_subscribed,\n            taxvat\n        } = fields;\n\n        const customerData = {\n            customer: {\n                firstname,\n                lastname,\n                email,\n                is_subscribed,\n                taxvat\n            },\n            password\n        };\n\n        if (isLoading) {\n            return;\n        }\n\n        try {\n            const code = await createAccount(customerData);\n\n            // if user needs confirmation\n            if (code === 2) {\n                setSignInState(STATE_CONFIRM_EMAIL);\n            } else {\n                onSignIn();\n            }\n        } finally {\n            setLoadingState(false);\n        }\n    }\n\n    render() {\n        return (\n            <MyAccountCreateAccount\n              { ...this.props }\n              { ...this.containerProps }\n              { ...this.containerFunctions }\n            />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MyAccountCreateAccountContainer);\n"]},"metadata":{},"sourceType":"module"}